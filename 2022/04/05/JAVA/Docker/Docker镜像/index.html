<!DOCTYPE html>

<html lang="en">

<head>
    
    <title>Docker镜像 - Shuyan</title>
    <meta charset="UTF-8">
    <meta name="keywords" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5">
    
    

    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
    <meta name="description" content="一、Docker镜像1.1 镜像 &#x2F; UnionFS（联合文件系统）​        Union文件系统（UnionFS）是一种分层、轻量级并且高性能的文件系统，它支持对文件系统的修改作为一次提交来一层层的叠加，同时可以将不同目录挂载到同一个虚拟文件系统下。Union 文件系统是 Docker 镜像的基础。镜像可以通过分层来进行继承. 基于基础镜像（没有父镜像），可以制作各种具体的应用镜像。 特性">
<meta property="og:type" content="article">
<meta property="og:title" content="Docker镜像">
<meta property="og:url" content="http://example.com/2022/04/05/JAVA/Docker/Docker%E9%95%9C%E5%83%8F/index.html">
<meta property="og:site_name" content="Shuyan">
<meta property="og:description" content="一、Docker镜像1.1 镜像 &#x2F; UnionFS（联合文件系统）​        Union文件系统（UnionFS）是一种分层、轻量级并且高性能的文件系统，它支持对文件系统的修改作为一次提交来一层层的叠加，同时可以将不同目录挂载到同一个虚拟文件系统下。Union 文件系统是 Docker 镜像的基础。镜像可以通过分层来进行继承. 基于基础镜像（没有父镜像），可以制作各种具体的应用镜像。 特性">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/2022/04/05/JAVA/Docker/Docker%E9%95%9C%E5%83%8F/Docker镜像.assets/image-20220405100219244.png">
<meta property="og:image" content="http://example.com/2022/04/05/JAVA/Docker/Docker%E9%95%9C%E5%83%8F/Docker%E9%95%9C%E5%83%8F.assets/image-20220405100330153.png">
<meta property="og:image" content="http://example.com/2022/04/05/JAVA/Docker/Docker%E9%95%9C%E5%83%8F/Docker%E9%95%9C%E5%83%8F.assets/image-20220405100348059.png">
<meta property="og:image" content="http://example.com/2022/04/05/JAVA/Docker/Docker%E9%95%9C%E5%83%8F/Docker%E9%95%9C%E5%83%8F.assets/image-20220405093929253.png">
<meta property="og:image" content="http://example.com/2022/04/05/JAVA/Docker/Docker%E9%95%9C%E5%83%8F/Docker%E9%95%9C%E5%83%8F.assets/image-20220405093955419.png">
<meta property="og:image" content="http://example.com/2022/04/05/JAVA/Docker/Docker%E9%95%9C%E5%83%8F/Docker%E9%95%9C%E5%83%8F.assets/image-20220405094021940.png">
<meta property="og:image" content="http://example.com/2022/04/05/JAVA/Docker/Docker%E9%95%9C%E5%83%8F/Docker镜像.assets/image-20220405094205126.png">
<meta property="og:image" content="http://example.com/2022/04/05/JAVA/Docker/Docker%E9%95%9C%E5%83%8F/Docker镜像.assets/image-20220405094226717.png">
<meta property="og:image" content="http://example.com/2022/04/05/JAVA/Docker/Docker%E9%95%9C%E5%83%8F/Docker%E9%95%9C%E5%83%8F.assets/image-20220405094255171.png">
<meta property="og:image" content="http://example.com/2022/04/05/JAVA/Docker/Docker%E9%95%9C%E5%83%8F/Docker镜像.assets/image-20220405094310186.png">
<meta property="og:image" content="http://example.com/2022/04/05/JAVA/Docker/Docker%E9%95%9C%E5%83%8F/Docker镜像.assets/image-20220405094324262.png">
<meta property="og:image" content="http://example.com/2022/04/05/JAVA/Docker/Docker%E9%95%9C%E5%83%8F/Docker镜像.assets/image-20220405094343774.png">
<meta property="og:image" content="http://example.com/2022/04/05/JAVA/Docker/Docker%E9%95%9C%E5%83%8F/Docker镜像.assets/image-20220405094632169.png">
<meta property="og:image" content="http://example.com/2022/04/05/JAVA/Docker/Docker%E9%95%9C%E5%83%8F/Docker%E9%95%9C%E5%83%8F.assets/image-20220405094831612.png">
<meta property="og:image" content="http://example.com/2022/04/05/JAVA/Docker/Docker%E9%95%9C%E5%83%8F/Docker%E9%95%9C%E5%83%8F.assets/image-20220405095142522.png">
<meta property="og:image" content="http://example.com/2022/04/05/JAVA/Docker/Docker%E9%95%9C%E5%83%8F/Docker%E9%95%9C%E5%83%8F.assets/image-20220405095158514.png">
<meta property="og:image" content="http://example.com/2022/04/05/JAVA/Docker/Docker%E9%95%9C%E5%83%8F/Docker%E9%95%9C%E5%83%8F.assets/image-20220405095216986.png">
<meta property="og:image" content="http://example.com/2022/04/05/JAVA/Docker/Docker%E9%95%9C%E5%83%8F/Docker%E9%95%9C%E5%83%8F.assets/image-20220405095230968.png">
<meta property="og:image" content="http://example.com/2022/04/05/JAVA/Docker/Docker%E9%95%9C%E5%83%8F/Docker%E9%95%9C%E5%83%8F.assets/image-20220405095250515.png">
<meta property="og:image" content="http://example.com/2022/04/05/JAVA/Docker/Docker%E9%95%9C%E5%83%8F/Docker%E9%95%9C%E5%83%8F.assets/image-20220405095306360.png">
<meta property="article:published_time" content="2022-04-05T03:29:01.000Z">
<meta property="article:modified_time" content="2022-05-17T02:59:52.591Z">
<meta property="article:author" content="Shuyan">
<meta property="article:tag" content="Docker">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/2022/04/05/JAVA/Docker/Docker%E9%95%9C%E5%83%8F/Docker镜像.assets/image-20220405100219244.png">
    <link rel="stylesheet" href="/lib/jquery.fancybox.min.css?v=1653534086787">
    
        <link rel="stylesheet" href="//at.alicdn.com/t/font_1038733_0xvrvpg9c0r.css">
    
    <link rel="stylesheet" href="/lib/mdui_043tiny/css/mdui.css?v=1653534086787">
    <link rel="stylesheet" href="/lib/iconfont/iconfont.css?v=1653534086787">
    <link rel="stylesheet" href="/css/style.css?v=1653534086787">
     
    
<meta name="generator" content="Hexo 5.4.0"></head>

<body class="mdui-drawer-body-left">
    
    <div id="nexmoe-background">
        <div class="nexmoe-bg" style="background-image: url(http://mms0.baidu.com/it/u=2467909075,3604847220&amp;fm=253&amp;app=138&amp;f=JPEG&amp;fmt=auto&amp;q=75?w=801&amp;h=500)"></div>
        <div class="mdui-appbar mdui-shadow-0">
            <div class="mdui-toolbar">
                <a mdui-drawer="{target: '#drawer', swipe: true}" title="menu" class="mdui-btn mdui-btn-icon mdui-ripple"><i class="mdui-icon nexmoefont icon-menu"></i></a>
                <div class="mdui-toolbar-spacer"></div>
                <!--<a href="javascript:;" class="mdui-btn mdui-btn-icon"><i class="mdui-icon material-icons">search</i></a>-->
                <a href="/" title="Shuyan" class="mdui-btn mdui-btn-icon"><img src="http://mms2.baidu.com/it/u=1730774443,2723245118&amp;fm=253&amp;app=120&amp;f=JPEG&amp;fmt=auto&amp;q=75?w=500&amp;h=500" alt="Shuyan"></a>
            </div>
        </div>
    </div>
    <div id="nexmoe-header">
        <div class="nexmoe-drawer mdui-drawer" id="drawer">
    <div class="nexmoe-avatar mdui-ripple">
        <a href="/" title="Shuyan">
            <img src="http://mms2.baidu.com/it/u=1730774443,2723245118&amp;fm=253&amp;app=120&amp;f=JPEG&amp;fmt=auto&amp;q=75?w=500&amp;h=500" alt="Shuyan" alt="Shuyan">
        </a>
    </div>
    <div class="nexmoe-count">
        <div><span>Articles</span>84</div>
        <div><span>Tags</span>19</div>
        <div><span>Categories</span>31</div>
    </div>
    <div class="nexmoe-list mdui-list" mdui-collapse="{accordion: true}">
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple false" href="/" title="回到首页">
            <i class="mdui-list-item-icon nexmoefont icon-home"></i>
            <div class="mdui-list-item-content">
                回到首页
            </div>
        </a>
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple false" href="/categories" title="文章归档">
            <i class="mdui-list-item-icon nexmoefont icon-container"></i>
            <div class="mdui-list-item-content">
                文章归档
            </div>
        </a>
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple false" href="/about" title="梦华录">
            <i class="mdui-list-item-icon nexmoefont icon-info-circle"></i>
            <div class="mdui-list-item-content">
                梦华录
            </div>
        </a>
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple false" href="/PY.html" title="我的朋友">
            <i class="mdui-list-item-icon nexmoefont icon-unorderedlist"></i>
            <div class="mdui-list-item-content">
                我的朋友
            </div>
        </a>
        
    </div>
    <aside id="nexmoe-sidebar">
    
    <div class="nexmoe-widget-wrap">
    <div class="nexmoe-widget nexmoe-search">
         
            <form id="search_form" action_e="https://cn.bing.com/search?q=site:nexmoe.com" onsubmit="return search();">
                <label><input id="search_value" name="q" type="search" placeholder="Search"></label>
            </form>
         
    </div>
</div>
    
    <div class="nexmoe-widget-wrap">
    <div class="nexmoe-widget nexmoe-social">
        <a class="mdui-ripple" href="https://qm.qq.com/cgi-bin/qm/qr?k=rd1wdMWxpIZJe5AIruJkY7xD8d68h031&noverify=0" target="_blank" mdui-tooltip="{content: 'QQ'}" style="color: rgb(249, 174, 8);background-color: rgba(249, 174, 8, .1);">
            <i class="nexmoefont icon-QQ"></i>
        </a><a class="mdui-ripple" href="https://space.bilibili.com/400417888" target="_blank" mdui-tooltip="{content: '哔哩哔哩'}" style="color: rgb(231, 106, 141);background-color: rgba(231, 106, 141, .15);">
            <i class="nexmoefont icon-bilibili"></i>
        </a><a class="mdui-ripple" href="https://github.com/nexmoe/" target="_blank" mdui-tooltip="{content: 'GitHub'}" style="color: rgb(25, 23, 23);background-color: rgba(25, 23, 23, .15);">
            <i class="nexmoefont icon-github"></i>
        </a>
    </div>
</div>
    
    
  <div class="nexmoe-widget-wrap">
    <h3 class="nexmoe-widget-title">Categories</h3>
    <div class="nexmoe-widget">

      <ul class="category-list">

        


        

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/C语言/">C语言</a>
          <span class="category-list-count">3</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/JAVA/">JAVA</a>
          <span class="category-list-count">41</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/JAVA/“Spring框架”/JavaWeb/">JavaWeb</a>
          <span class="category-list-count">3</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/LaTex/">LaTex</a>
          <span class="category-list-count">1</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Leetcode/">Leetcode</a>
          <span class="category-list-count">19</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/JAVA/“Spring框架”/Mybaits/">Mybaits</a>
          <span class="category-list-count">6</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/JAVA/“Spring框架”/SSM/">SSM</a>
          <span class="category-list-count">1</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/C语言/STL/">STL</a>
          <span class="category-list-count">3</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/JAVA/“Spring框架”/Spring/">Spring</a>
          <span class="category-list-count">6</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/JAVA/“Spring框架”/SpringBoot/">SpringBoot</a>
          <span class="category-list-count">3</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/JAVA/“Spring框架”/SpringMVC/">SpringMVC</a>
          <span class="category-list-count">1</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/JAVA/Spring框架/">Spring框架</a>
          <span class="category-list-count">2</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Leetcode/sort/">sort</a>
          <span class="category-list-count">3</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/JAVA/“Docker”/">“Docker”</a>
          <span class="category-list-count">2</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/JAVA/“JAVA基础知识”/">“JAVA基础知识”</a>
          <span class="category-list-count">2</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/JAVA/“JVM”/">“JVM”</a>
          <span class="category-list-count">3</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/JAVA/“Nginx”/">“Nginx”</a>
          <span class="category-list-count">8</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/JAVA/“Redis”/">“Redis”</a>
          <span class="category-list-count">3</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/JAVA/Spring框架/“Security”/">“Security”</a>
          <span class="category-list-count">2</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/JAVA/“Spring框架”/">“Spring框架”</a>
          <span class="category-list-count">21</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Leetcode/二叉树/">二叉树</a>
          <span class="category-list-count">3</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Leetcode/剑指offer/">剑指offer</a>
          <span class="category-list-count">1</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Leetcode/动态规划/">动态规划</a>
          <span class="category-list-count">1</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Leetcode/线性表/单链表/">单链表</a>
          <span class="category-list-count">1</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Leetcode/字符串/">字符串</a>
          <span class="category-list-count">2</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Leetcode/线性表/数组/">数组</a>
          <span class="category-list-count">2</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Leetcode/栈和队列/">栈和队列</a>
          <span class="category-list-count">1</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Leetcode/算法/">算法</a>
          <span class="category-list-count">1</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Leetcode/线性表/">线性表</a>
          <span class="category-list-count">3</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/联邦学习/">联邦学习</a>
          <span class="category-list-count">4</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Leetcode/贪心算法/">贪心算法</a>
          <span class="category-list-count">1</span>
        </li>

        
      </ul>

    </div>
  </div>


    
    
  <div class="nexmoe-widget-wrap">
    <h3 class="nexmoe-widget-title">Tag Cloud</h3>
    <div id="randomtagcloud" class="nexmoe-widget tagcloud">
      <a href="/tags/Docker/" style="font-size: 11.67px;">Docker</a> <a href="/tags/JAVA/" style="font-size: 11.67px;">JAVA</a> <a href="/tags/JVM/" style="font-size: 13.33px;">JVM</a> <a href="/tags/JavaWeb/" style="font-size: 13.33px;">JavaWeb</a> <a href="/tags/LaTex/" style="font-size: 10px;">LaTex</a> <a href="/tags/Leetcode/" style="font-size: 20px;">Leetcode</a> <a href="/tags/Mybaits/" style="font-size: 16.67px;">Mybaits</a> <a href="/tags/Nginx/" style="font-size: 18.33px;">Nginx</a> <a href="/tags/Redis/" style="font-size: 13.33px;">Redis</a> <a href="/tags/SSM/" style="font-size: 10px;">SSM</a> <a href="/tags/STL/" style="font-size: 13.33px;">STL</a> <a href="/tags/Security/" style="font-size: 11.67px;">Security</a> <a href="/tags/Spring/" style="font-size: 16.67px;">Spring</a> <a href="/tags/SpringBoot/" style="font-size: 13.33px;">SpringBoot</a> <a href="/tags/SpringMVC/" style="font-size: 11.67px;">SpringMVC</a> <a href="/tags/%E4%BA%8C%E5%8F%89%E6%A0%91/" style="font-size: 13.33px;">二叉树</a> <a href="/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/" style="font-size: 10px;">动态规划</a> <a href="/tags/%E6%90%9C%E7%B4%A2/" style="font-size: 11.67px;">搜索</a> <a href="/tags/%E8%81%94%E9%82%A6%E5%AD%A6%E4%B9%A0/" style="font-size: 15px;">联邦学习</a>
    </div>
    
  </div>
  <style>
    #nexmoe-header .nexmoe-widget-wrap .tagcloud a:nth-child(7n+1) {
    background-color: rgba(255,78,106,0.15);
    color: rgba(255,78,106,0.8);
    }
    #nexmoe-header .nexmoe-widget-wrap .tagcloud a:nth-child(7n+2) {
    background-color: rgba(255,170,115,0.15);
    color: #ffaa73;
    }
    #nexmoe-header .nexmoe-widget-wrap .tagcloud a:nth-child(7n+3) {
    background-color: rgba(254,212,102,0.15);
    color: #fed466;
    }
    #nexmoe-header .nexmoe-widget-wrap .tagcloud a:nth-child(7n+4) {
    background-color: rgba(60,220,130,0.15);
    color: #3cdc82;
    }
    #nexmoe-header .nexmoe-widget-wrap .tagcloud a:nth-child(7n+5) {
    background-color: rgba(100,220,240,0.15);
    color: #64dcf0;
    }
    #nexmoe-header .nexmoe-widget-wrap .tagcloud a:nth-child(7n+6) {
    background-color: rgba(100,185,255,0.15);
    color: #64b9ff;
    }
    #nexmoe-header .nexmoe-widget-wrap .tagcloud a:nth-child(7n+7) {
    background-color: rgba(180,180,255,0.15);
    color: #b4b4ff;
    }
    #nexmoe-content .nexmoe-post .nexmoe-post-meta {
    margin: 25px 0px;
    font-size: 0;
    }
    #nexmoe-content .nexmoe-post .nexmoe-post-meta a {
    border-radius: 20px;
    padding: 10px 18px;
    color: #fff;
    font-size: 14px;
    display: inline-block;
    margin-bottom: 5px;
    margin-right: 10px;
    }
    #nexmoe-content .nexmoe-post .nexmoe-post-meta a .nexmoefont {
    font-size: 14px;
    }
    #nexmoe-content .nexmoe-post .nexmoe-post-meta a:before,
    #nexmoe-content .nexmoe-post .nexmoe-post-meta i:before {
    margin-right: 5px;
    }
    #nexmoe-content .nexmoe-post .nexmoe-post-meta a:nth-child(7n+1) {
    background-color: rgba(255,78,106,0.15);
    color: #ff4e6a;
    }
    #nexmoe-content .nexmoe-post .nexmoe-post-meta a:nth-child(7n+2) {
    background-color: rgba(255,170,115,0.15);
    color: #ffaa73;
    }
    #nexmoe-content .nexmoe-post .nexmoe-post-meta a:nth-child(7n+3) {
    background-color: rgba(254,212,102,0.15);
    color: #fed466;
    }
    #nexmoe-content .nexmoe-post .nexmoe-post-meta a:nth-child(7n+4) {
    background-color: rgba(60,220,130,0.15);
    color: #3cdc82;
    }
    #nexmoe-content .nexmoe-post .nexmoe-post-meta a:nth-child(7n+5) {
    background-color: rgba(100,220,240,0.15);
    color: #64dcf0;
    }
    #nexmoe-content .nexmoe-post .nexmoe-post-meta a:nth-child(7n+6) {
    background-color: rgba(100,185,255,0.15);
    color: #64b9ff;
    }
    #nexmoe-content .nexmoe-post .nexmoe-post-meta a:nth-child(7n+7) {
    background-color: rgba(180,180,255,0.15);
    color: #b4b4ff;
    }
  </style>


    
</aside>
    <div class="nexmoe-copyright">
        &copy; 2022 Shuyan
        Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
        & <a href="https://github.com/theme-nexmoe/hexo-theme-nexmoe" target="_blank">Nexmoe</a>
        <br><a target="_blank" href=" "><img src="http://mms0.baidu.com/it/u=991445098,3809803602&fm=253&app=138&f=JPEG&fmt=auto&q=75?w=500&h=500" width="100px" ></a><script data-ad-client="ca-pub-2058306854838448" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    </div>
</div><!-- .nexmoe-drawer -->
    </div>
    <div id="nexmoe-content">
        <div class="nexmoe-primary">
            <div class="nexmoe-post">

  <article>
      
          <div class="nexmoe-post-cover" style="padding-bottom: 62.5%;"> 
              <img data-src="/img/Docker镜像.jpg" data-sizes="auto" alt="Docker镜像" class="lazyload">
              <h1>Docker镜像</h1>
          </div>
      
      
      <div class="nexmoe-post-meta nexmoe-rainbow" style="margin:10px 0!important;">
    <a><i class="nexmoefont icon-calendar-fill"></i>2022年04月05日</a>
</div>

      

      <h1 id="一、Docker镜像"><a href="#一、Docker镜像" class="headerlink" title="一、Docker镜像"></a>一、Docker镜像</h1><h2 id="1-1-镜像-UnionFS（联合文件系统）"><a href="#1-1-镜像-UnionFS（联合文件系统）" class="headerlink" title="1.1 镜像 / UnionFS（联合文件系统）"></a>1.1 镜像 / UnionFS（联合文件系统）</h2><p>​        Union文件系统（UnionFS）是一种<strong>分层、轻量级并且高性能的文件系统</strong>，它支持对文件系统的修改作为一次提交来一层层的叠加，同时可以将不同目录挂载到同一个虚拟文件系统下。<strong>Union 文件系统是 Docker 镜像的基础。</strong>镜像可以通过分层来进行继承. 基于基础镜像（没有父镜像），可以制作各种具体的应用镜像。</p>
<p>特性：<br>        一次同时加载多个文件系统，但从外面看起来，只能看到一个文件系统，联合加载会把各层文件系统叠加起来，这样最终的文件系统会包含所有底层的文件和目录</p>
<img data-fancybox="gallery" data-sizes="auto" data-src="Docker镜像.assets/image-20220405100219244.png" alt="image-20220405100219244" class="lazyload">



<p>总结:<br>        镜像就像洋葱圈 ,就像莲花卷 ,一层套一层 ,对外只显示一个文件系统。而且, 这种分层镜像还可以复用</p>
<h2 id="1-2-特点"><a href="#1-2-特点" class="headerlink" title="1.2 特点"></a>1.2 特点</h2><p>​        <strong>Dcoker镜像都是只读的 , 当启动容器时, 一个新的可写层被加载到镜像的顶部，这一层被称为”容器层”, “容器层”执行的都称为”镜像层”</strong></p>
<h2 id="1-3-Docker镜像加载原理："><a href="#1-3-Docker镜像加载原理：" class="headerlink" title="1.3 Docker镜像加载原理："></a>1.3 Docker镜像加载原理：</h2><p>docker的镜像实际上由一层一层的文件系统组成，这种层级的文件构成文件系统UnionFS。</p>
<p><img data-fancybox="gallery" data-sizes="auto" data-src="Docker%E9%95%9C%E5%83%8F.assets/image-20220405100330153.png" alt="image-20220405100330153" class="lazyload"></p>
<p>​        <strong>bootfs(boot file system)</strong> 主要包含<strong>bootloader和kernel</strong>，<strong>bootloader主要作用是引导加载kernel</strong>, Linux刚启动时会加载bootfs文件系统，<strong>Docker镜像的最底层是bootfs</strong>。<br>​        这一层与典型的Linux/Unix系统是一样的，包含boot加载器和内核。当boot加载完成之后整个内核就都在内存中了，此时内存的使用权已由bootfs转交给内核，此时系统也会卸载bootfs。</p>
<p>​        <strong>rootfs (root file system)</strong> ，在bootfs之上。包含的就是典型 Linux 系统中的 /dev, /proc, /bin, /etc 等标准目录和文件。<strong>rootfs就是各种不同的操作系统发行版，比如Ubuntu，Centos等等。</strong></p>
<p>平时我们安装进虚拟机的CentOS都是好几个G，为什么docker这里才220M？</p>
<p><img data-fancybox="gallery" data-sizes="auto" data-src="Docker%E9%95%9C%E5%83%8F.assets/image-20220405100348059.png" alt="image-20220405100348059" class="lazyload"></p>
<p>​        对于一个精简的OS，rootfs可以很小，只需要包括最基本的命令、工具和程序库就可以了，<strong>因为底层直接用Host的kernel，自己只需要提供 rootfs 就行了。</strong>由此可见对于不同的linux发行版, bootfs基本是一致的, rootfs会有差别, 因此<strong>不同的发行版可以公用bootfs。</strong></p>
<h2 id="1-4-Docker镜像Commit操作"><a href="#1-4-Docker镜像Commit操作" class="headerlink" title="1.4 Docker镜像Commit操作"></a>1.4 Docker镜像Commit操作</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 提交容器副本实质成为一个新的镜像</span><br>docker commit -m=<span class="hljs-string">&quot;提交的描述信息&quot;</span> -a=<span class="hljs-string">&quot;作者&quot;</span>	容器ID 要创建的目标镜像名:[标签名]<br><br><br>eg: 同时docker运行tomcat案例<br><span class="hljs-comment"># 1.  创建交互式界面 ( 相当于前台启动)</span><br>docker run -it -p 8888:8080 tomcat   <span class="hljs-comment"># 端口映射将8888作为docker的入口,映射到tomcat镜像的8080(图1,图2)</span><br>docker run -it -P  tomcat  <span class="hljs-comment">#自动端口映射(通过 docker ps查看端口, 图3)</span><br><span class="hljs-comment">#后台启动(不会占用当前页面)</span><br>docker run -d -p 8888:8080 tomcat <br><br><br><span class="hljs-comment"># 2. 进入tomcat (如果前置启动,另开一个窗口 ,后置启动则直接进入)</span><br><span class="hljs-comment"># 查看运行容器ID</span><br>docker ps  <br><span class="hljs-comment"># 进入根目录</span><br>docker <span class="hljs-built_in">exec</span> -it 容器ID /bin/bash<br>/usr/<span class="hljs-built_in">local</span>/tomcat<span class="hljs-comment"># rm -rf webapps/docs/ </span><br><span class="hljs-comment"># 删除后访问tomcat ,可以看到访问主页下的文档出现404(图4)</span><br><br><span class="hljs-comment"># 3. 提交容器副本实使之为一个新的镜像</span><br><span class="hljs-comment"># 查看运行容器ID</span><br>docker ps  <br><span class="hljs-comment"># 提交容器</span><br>docker commit -m=<span class="hljs-string">&quot;del tomcat docs&quot;</span> -a=<span class="hljs-string">&quot;timepaus&quot;</span> 容器ID tomcat:v1.2<br><span class="hljs-comment"># 查看镜像(图5)</span><br>docker images<br><br><span class="hljs-comment"># 4.同时启动新镜像并和原来的对比</span><br>可以看到我们自己提交的新镜像也没有文档()<br>但是我们重新下载的tomcat是有的<br></code></pre></td></tr></table></figure>



<h1 id="二、Docker容器数据卷"><a href="#二、Docker容器数据卷" class="headerlink" title="二、Docker容器数据卷"></a>二、Docker容器数据卷</h1><blockquote>
<p>类似Redis中的rdb文件和aof文件<br>用于容器的持久化和荣期间的继承与共享数据</p>
</blockquote>
<h2 id="2-1-容器内添加数据卷"><a href="#2-1-容器内添加数据卷" class="headerlink" title="2.1 容器内添加数据卷"></a>2.1 容器内添加数据卷</h2><h3 id="2-1-直接命令添加"><a href="#2-1-直接命令添加" class="headerlink" title="2.1 直接命令添加"></a>2.1 直接命令添加</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 通过-v命令直接添加 (需要在根目录下创建 containerData  )</span><br><span class="hljs-comment"># 创建后修改容器内containerData 会同步到hostData ,反之亦是如此</span><br>docker run -it -v /hostData:/containerData  镜像名/ID<br><br><span class="hljs-comment"># 创建只读权限的文件 , 容器内只能读取这个文件, 但是不能修改. ro: readonly</span><br>docker run -it -v /宿主机绝路路径目录:/容器内目录:ro 镜像名<br></code></pre></td></tr></table></figure>

<h3 id="2-2-Docker添加"><a href="#2-2-Docker添加" class="headerlink" title="2.2 Docker添加"></a>2.2 Docker添加</h3><p>DockerFile的简单理解</p>
<p><img data-fancybox="gallery" data-sizes="auto" data-src="Docker%E9%95%9C%E5%83%8F.assets/image-20220405093929253.png" alt="image-20220405093929253" class="lazyload"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 1. 宿主机根目录下创建mydocker文件夹并进入</span><br><br><br><span class="hljs-comment"># 2. 在mydocker文件想创建DockerFile文件并编辑,内容如下(图1)</span><br><br><span class="hljs-comment"># volume test</span><br>FROM centos<br>VOLUME [<span class="hljs-string">&quot;/dataVolumeContainer1&quot;</span>,<span class="hljs-string">&quot;/dataVolumeContainer2&quot;</span>]<br>CMD <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;finished,--------success1&quot;</span><br>CMD /bin/bash<br><br>说明：<br>出于可移植和分享的考虑，用-v 主机目录:容器目录这种方法不能够直接在Dockerfile中实现。<br>由于宿主机目录是依赖于特定宿主机的，并不能够保证在所有的宿主机上都存在这样的特定目录。<br><br><br><span class="hljs-comment"># 3. 使用docker build命令创建一个镜像, 并挂载指定宿主机指定文件</span><br>docker build -f /mydocker/DockerFile -t 定义的新镜像名称<br><br><span class="hljs-comment"># 4. 查看镜像</span><br>docker images<br><br><span class="hljs-comment"># 5.运行新镜像</span><br>docker run -it 定义的新镜像ID /bin/bash<br><br><span class="hljs-comment"># 6.通过镜像运行后生成的容器ID查看 (图2), 对应的主机映射的数据卷地址</span><br>docker ps<br>docker inspect 容器ID<br><br><span class="hljs-comment"># 7.测试添加卷和主机是否互通有无</span><br>在容器中创建文件, 看看主机中是否创建对应的文件<br><br>注意: <br>Docker挂载主机目录(第3步)Docker访问出现cannot open directory .: Permission denied<br>解决办法：在挂载目录后多加一个--privileged=<span class="hljs-literal">true</span>参数即可<br><br></code></pre></td></tr></table></figure>

<p><img data-fancybox="gallery" data-sizes="auto" data-src="Docker%E9%95%9C%E5%83%8F.assets/image-20220405093955419.png" alt="image-20220405093955419" class="lazyload"></p>
<p>查看运行的容器id相关信息 <code>docker inspect 容器ID</code></p>
<p><img data-fancybox="gallery" data-sizes="auto" data-src="Docker%E9%95%9C%E5%83%8F.assets/image-20220405094021940.png" alt="image-2022040509402194" class="lazyload"></p>
<h3 id="2-3-数据卷容器"><a href="#2-3-数据卷容器" class="headerlink" title="2.3 数据卷容器"></a>2.3 数据卷容器</h3><blockquote>
<p>命名的容器挂载数据卷，其它容器通过挂载这个(父容器)实现数据共享，<br>挂载数据卷的容器，称之为数据卷容器</p>
</blockquote>
<p>实现步骤：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 1. 以上一步所建镜像为模板 ,首先启动一个父容器dc01 ,在创建容器的数据卷文夹中创建一个文件(图1)</span><br>docker run -it --name 	dc01 zzyy/centos<br>touch dc01_add.txt<br><br><span class="hljs-comment"># 2. 创建子容器dc02,dc03继承自dc01 , 在创建容器的数据卷文夹中创建一个文件(图2)</span><br>docker run -it --name dc02 --volumes-from dc01 zzyy/centos<br>touch dc02_add.txt<br>docker run -it --name dc03 --volumes-from dc01 zzyy/centos<br>touch dc01=3_add.txt<br><br><br><span class="hljs-comment"># 3. 回到dc01可以看到所有数据都被共享了(图3)</span><br><span class="hljs-comment"># 4. 删除dc01, dc02修改后dc03是否可访问,可以 (图4)</span><br><span class="hljs-comment"># 5. 删除dc02dc03是否可以访问, 可以(图5)</span><br><span class="hljs-comment"># 6. 新建dc04继承dc03是否可以访问, 可以(图6)</span><br><br>结论<br>容器之间配置信息的传递, 数据卷的生命周期一直持续到没有容器使用它为止<br><br></code></pre></td></tr></table></figure>



<img data-fancybox="gallery" data-sizes="auto" data-src="Docker镜像.assets/image-20220405094205126.png" alt="image-20220405094205126" class="lazyload">



<img data-fancybox="gallery" data-sizes="auto" data-src="Docker镜像.assets/image-20220405094226717.png" alt="image-20220405094226717" class="lazyload">



<p><img data-fancybox="gallery" data-sizes="auto" data-src="Docker%E9%95%9C%E5%83%8F.assets/image-20220405094255171.png" alt="image-20220405094255171" class="lazyload"></p>
<img data-fancybox="gallery" data-sizes="auto" data-src="Docker镜像.assets/image-20220405094310186.png" alt="image-20220405094310186" class="lazyload">

<img data-fancybox="gallery" data-sizes="auto" data-src="Docker镜像.assets/image-20220405094324262.png" alt="image-20220405094324262" class="lazyload">

<img data-fancybox="gallery" data-sizes="auto" data-src="Docker镜像.assets/image-20220405094343774.png" alt="image-20220405094343774" class="lazyload">



<h1 id="三、DockerFile解析"><a href="#三、DockerFile解析" class="headerlink" title="三、DockerFile解析"></a>三、DockerFile解析</h1><blockquote>
<p>Dockerfile是用来构建Docker镜像文件 ,是有一系列命令和参数构成的脚本</p>
</blockquote>
<h2 id="3-1-构建步骤"><a href="#3-1-构建步骤" class="headerlink" title="3.1 构建步骤"></a>3.1 构建步骤</h2><p>1.编写Dockerfile文件<br>2.docker build<br>3.docker run</p>
<h3 id="3-1-1-格式"><a href="#3-1-1-格式" class="headerlink" title="3.1.1 格式"></a>3.1.1 格式</h3><p>以centos的文件为例</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs shell">FROM scratch<br>ADD centos-8-container.tar.xz /<br><br>LABEL org.label-schema.schema-version=&quot;1.0&quot; \<br>    org.label-schema.name=&quot;CentOS Base Image&quot; \<br>    org.label-schema.vendor=&quot;CentOS&quot; \<br>    org.label-schema.license=&quot;GPLv2&quot; \<br>    org.label-schema.build-date=&quot;20190927&quot;<br><br>CMD [&quot;/bin/bash&quot;]<br>12345678910<br></code></pre></td></tr></table></figure>

<h3 id="3-1-2-语法"><a href="#3-1-2-语法" class="headerlink" title="3.1.2 语法"></a>3.1.2 语法</h3><ol>
<li>每条保留字指令都必须为答谢字母且后面至少跟一个参数</li>
<li>指令从上到下, 顺序执行</li>
<li>#表示注释</li>
<li>每条指令都会创建一个一个新的镜像层, 并提交</li>
</ol>
<h3 id="3-1-3-Docker执行DockerFile的大致流程"><a href="#3-1-3-Docker执行DockerFile的大致流程" class="headerlink" title="3.1.3 Docker执行DockerFile的大致流程"></a>3.1.3 Docker执行DockerFile的大致流程</h3><ol>
<li>docker从基础镜像运行一个容器</li>
<li>执行一条指令并对容器做出修改</li>
<li>执行类似docker commit 的操作提交一个新的镜像层</li>
<li>docker 再基于刚提交的镜像运行一个新容器</li>
<li>执行dockerfile 中的下一条执行, 直至所有指令都完成</li>
</ol>
<p>从应用软件的角度来看，Dockerfile、Docker镜像与Docker容器分别代表软件的三个不同阶段，</p>
<ul>
<li>Dockerfile是软件的原材料</li>
<li>Docker镜像是软件的交付品</li>
<li>Docker容器则可以认为是软件的运行态。</li>
</ul>
<p>Dockerfile面向开发，Docker镜像成为交付标准，<br>Docker容器则涉及部署与运维，三者缺一不可，合力充当Docker体系的基石。</p>
<img data-fancybox="gallery" data-sizes="auto" data-src="Docker镜像.assets/image-20220405094632169.png" alt="image-20220405094632169" class="lazyload">



<blockquote>
<p>1 Dockerfile，需要定义一个Dockerfile，Dockerfile定义了进程需要的一切东西。Dockerfile涉及的内容包括执行代码或者是文件、环境变量、依赖包、运行时环境、动态链接库、操作系统的发行版、服务进程和内核进程(当应用进程需要和系统服务和内核进程打交道，这时需要考虑如何设计namespace的权限控制)等等;<br>2 Docker镜像，在用Dockerfile定义一个文件之后，docker build时会产生一个Docker镜像，当运行 Docker镜像时，会真正开始提供服务;<br>3 Docker容器，容器是直接提供服务的</p>
</blockquote>
<h2 id="3-2-DockerFile保留字指令"><a href="#3-2-DockerFile保留字指令" class="headerlink" title="3.2 DockerFile保留字指令"></a>3.2 DockerFile保留字指令</h2><p><a target="_blank" rel="noopener" href="https://github.com/docker-library/tomcat/blob/8348a86101660e76224afcc57c4c9fae4dc76de8/9.0/jdk8/openjdk/Dockerfile">查看tomcat的DockerFile文件 ,更好理解保留字</a></p>
<p><img data-fancybox="gallery" data-sizes="auto" data-src="Docker%E9%95%9C%E5%83%8F.assets/image-20220405094831612.png" alt="image-20220405094831612" class="lazyload"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br></pre></td><td class="code"><pre><code class="hljs bash">FROM openjdk:8-jdk<br><br>ENV CATALINA_HOME /usr/<span class="hljs-built_in">local</span>/tomcat<br>ENV PATH <span class="hljs-variable">$CATALINA_HOME</span>/bin:<span class="hljs-variable">$PATH</span><br>RUN mkdir -p <span class="hljs-string">&quot;<span class="hljs-variable">$CATALINA_HOME</span>&quot;</span><br>WORKDIR <span class="hljs-variable">$CATALINA_HOME</span><br><br><span class="hljs-comment"># let &quot;Tomcat Native&quot; live somewhere isolated</span><br>ENV TOMCAT_NATIVE_LIBDIR <span class="hljs-variable">$CATALINA_HOME</span>/native-jni-lib<br>ENV LD_LIBRARY_PATH <span class="hljs-variable">$&#123;LD_LIBRARY_PATH:+$LD_LIBRARY_PATH:&#125;</span><span class="hljs-variable">$TOMCAT_NATIVE_LIBDIR</span><br><br><span class="hljs-comment"># see https://www.apache.org/dist/tomcat/tomcat-$TOMCAT_MAJOR/KEYS</span><br><span class="hljs-comment"># see also &quot;update.sh&quot; (https://github.com/docker-library/tomcat/blob/master/update.sh)</span><br>ENV GPG_KEYS 05AB33110949707C93A279E3D3EFE6B686867BA6 07E48665A34DCAFAE522E5E6266191C37C037D42 47309207D818FFD8DCD3F83F1931D684307A10A5 541FBE7D8F78B25E055DDEE13C370389288584E7 61B832AC2F1C5A90F0F9B00A1C506407564C17A3 79F7026C690BAA50B92CD8B66A3AD3F4F22C4FED 9BA44C2621385CB966EBA586F72C284D731FABEE A27677289986DB50844682F8ACB77FC2E86E29AC A9C5DF4D22E99998D9875A5110C01C5A2F6059E7 DCFD35E0BF8CA7344752DE8B6FB21E8933C60243 F3A04C595DB5B6A5F1ECA43E3B7BBB100D811BBE F7DA48BB64BCB84ECBA7EE6935CD23C10D498E23<br><br>ENV TOMCAT_MAJOR 9<br>ENV TOMCAT_VERSION 9.0.27<br>ENV TOMCAT_SHA512 408d30bf56d59941149b397e5e725a5f9baf225807397a4b7a3be79f7d211e6d878d34bf00776746a54cc7d067f168db24c367e5c7390bb7329b3bca428726cc<br><br>RUN <span class="hljs-built_in">set</span> -eux; \<br>	\<br>	savedAptMark=<span class="hljs-string">&quot;<span class="hljs-subst">$(apt-mark showmanual)</span>&quot;</span>; \<br>	apt-get update; \<br>	apt-get install -y --no-install-recommends \<br>		gnupg dirmngr \<br>		wget ca-certificates \<br>	; \<br>	\<br>	<span class="hljs-function"><span class="hljs-title">ddist</span></span>() &#123; \<br>		<span class="hljs-built_in">local</span> f=<span class="hljs-string">&quot;<span class="hljs-variable">$1</span>&quot;</span>; <span class="hljs-built_in">shift</span>; \<br>		<span class="hljs-built_in">local</span> distFile=<span class="hljs-string">&quot;<span class="hljs-variable">$1</span>&quot;</span>; <span class="hljs-built_in">shift</span>; \<br>		<span class="hljs-built_in">local</span> success=; \<br>		<span class="hljs-built_in">local</span> distUrl=; \<br>		<span class="hljs-keyword">for</span> distUrl <span class="hljs-keyword">in</span> \<br><span class="hljs-comment"># https://issues.apache.org/jira/browse/INFRA-8753?focusedCommentId=14735394#comment-14735394</span><br>			<span class="hljs-string">&#x27;https://www.apache.org/dyn/closer.cgi?action=download&amp;filename=&#x27;</span> \<br><span class="hljs-comment"># if the version is outdated (or we&#x27;re grabbing the .asc file), we might have to pull from the dist/archive :/</span><br>			https://www-us.apache.org/dist/ \<br>			https://www.apache.org/dist/ \<br>			https://archive.apache.org/dist/ \<br>		; <span class="hljs-keyword">do</span> \<br>			<span class="hljs-keyword">if</span> wget -O <span class="hljs-string">&quot;<span class="hljs-variable">$f</span>&quot;</span> <span class="hljs-string">&quot;$distUrl<span class="hljs-variable">$distFile</span>&quot;</span> &amp;&amp; [ -s <span class="hljs-string">&quot;<span class="hljs-variable">$f</span>&quot;</span> ]; <span class="hljs-keyword">then</span> \<br>				success=1; \<br>				<span class="hljs-built_in">break</span>; \<br>			<span class="hljs-keyword">fi</span>; \<br>		<span class="hljs-keyword">done</span>; \<br>		[ -n <span class="hljs-string">&quot;<span class="hljs-variable">$success</span>&quot;</span> ]; \<br>	&#125;; \<br>	\<br>	ddist <span class="hljs-string">&#x27;tomcat.tar.gz&#x27;</span> <span class="hljs-string">&quot;tomcat/tomcat-<span class="hljs-variable">$TOMCAT_MAJOR</span>/v<span class="hljs-variable">$TOMCAT_VERSION</span>/bin/apache-tomcat-<span class="hljs-variable">$TOMCAT_VERSION</span>.tar.gz&quot;</span>; \<br>	<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$TOMCAT_SHA512</span> *tomcat.tar.gz&quot;</span> | sha512sum --strict --check -; \<br>	ddist <span class="hljs-string">&#x27;tomcat.tar.gz.asc&#x27;</span> <span class="hljs-string">&quot;tomcat/tomcat-<span class="hljs-variable">$TOMCAT_MAJOR</span>/v<span class="hljs-variable">$TOMCAT_VERSION</span>/bin/apache-tomcat-<span class="hljs-variable">$TOMCAT_VERSION</span>.tar.gz.asc&quot;</span>; \<br>	<span class="hljs-built_in">export</span> GNUPGHOME=<span class="hljs-string">&quot;<span class="hljs-subst">$(mktemp -d)</span>&quot;</span>; \<br>	<span class="hljs-keyword">for</span> key <span class="hljs-keyword">in</span> <span class="hljs-variable">$GPG_KEYS</span>; <span class="hljs-keyword">do</span> \<br>		gpg --batch --keyserver ha.pool.sks-keyservers.net --recv-keys <span class="hljs-string">&quot;<span class="hljs-variable">$key</span>&quot;</span>; \<br>	<span class="hljs-keyword">done</span>; \<br>	gpg --batch --verify tomcat.tar.gz.asc tomcat.tar.gz; \<br>	tar -xf tomcat.tar.gz --strip-components=1; \<br>	rm bin/*.bat; \<br>	rm tomcat.tar.gz*; \<br>	<span class="hljs-built_in">command</span> -v gpgconf &amp;&amp; gpgconf --<span class="hljs-built_in">kill</span> all || :; \<br>	rm -rf <span class="hljs-string">&quot;<span class="hljs-variable">$GNUPGHOME</span>&quot;</span>; \<br>	\<br>	nativeBuildDir=<span class="hljs-string">&quot;<span class="hljs-subst">$(mktemp -d)</span>&quot;</span>; \<br>	tar -xf bin/tomcat-native.tar.gz -C <span class="hljs-string">&quot;<span class="hljs-variable">$nativeBuildDir</span>&quot;</span> --strip-components=1; \<br>	apt-get install -y --no-install-recommends \<br>		dpkg-dev \<br>		gcc \<br>		libapr1-dev \<br>		libssl-dev \<br>		make \<br>	; \<br>	( \<br>		<span class="hljs-built_in">export</span> CATALINA_HOME=<span class="hljs-string">&quot;<span class="hljs-variable">$PWD</span>&quot;</span>; \<br>		<span class="hljs-built_in">cd</span> <span class="hljs-string">&quot;<span class="hljs-variable">$nativeBuildDir</span>/native&quot;</span>; \<br>		gnuArch=<span class="hljs-string">&quot;<span class="hljs-subst">$(dpkg-architecture --query DEB_BUILD_GNU_TYPE)</span>&quot;</span>; \<br>		aprConfig=<span class="hljs-string">&quot;<span class="hljs-subst">$(command -v apr-1-config)</span>&quot;</span>; \<br>		./configure \<br>			--build=<span class="hljs-string">&quot;<span class="hljs-variable">$gnuArch</span>&quot;</span> \<br>			--libdir=<span class="hljs-string">&quot;<span class="hljs-variable">$TOMCAT_NATIVE_LIBDIR</span>&quot;</span> \<br>			--prefix=<span class="hljs-string">&quot;<span class="hljs-variable">$CATALINA_HOME</span>&quot;</span> \<br>			--with-apr=<span class="hljs-string">&quot;<span class="hljs-variable">$aprConfig</span>&quot;</span> \<br>			--with-java-home=<span class="hljs-string">&quot;<span class="hljs-variable">$JAVA_HOME</span>&quot;</span> \<br>			--with-ssl=yes; \<br>		make -j <span class="hljs-string">&quot;<span class="hljs-subst">$(nproc)</span>&quot;</span>; \<br>		make install; \<br>	); \<br>	rm -rf <span class="hljs-string">&quot;<span class="hljs-variable">$nativeBuildDir</span>&quot;</span>; \<br>	rm bin/tomcat-native.tar.gz; \<br>	\<br><span class="hljs-comment"># reset apt-mark&#x27;s &quot;manual&quot; list so that &quot;purge --auto-remove&quot; will remove all build dependencies</span><br>	apt-mark auto <span class="hljs-string">&#x27;.*&#x27;</span> &gt; /dev/null; \<br>	[ -z <span class="hljs-string">&quot;<span class="hljs-variable">$savedAptMark</span>&quot;</span> ] || apt-mark manual <span class="hljs-variable">$savedAptMark</span> &gt; /dev/null; \<br>	find <span class="hljs-string">&quot;<span class="hljs-variable">$TOMCAT_NATIVE_LIBDIR</span>&quot;</span> -<span class="hljs-built_in">type</span> f -executable -<span class="hljs-built_in">exec</span> ldd <span class="hljs-string">&#x27;&#123;&#125;&#x27;</span> <span class="hljs-string">&#x27;;&#x27;</span> \<br>		| awk <span class="hljs-string">&#x27;/=&gt;/ &#123; print $(NF-1) &#125;&#x27;</span> \<br>		| sort -u \<br>		| xargs -r dpkg-query --search \<br>		| cut -d: -f1 \<br>		| sort -u \<br>		| xargs -r apt-mark manual \<br>	; \<br>	apt-get purge -y --auto-remove -o APT::AutoRemove::RecommendsImportant=<span class="hljs-literal">false</span>; \<br>	rm -rf /var/lib/apt/lists/*; \<br>	\<br><span class="hljs-comment"># sh removes env vars it doesn&#x27;t support (ones with periods)</span><br><span class="hljs-comment"># https://github.com/docker-library/tomcat/issues/77</span><br>	find ./bin/ -name <span class="hljs-string">&#x27;*.sh&#x27;</span> -<span class="hljs-built_in">exec</span> sed -ri <span class="hljs-string">&#x27;s|^#!/bin/sh$|#!/usr/bin/env bash|&#x27;</span> <span class="hljs-string">&#x27;&#123;&#125;&#x27;</span> +; \<br>	\<br><span class="hljs-comment"># fix permissions (especially for running as non-root)</span><br><span class="hljs-comment"># https://github.com/docker-library/tomcat/issues/35</span><br>	chmod -R +rX .; \<br>	chmod 777 logs temp work<br><br><span class="hljs-comment"># verify Tomcat Native is working properly</span><br>RUN <span class="hljs-built_in">set</span> -e \<br>	&amp;&amp; nativeLines=<span class="hljs-string">&quot;<span class="hljs-subst">$(catalina.sh configtest 2&gt;&amp;1)</span>&quot;</span> \<br>	&amp;&amp; nativeLines=<span class="hljs-string">&quot;<span class="hljs-subst">$(echo <span class="hljs-string">&quot;<span class="hljs-variable">$nativeLines</span>&quot;</span> | grep &#x27;Apache Tomcat Native&#x27;)</span>&quot;</span> \<br>	&amp;&amp; nativeLines=<span class="hljs-string">&quot;<span class="hljs-subst">$(echo <span class="hljs-string">&quot;<span class="hljs-variable">$nativeLines</span>&quot;</span> | sort -u)</span>&quot;</span> \<br>	&amp;&amp; <span class="hljs-keyword">if</span> ! <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$nativeLines</span>&quot;</span> | grep <span class="hljs-string">&#x27;INFO: Loaded APR based Apache Tomcat Native library&#x27;</span> &gt;&amp;2; <span class="hljs-keyword">then</span> \<br>		<span class="hljs-built_in">echo</span> &gt;&amp;2 <span class="hljs-string">&quot;<span class="hljs-variable">$nativeLines</span>&quot;</span>; \<br>		<span class="hljs-built_in">exit</span> 1; \<br>	<span class="hljs-keyword">fi</span><br><br>EXPOSE 8080<br>CMD [<span class="hljs-string">&quot;catalina.sh&quot;</span>, <span class="hljs-string">&quot;run&quot;</span>]<br></code></pre></td></tr></table></figure>



<h3 id="3-2-1-保留字整合案例"><a href="#3-2-1-保留字整合案例" class="headerlink" title="3.2.1 保留字整合案例"></a>3.2.1 保留字整合案例</h3><h4 id="自定义镜像"><a href="#自定义镜像" class="headerlink" title="自定义镜像"></a>自定义镜像</h4><blockquote>
<p>我们安装的centos精简版是没有vim和ifconfig命令的支持的<br>我们可以通过编写Dockerfile令其支持这些功能</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 1.搜索centos镜像并下载</span><br>docker search centos<br>docker pull centos<br><br><span class="hljs-comment"># 2.编写创建一个文件( /mydoker/dockerfile_centos ),编写Dockerfile ,内容如下</span><br>--------------------------------------------------------------------<br>FROM centos<br>MAINTAINER timepause&lt;qq_43371556@csdn.net&gt;<br><br>ENV MYPATH /usr/<span class="hljs-built_in">local</span><br>WORKDIR <span class="hljs-variable">$MYPATH</span><br><br>RUN yum -y install vim<br>RUN yum -y install net-tools<br><br>EXPOSE 80<br><br>CMD <span class="hljs-built_in">echo</span> <span class="hljs-variable">$MYPATH</span><br>CMD <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;install vim and ifconfig commond plug-in components success&quot;</span><br>CMD /bin/bash<br>-----------------------------------------------------------------------<br><br><span class="hljs-comment"># 3. 编译运行centos( 注意最后的空格和点号)</span><br>docker build -f /mydoker/dockerfile_centos -t mycentos:1.3 .<br><br><span class="hljs-comment"># 4. 测试功能</span><br><span class="hljs-comment"># 查看是否新增镜像</span><br>docker ps<br><span class="hljs-comment"># 运行新镜像 </span><br>docker run -it mycentos:1.3<br><span class="hljs-comment"># 在容器中使用vim 与if config命令</span><br></code></pre></td></tr></table></figure>

<h4 id="自定义tomcat9"><a href="#自定义tomcat9" class="headerlink" title="自定义tomcat9"></a>自定义tomcat9</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 1. 创建存放生成镜像文件的目录</span><br>mkdir -p /myuse/mydocker/tomcat9<br><br><span class="hljs-comment"># 2.创建相关文件(c.txt用于测试)</span><br>touch c.txt <br><br><br><span class="hljs-comment"># 3.上传tomcat和jdk(一定要注意版本, 根据版本修改Dockerfile文件)</span><br><br><span class="hljs-comment">#. 4.创建并编辑Dockerfile(需要提前下载centos)</span><br>vim Dockerfile<br>---------------------Dockerfile-------------------------------<br>FROM         centos<br>MAINTAINER    chy&lt;chy@qq.com&gt;<br><span class="hljs-comment">#把宿主机当前上下文的c.txt拷贝到容器/usr/local/路径下</span><br>COPY c.txt /usr/<span class="hljs-built_in">local</span>/cincontainer.txt<br><span class="hljs-comment">#把java与tomcat添加到容器中</span><br>ADD jdk-8u11-linux-x64.tar.gz /usr/<span class="hljs-built_in">local</span>/<br>ADD apache-tomcat-9.0.27.tar.gz /usr/<span class="hljs-built_in">local</span>/<br><span class="hljs-comment">#安装vim编辑器</span><br>RUN yum -y install vim<br><span class="hljs-comment">#设置工作访问时候的WORKDIR路径，登录落脚点</span><br>ENV MYPATH /usr/<span class="hljs-built_in">local</span><br>WORKDIR <span class="hljs-variable">$MYPATH</span><br><span class="hljs-comment">#配置java与tomcat环境变量</span><br>ENV JAVA_HOME /usr/<span class="hljs-built_in">local</span>/jdk1.8.0_11<br>ENV CLASSPATH <span class="hljs-variable">$JAVA_HOME</span>/lib/dt.jar:<span class="hljs-variable">$JAVA_HOME</span>/lib/tools.jar<br>ENV CATALINA_HOME /usr/<span class="hljs-built_in">local</span>/apache-tomcat-9.0.27<br>ENV CATALINA_BASE /usr/<span class="hljs-built_in">local</span>/apache-tomcat-9.0.27<br>ENV PATH <span class="hljs-variable">$PATH</span>:<span class="hljs-variable">$JAVA_HOME</span>/bin:<span class="hljs-variable">$CATALINA_HOME</span>/lib:<span class="hljs-variable">$CATALINA_HOME</span>/bin<br><span class="hljs-comment">#容器运行时监听的端口</span><br>EXPOSE  8080<br><span class="hljs-comment">#启动时运行tomcat</span><br><span class="hljs-comment"># ENTRYPOINT [&quot;/usr/local/apache-tomcat-9.0.8/bin/startup.sh&quot; ]</span><br><span class="hljs-comment"># CMD [&quot;/usr/local/apache-tomcat-9.0.8/bin/catalina.sh&quot;,&quot;run&quot;]</span><br>CMD /usr/<span class="hljs-built_in">local</span>/apache-tomcat-9.0.27/bin/startup.sh &amp;&amp; tail -F /usr/<span class="hljs-built_in">local</span>/apache-tomcat-9.0.27/bin/logs/catalina.out<br>---------------------Dockerfile-------------------------------<br><br><br><br><br><span class="hljs-comment"># 5.构建镜像(在存放这些文件的目录下)</span><br><span class="hljs-comment"># 如果Dockerfile文件名称就是Dockerfile,可以省略参数 -f /Dockerfile所在位置的书写</span><br>docker build -t mytomcat9 .<br><br><span class="hljs-comment"># 6.查看镜像并运行镜像</span><br>docker images<br><span class="hljs-comment"># 运行镜像 (后台启动)</span><br>docker run -d -p 8080:8080 --name myt9 -v /myuse/mydocker/tomcat9/<span class="hljs-built_in">test</span>:/usr/<span class="hljs-built_in">local</span>/apache-tomcat-9.0.27/webapps/<span class="hljs-built_in">test</span> -v /myuse/mydocker/tomcat9/tomcat9logs/:/usr/<span class="hljs-built_in">local</span>/apache-tomcat-9.0.27/logs --privileged=<span class="hljs-literal">true</span>  mytomcat9<br><br><span class="hljs-comment"># 注意这里配置了容器卷的映射,宿主机的test文件夹映射到tomcat的webapps目录下的test文件,且二者可以互通有无. </span><br>docker <span class="hljs-built_in">exec</span> -it 容器ID /bin/bash <span class="hljs-comment">#进入容器根目录 ,可以访问相关页面</span><br><br><span class="hljs-comment"># 7. 访问成功后, 添加jsp文件与web.xml文件( a.jsp用于访问测试 ,web.xml用于令jsp页面可以编译)</span><br>vim a.jsp<br>mkidr WEB-INF<br>vim /WEB-INF/web.xml<br>------------------------------------------a.jsp---------------------------<br>&lt;%@ page language=<span class="hljs-string">&quot;java&quot;</span> contentType=<span class="hljs-string">&quot;text/html; charset=UTF-8&quot;</span> pageEncoding=<span class="hljs-string">&quot;UTF-8&quot;</span>%&gt;<br>&lt;!DOCTYPE html PUBLIC <span class="hljs-string">&quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;</span> <span class="hljs-string">&quot;http://www.w3.org/TR/html4/loose.dtd&quot;</span>&gt;<br>&lt;html&gt;<br>  &lt;head&gt;<br>    &lt;meta http-equiv=<span class="hljs-string">&quot;Content-Type&quot;</span> content=<span class="hljs-string">&quot;text/html; charset=UTF-8&quot;</span>&gt;<br>    &lt;title&gt;Insert title here&lt;/title&gt;<br>  &lt;/head&gt;<br>  &lt;body&gt;<br><br>    -----------welcome------------<br>    &lt;=<span class="hljs-string">&quot;i am in docker tomcat self &quot;</span>%&gt;<br>    &lt;br&gt;<br>    &lt;br&gt;<br>    &lt;% System.out.println(<span class="hljs-string">&quot;=============docker tomcat self&quot;</span>);%&gt;<br>  &lt;/body&gt;<br>&lt;/html&gt;<br>------------------------------------------a.jsp---------------------------<br><br><br>------------------------------------------web.xml-----------------------------------<br>&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span>?&gt;<br><br>&lt;web-app xmlns=<span class="hljs-string">&quot;http://xmlns.jcp.org/xml/ns/javaee&quot;</span><br>  xmlns:xsi=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><br>  xsi:schemaLocation=<span class="hljs-string">&quot;http://xmlns.jcp.org/xml/ns/javaee</span><br><span class="hljs-string">                      http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd&quot;</span><br>  version=<span class="hljs-string">&quot;4.0&quot;</span><br>  metadata-complete=<span class="hljs-string">&quot;true&quot;</span>&gt;<br>&lt;/web-app&gt;<br>------------------------------------------web.xml-----------------------------------<br><br><span class="hljs-comment"># 8. 重启服务, 访问a.jsp</span><br><span class="hljs-comment"># 查看当前容器id</span><br>docker ps (查看当前容器ID)<br>docker ps -a (查看所有运行过的容器ID)<br><span class="hljs-comment"># 重启服务</span><br>docker restart 容器ID<br><span class="hljs-comment"># 访问a.jsp页面</span><br></code></pre></td></tr></table></figure>



<h1 id="四、Docker安装软件"><a href="#四、Docker安装软件" class="headerlink" title="四、Docker安装软件"></a>四、Docker安装软件</h1><h2 id="4-1-MySQL"><a href="#4-1-MySQL" class="headerlink" title="4.1 MySQL"></a>4.1 MySQL</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 1. 以安装mysql5.6为例(不知道什么原因5.7下不来)</span><br>docker pull mysql:5.6<br><br><span class="hljs-comment"># 2. 运行镜像,启动容器(端口3306,root用户密码:root,运行镜像:mysql5.6)</span><br>docker run -p 3306:3306 --name mysql -v /datebase/mysql/conf:/etc/mysql/conf.d -v /datebase/mysql/logs:/logs -v /datebase/mysql/data:/var/lib/mysql -e MYSQL_ROOT_PASSWORD=root -d mysql:5.6<br><br><span class="hljs-comment"># 3. 进入msql内部测试登陆</span><br>docker ps<br><span class="hljs-comment">## 进入mysql的当前目录下</span><br>docker <span class="hljs-built_in">exec</span> -it MySQL运行成功后的容器ID/name     /bin/bash<br><span class="hljs-comment">## 输入账号密码</span><br>mysql -u 账号 -p(然后根据提示输入密码)<br><br><br><span class="hljs-comment"># 4.连接数据库的图形化界面</span><br><span class="hljs-comment">## Mysql 解决连接客户端时出现1251 client does not support ...问题</span><br>ALTER USER  <span class="hljs-string">&#x27;root&#x27;</span>@<span class="hljs-string">&#x27;%&#x27;</span> IDENTIFIED WITH mysql_native_password BY <span class="hljs-string">&#x27;mysql密码&#x27;</span>;<br>ALTER USER  <span class="hljs-string">&#x27;root&#x27;</span>@<span class="hljs-string">&#x27;localhost&#x27;</span> IDENTIFIED WITH mysql_native_password BY <span class="hljs-string">&#x27;mysql密码&#x27;</span>;<br><br><span class="hljs-comment"># 5. 备份数据库数据,之后我们可以通过直接读取这个sql文件恢复数据</span><br>docker <span class="hljs-built_in">exec</span> myql服务容器ID sh -c <span class="hljs-string">&#x27; exec mysqldump --all-databases -uroot -p&quot;root&quot; &#x27;</span> &gt; /datebase/all-databases.sql<br></code></pre></td></tr></table></figure>

<h2 id="4-2-Redis"><a href="#4-2-Redis" class="headerlink" title="4.2 Redis"></a>4.2 Redis</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 1.下载最新版redis镜像</span><br>docker pull redis<br><br><span class="hljs-comment"># 2.运行镜像(redis端口2333, -d后的redis不加参数默认为redis:latest)</span><br><span class="hljs-comment"># 注意本地数据卷与容器内数据卷目录的对应</span><br>docker run -p 2333:6379 -v /myuse/myredis/data:/data -v /myuse/myredis/conf/redis.conf:/usr/<span class="hljs-built_in">local</span>/etc/redis/redis.conf  -d redis redis-server /usr/<span class="hljs-built_in">local</span>/etc/redis/redis.conf --appendonly yes<br><span class="hljs-comment"># 以带密码的方式启动, 密码设置为root</span><br>docker run -p 2333:6379 -v /myuse/myredis/data:/data -v /myuse/myredis/conf/redis.conf:/usr/<span class="hljs-built_in">local</span>/etc/redis/redis.conf  -d redis redis-server /usr/<span class="hljs-built_in">local</span>/etc/redis/redis.conf --appendonly yes  --requirepass <span class="hljs-string">&quot;root&quot;</span><br><span class="hljs-comment"># 或者不适用上面的容器卷, 使用docker 默认配置, 并设置自动重启</span><br>docker run --name redis -p 6379:6379 -d --restart=always redis:latest redis-server --appendonly yes --requirepass <span class="hljs-string">&quot;root&quot;</span><br><br><span class="hljs-comment"># 3.上传redis.conf到本地数据卷所在目录</span><br>本地数据卷坐在目录 : /myuse/myredis/conf<br>文件地址(太大了 ,这里放不下) : https://download.csdn.net/download/qq_43371556/11889084<br><br><span class="hljs-comment"># 4. 运行redis的cil----shell命令行</span><br>docker <span class="hljs-built_in">exec</span> -it 运行着Rediis服务的容器ID redis-cli<br><span class="hljs-comment"># 远程连接 docker redis</span><br>docker <span class="hljs-built_in">exec</span> -it redis_s redis-cli -h 192.168.1.100 -p 6379 -a your_password //如果有密码 使用 -a参数<br>12345678910111213141516171819<br></code></pre></td></tr></table></figure>

<h2 id="4-3-RabbitMQ"><a href="#4-3-RabbitMQ" class="headerlink" title="4.3 RabbitMQ"></a>4.3 RabbitMQ</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 1.下载镜像</span><br>docker pull rabbitmq:3.7.7-management<br><br><span class="hljs-comment"># 2.运行镜像</span><br>docker run -d --name rabbitmq3.7.7 -p 5672:5672 -p 15672:15672 -v `<span class="hljs-built_in">pwd</span>`/data:/var/lib/rabbitmq --hostname myRabbit -e RABBITMQ_DEFAULT_VHOST=/ -e RABBITMQ_DEFAULT_USER=admin -e RABBITMQ_DEFAULT_PASS=admin df80af9ca0c9<br><br>-d 后台运行容器；<br>--name 指定容器名；<br>-p 指定服务运行的端口（5672：应用访问端口；15672：控制台Web端口号）；<br>-v 映射目录或文件；<br>--hostname  主机名（RabbitMQ的一个重要注意事项是它根据所谓的 “节点名称” 存储数据，默认为主机名）；<br>-e 指定环境变量；（RABBITMQ_DEFAULT_VHOST：默认虚拟机名；RABBITMQ_DEFAULT_USER：默认的用户名；RABBITMQ_DEFAULT_PASS：默认用户名的密码）<br><br><br><span class="hljs-comment"># 3.访问 (如下图)</span><br>http://ip:15672<br>账号 :admin<br>密码: admin<br></code></pre></td></tr></table></figure>

<h2 id="4-4-MongoDB"><a href="#4-4-MongoDB" class="headerlink" title="4.4 MongoDB"></a>4.4 MongoDB</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 1.查看docker+MongoDB版本(图1)</span><br>docker search<br><br><span class="hljs-comment"># 2.下载最新的MongoDB</span><br>docker pull mongo<br><br><span class="hljs-comment"># 3.将镜像运行成容器</span><br>docker run -itd --name mongo -p 27017:27017 mongo --auth<br><span class="hljs-comment">## 参数说明：</span><br>-p 27017:27017 ：映射容器服务的 27017 端口到宿主机的 27017 端口。外部可以直接通过 宿主机 ip:27017 访问到 mongo 的服务。<br>--auth：需要密码才能访问容器服务。<br><br><span class="hljs-comment"># 4.使用以下命令添加用户和设置密码，并且尝试连接。</span><br>$ docker <span class="hljs-built_in">exec</span> -it mongo mongo admin<br><span class="hljs-comment"># 创建一个名为 admin，密码为 123456 的用户。</span><br>&gt;  db.createUser(&#123; user:<span class="hljs-string">&#x27;admin&#x27;</span>,<span class="hljs-built_in">pwd</span>:<span class="hljs-string">&#x27;123456&#x27;</span>,roles:[ &#123; role:<span class="hljs-string">&#x27;userAdminAnyDatabase&#x27;</span>, db: <span class="hljs-string">&#x27;admin&#x27;</span>&#125;]&#125;);<br><span class="hljs-comment"># 尝试使用上面创建的用户信息进行连接。</span><br>&gt; db.auth(<span class="hljs-string">&#x27;admin&#x27;</span>, <span class="hljs-string">&#x27;123456&#x27;</span>)<br></code></pre></td></tr></table></figure>

<h2 id="4-5-安装vsftpd-Nignx-图片服务器"><a href="#4-5-安装vsftpd-Nignx-图片服务器" class="headerlink" title="4.5 安装vsftpd+Nignx(图片服务器)"></a>4.5 安装vsftpd+Nignx(图片服务器)</h2><h3 id="4-5-1-环境搭建"><a href="#4-5-1-环境搭建" class="headerlink" title="4.5.1 环境搭建"></a>4.5.1 环境搭建</h3><blockquote>
<p>通过搭建Nginx和vfstpd 实现文件服务器</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> 1. 安装docker-compose . 实现对相关软件的配置</span><br>curl -L https://get.daocloud.io/docker/compose/releases/download/1.25.4/docker-compose-`uname -s`-`uname -m` &gt; /usr/local/bin/docker-compose<br>chmod +x /usr/local/bin/docker-compose<br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash"> 2. 编写docker-compose.yml 配置文件</span><br><span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment"># 需要需要修改的地方的是:</span></span> <br><span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment"># /data/ftp:/home/vsftpd/ftpuser(20行), /data/ftp 是ftp中图片存放的地址</span></span><br><span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment"># /data/ftp:/home/images(11行) , /data/ftp 是Nginx来对应ftp中图片存放的地址</span></span><br><span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment"># FTP_USER,FTP_PASS 代表ftp用户的账号和密码, 需要在Linux中提前添加用户</span></span> <br><span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment"># 添加用户命令 a. useradd ftpuser,b. passwd ftpuser 然后输入自定义密码</span></span>  <br><span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment"># ~/pic/nginx/conf/nginx.conf(9行), 注意! 需要提前准备Nginx的配置文件nginx.conf, ~ 代表home目录</span></span><br><span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment"># PASV_ADDRESS: 192.168.40.21, PASV_ADDRESS后面填写的是ftp服务器的ip</span></span><br>----------------docker-compose.yml---------------------<br>version: &#x27;2&#x27;<br>services:<br>  nginx-image:<br>    image: nginx:1.15.8<br>    ports:<br>      - &quot;80:80&quot;<br>    volumes:<br>      - ~/pic/nginx/html:/usr/share/nginx/html<br>      - ~/pic/nginx/conf/nginx.conf:/etc/nginx/nginx.conf<br>      - ~/pic/nginx/logs:/var/log/nginx<br>      - /data/ftp:/home/images<br>    restart: always<br>  vsftpd:<br>    image: fauria/vsftpd<br>    ports:<br>      - &quot;20:20&quot;<br>      - &quot;21:21&quot;<br>      - &quot;21100-21110:21100-21110&quot;<br>    volumes:<br>      - /data/ftp:/home/vsftpd/ftpuser<br>    environment:<br>      FTP_USER: ftpuser<br>      FTP_PASS: 1q2w3e4r<br>      PASV_ADDRESS: 192.168.40.21<br>      PASV_MIN_PORT: 21100<br>      PASV_MAX_PORT: 21110<br>      LOCAL_UMASK: 022<br>    restart: always<br>-------------------------------------<br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash"> 3. 分享上面需要nginx.conf文件放在下面了</span><br>vim /home/pic/nginx/conf/nginx.conf<br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash"> 4. docker-compose执行, 需要在docker-compose.yml所在的目录下执行</span><br>docker-compose up -d<br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash"> 5. docker ps(查看容器是否执行, 下图1)</span><br></code></pre></td></tr></table></figure>

<p><strong>上面第三步所需的nginx.conf配置文件</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> root   /data/ftp/, /data/ftp/代表的是我们上面配置的ftp图片存放的地址, 只需要修改这一处</span><br>location / &#123; root   /data/ftp/;i ..... &#125;<br></code></pre></td></tr></table></figure>

<p>完整配置文件</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">user  nobody;</span><br>worker_processes  1;<br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash">error_log  logs/error.log;</span><br><span class="hljs-meta">#</span><span class="bash">error_log  logs/error.log  notice;</span><br><span class="hljs-meta">#</span><span class="bash">error_log  logs/error.log  info;</span><br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash">pid        logs/nginx.pid;</span><br><br><br>events &#123;<br>    worker_connections  1024;<br>&#125;<br><br><br>http &#123;<br>    include       mime.types;<br>    default_type  application/octet-stream;<br><br>    #log_format  main  &#x27;$remote_addr - $remote_user [$time_local] &quot;$request&quot; &#x27;<br>    #                  &#x27;$status $body_bytes_sent &quot;$http_referer&quot; &#x27;<br>    #                  &#x27;&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;&#x27;;<br><br>    #access_log  logs/access.log  main;<br><br>    sendfile        on;<br>    #tcp_nopush     on;<br><br>    #keepalive_timeout  0;<br>    keepalive_timeout  65;<br><br>    #gzip  on;<br><br>    server &#123;<br>        listen       80;<br>        server_name  localhost;<br><br>        #charset koi8-r;<br><br>        #access_log  logs/host.access.log  main;<br><br>        location / &#123;<br>            root   /data/ftp/; # /data/ftp/代表的是我们上面配置的ftp图片存放的地址, 只需要修改这一处<br>            index  index.html index.htm;<br>        &#125;<br><br>        #error_page  404              /404.html;<br><br>        # redirect server error pages to the static page /50x.html<br>        #<br>        error_page   500 502 503 504  /50x.html;<br>        location = /50x.html &#123;<br>            root   html;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="4-5-2-代码测试"><a href="#4-5-2-代码测试" class="headerlink" title="4.5.2 代码测试"></a>4.5.2 代码测试</h3><ol>
<li>添加依赖</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!--文件上传与下载--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>commons-net<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>commons-net<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.3<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.slf4j<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>slf4j-api<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.7.7<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>compile<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure>

<ol>
<li>工具类代码</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.clife.common.utils;<br><br><span class="hljs-keyword">import</span> org.apache.commons.net.ftp.FTP;<br><span class="hljs-keyword">import</span> org.apache.commons.net.ftp.FTPClient;<br><span class="hljs-keyword">import</span> org.apache.commons.net.ftp.FTPFile;<br><span class="hljs-keyword">import</span> org.apache.commons.net.ftp.FTPReply;<br><span class="hljs-keyword">import</span> org.slf4j.Logger;<br><span class="hljs-keyword">import</span> org.slf4j.LoggerFactory;<br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Value;<br><br><span class="hljs-keyword">import</span> java.io.*;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * ftp上传下载工具类</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FtpUtil</span> </span>&#123;<br><br>	<span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span>   String hostname=<span class="hljs-string">&quot;192.168.40.21&quot;</span>;<br>	<span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span>   <span class="hljs-keyword">int</span> port=<span class="hljs-number">21</span>;<br>	<span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span>   String ftpusername=<span class="hljs-string">&quot;ftpuser&quot;</span>;<br>	<span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span>   String ftppassword=<span class="hljs-string">&quot;ftpuser&quot;</span>;<br>	<span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span>   String basePath=<span class="hljs-string">&quot;/data/ftp&quot;</span>;<br>	<span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span>   String filePath=<span class="hljs-string">&quot;&quot;</span>;<br><br>	<span class="hljs-comment">//日志打印</span><br>	<span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> Logger logger = LoggerFactory.getLogger(FtpUtil.class);<br><br>	<span class="hljs-comment">/**</span><br><span class="hljs-comment">	 * 文件上传封装方法</span><br><span class="hljs-comment">	 * <span class="hljs-doctag">@param</span> sourceFileName 本地文件绝对地址,目录+文件名, eg:D:\\1.jpg</span><br><span class="hljs-comment">	 * <span class="hljs-doctag">@param</span> targetFileName 上传到ftp服务器/data/ftp/目录下的文件名</span><br><span class="hljs-comment">	 * <span class="hljs-doctag">@return</span></span><br><span class="hljs-comment">	 * <span class="hljs-doctag">@throws</span> FileNotFoundException</span><br><span class="hljs-comment">	 */</span><br>	<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">ftpUploadFile</span><span class="hljs-params">(String sourceFileName, String targetFileName)</span> <span class="hljs-keyword">throws</span> FileNotFoundException </span>&#123;<br>		FileInputStream in=<span class="hljs-keyword">new</span> FileInputStream(<span class="hljs-keyword">new</span> File(sourceFileName));<br>		<span class="hljs-keyword">boolean</span> b = uploadFile(hostname, port, ftpusername, ftppassword, basePath, filePath, targetFileName, in);<br>		<span class="hljs-keyword">return</span> b;<br>	&#125;<br><br>	<span class="hljs-comment">/**</span><br><span class="hljs-comment">	 * Description: 向FTP服务器上传文件</span><br><span class="hljs-comment">	 * <span class="hljs-doctag">@param</span> host FTP服务器hostname</span><br><span class="hljs-comment">	 * <span class="hljs-doctag">@param</span> port FTP服务器端口</span><br><span class="hljs-comment">	 * <span class="hljs-doctag">@param</span> username FTP登录账号</span><br><span class="hljs-comment">	 * <span class="hljs-doctag">@param</span> password FTP登录密码</span><br><span class="hljs-comment">	 * <span class="hljs-doctag">@param</span> basePath FTP服务器基础目录</span><br><span class="hljs-comment">	 * <span class="hljs-doctag">@param</span> filePath FTP服务器文件存放路径。例如分日期存放：/2015/01/01。文件的路径为basePath+filePath</span><br><span class="hljs-comment">	 * <span class="hljs-doctag">@param</span> filename 上传到FTP服务器上的文件名</span><br><span class="hljs-comment">	 * <span class="hljs-doctag">@param</span> input 输入流</span><br><span class="hljs-comment">	 * <span class="hljs-doctag">@return</span> 成功返回true，否则返回false</span><br><span class="hljs-comment">	 */</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">uploadFile</span><span class="hljs-params">(String host, <span class="hljs-keyword">int</span> port, String username, String password, String basePath,</span></span><br><span class="hljs-params"><span class="hljs-function">			String filePath, String filename, InputStream input)</span> </span>&#123;<br>		<span class="hljs-keyword">boolean</span> result = <span class="hljs-keyword">false</span>;<br>		FTPClient ftp = <span class="hljs-keyword">new</span> FTPClient();<br>		<span class="hljs-keyword">try</span> &#123;<br>			<span class="hljs-keyword">int</span> reply;<br>			ftp.connect(host, port);<span class="hljs-comment">// 连接FTP服务器</span><br>			logger.info(<span class="hljs-string">&quot;连接ftp成功...&quot;</span>);<br>			<span class="hljs-comment">// 如果采用默认端口，可以使用ftp.connect(host)的方式直接连接FTP服务器</span><br>			ftp.login(username, password);<span class="hljs-comment">// 登录</span><br>			logger.info(<span class="hljs-string">&quot;ftp用户登陆成功！！！&quot;</span>);<br>			reply = ftp.getReplyCode();<br>			<span class="hljs-keyword">if</span> (!FTPReply.isPositiveCompletion(reply)) &#123;<br>				ftp.disconnect();<br>				<span class="hljs-keyword">return</span> result;<br>			&#125;<br>			<span class="hljs-comment">//切换到上传目录</span><br>			<span class="hljs-keyword">if</span> (!ftp.changeWorkingDirectory(basePath+filePath)) &#123;<br>				<span class="hljs-comment">//如果目录不存在创建目录</span><br>				String[] dirs = filePath.split(<span class="hljs-string">&quot;/&quot;</span>);<br>				String tempPath = basePath;<br>				<span class="hljs-keyword">for</span> (String dir : dirs) &#123;<br>					<span class="hljs-keyword">if</span> (<span class="hljs-keyword">null</span> == dir || <span class="hljs-string">&quot;&quot;</span>.equals(dir)) &#123;<span class="hljs-keyword">continue</span>;&#125;<br>					tempPath += <span class="hljs-string">&quot;/&quot;</span> + dir;<br>					<span class="hljs-keyword">if</span> (!ftp.changeWorkingDirectory(tempPath)) &#123;<br>						<span class="hljs-keyword">if</span> (!ftp.makeDirectory(tempPath)) &#123;<br>							<span class="hljs-keyword">return</span> result;<br>						&#125; <span class="hljs-keyword">else</span> &#123;<br>							ftp.enterRemotePassiveMode();<br>							ftp.changeWorkingDirectory(tempPath);<br>						&#125;<br>					&#125;<br>				&#125;<br>			&#125;<br>			<span class="hljs-comment">//设置上传文件的类型为二进制类型</span><br>			ftp.setFileType(FTP.BINARY_FILE_TYPE);<br>			<span class="hljs-comment">//上传文件</span><br>			<span class="hljs-keyword">if</span> (!ftp.storeFile(filename, input)) &#123;<br>				logger.info(<span class="hljs-string">&quot;文件 &#123;&#125; 上传失败!&quot;</span>,filename);<br>				<span class="hljs-keyword">return</span> result;<br>			&#125;<br>			input.close();<br>			ftp.logout();<br>			result = <span class="hljs-keyword">true</span>;<br>			logger.info(<span class="hljs-string">&quot;文件 &#123;&#125; 上传成功!&quot;</span>,filename);<br>		&#125; <span class="hljs-keyword">catch</span> (IOException e) &#123;<br>			e.printStackTrace();<br>		&#125; <span class="hljs-keyword">finally</span> &#123;<br>			<span class="hljs-keyword">if</span> (ftp.isConnected()) &#123;<br>				<span class="hljs-keyword">try</span> &#123;<br>					ftp.disconnect();<br>				&#125; <span class="hljs-keyword">catch</span> (IOException ioe) &#123;<br>				&#125;<br>			&#125;<br>		&#125;<br>		<span class="hljs-keyword">return</span> result;<br>	&#125;<br><br><br><br>	<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>		<span class="hljs-comment">//FileInputStream in=new FileInputStream(new File(&quot;D:\\1.jpg&quot;));</span><br>		<span class="hljs-comment">//boolean flag = uploadFile(&quot;192.168.40.21&quot;, 21, &quot;ftpuser&quot;, &quot;ftpuser&quot;, &quot;/data/ftp&quot;,&quot;&quot;, &quot;123.png&quot;, in);</span><br>		<span class="hljs-keyword">boolean</span> flag = <span class="hljs-keyword">false</span>;<br>		<span class="hljs-keyword">try</span> &#123;<br>			flag = ftpUploadFile(<span class="hljs-string">&quot;D:\\11.jpg&quot;</span>, <span class="hljs-string">&quot;6666.jpg&quot;</span>);<br>			System.out.println(flag);<br>		&#125; <span class="hljs-keyword">catch</span> (FileNotFoundException e) &#123;<br>			e.printStackTrace();<br>		&#125;<br><br><br>	&#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<ol>
<li>图片访问<br><a target="_blank" rel="noopener" href="http://192.168.40.21/6666.jpg">http://192.168.40.21/6666.jpg</a></li>
</ol>
<h1 id="五、发布镜像到阿里云"><a href="#五、发布镜像到阿里云" class="headerlink" title="五、发布镜像到阿里云"></a>五、发布镜像到阿里云</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 1.登陆阿里云, 进入容器镜像服务(可以通过下方地址注册登录跳转到容器镜像服务)</span><br>https://cr.console.aliyun.com/cn-hangzhou/instances/repositories<br><br><span class="hljs-comment"># 2. 创建镜像仓库(图1)</span><br><span class="hljs-comment"># 3. 在docker中登陆 ,根据图2,图3中的操作指南进行操作</span><br><br><span class="hljs-comment"># 5. 将正在运行的容器创建成一个镜像(图4)</span><br>docker commit <br><br>OPTIONS说明：<br>-a :提交的镜像作者；<br>-m :提交时的说明文字；<br><br><span class="hljs-comment"># 4.将镜像推送到阿里云的镜像仓库(最好是根据阿里云上的操作指南)</span><br>docker tag [ImageId] registry.cn-hangzhou.aliyuncs.com/timepause/mydocker:[镜像版本号]<br>sudo docker push registry.cn-hangzhou.aliyuncs.com/timepause/mydocker:[镜像版本号]<br><br><span class="hljs-comment"># 5. 搜索镜像 ,下载镜像(图5,图6)</span><br>docker pull 复制的镜像地址<br></code></pre></td></tr></table></figure>

<p><img data-fancybox="gallery" data-sizes="auto" data-src="Docker%E9%95%9C%E5%83%8F.assets/image-20220405095142522.png" alt="image-20220405095142522" class="lazyload"></p>
<p><img data-fancybox="gallery" data-sizes="auto" data-src="Docker%E9%95%9C%E5%83%8F.assets/image-20220405095158514.png" alt="image-20220405095158514" class="lazyload"></p>
<p><img data-fancybox="gallery" data-sizes="auto" data-src="Docker%E9%95%9C%E5%83%8F.assets/image-20220405095216986.png" alt="image-20220405095216986" class="lazyload"></p>
<p><img data-fancybox="gallery" data-sizes="auto" data-src="Docker%E9%95%9C%E5%83%8F.assets/image-20220405095230968.png" alt="image-20220405095230968" class="lazyload"></p>
<p><img data-fancybox="gallery" data-sizes="auto" data-src="Docker%E9%95%9C%E5%83%8F.assets/image-20220405095250515.png" alt="image-20220405095250515" class="lazyload"></p>
<p><img data-fancybox="gallery" data-sizes="auto" data-src="Docker%E9%95%9C%E5%83%8F.assets/image-20220405095306360.png" alt="image-20220405095306360" class="lazyload"></p>

  </article>

  
      
    <div class="nexmoe-post-copyright">
        <strong>Author：</strong>Shuyan<br>
        <strong>Link：</strong><a href="http://example.com/2022/04/05/JAVA/Docker/Docker%E9%95%9C%E5%83%8F/" title="http:&#x2F;&#x2F;example.com&#x2F;2022&#x2F;04&#x2F;05&#x2F;JAVA&#x2F;Docker&#x2F;Docker%E9%95%9C%E5%83%8F&#x2F;" target="_blank" rel="noopener">http:&#x2F;&#x2F;example.com&#x2F;2022&#x2F;04&#x2F;05&#x2F;JAVA&#x2F;Docker&#x2F;Docker%E9%95%9C%E5%83%8F&#x2F;</a><br>
        
            <strong>版权声明：</strong>本文采用 <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/cn/deed.zh" target="_blank">CC BY-NC-SA 3.0 CN</a> 协议进行许可
        
    </div>


  
  
  <div class="nexmoe-post-meta nexmoe-rainbow">
    
        <a class="nexmoefont icon-appstore-fill -link" href="/categories/JAVA/">JAVA</a><a class="nexmoefont icon-appstore-fill -link" href="/categories/JAVA/%E2%80%9CDocker%E2%80%9D/">“Docker”</a>
    
    
        <a class="nexmoefont icon-tag-fill -none-link" href="/tags/Docker/" rel="tag">Docker</a>
    
</div>

  
      <div class="nexmoe-post-footer">
          <section class="nexmoe-comment">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@latest/dist/gitalk.min.css">
<div id="gitalk"></div>
<script src="https://cdn.jsdelivr.net/npm/gitalk@latest/dist/gitalk.min.js"></script>
<script type="text/javascript">
    var gitalk = new Gitalk({
        clientID: '80b2453b6d5f37ad6225',
        clientSecret: '43e99fa852795c9a7b3eb924b2558c64b84bbdeb',
        id: window.location.pathname,
        repo: 'nexmoe.github.io',
        owner: 'nexmoe',
        admin: 'nexmoe'
    })
    gitalk.render('gitalk')
</script>
</section>
      </div>
  
</div>
            <div class="nexmoe-post-right">
              <div class="nexmoe-fixed">
                  <div class="nexmoe-tool"> 
                    
                      
                        
                          
                          
                              <button class="mdui-fab catalog" style="overflow:unset;">
                                  <i class="nexmoefont icon-i-catalog"></i>
                                  <div class="nexmoe-toc">
                                      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%80%E3%80%81Docker%E9%95%9C%E5%83%8F"><span class="toc-number">1.</span> <span class="toc-text">一、Docker镜像</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-1-%E9%95%9C%E5%83%8F-UnionFS%EF%BC%88%E8%81%94%E5%90%88%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%EF%BC%89"><span class="toc-number">1.1.</span> <span class="toc-text">1.1 镜像 &#x2F; UnionFS（联合文件系统）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-2-%E7%89%B9%E7%82%B9"><span class="toc-number">1.2.</span> <span class="toc-text">1.2 特点</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-3-Docker%E9%95%9C%E5%83%8F%E5%8A%A0%E8%BD%BD%E5%8E%9F%E7%90%86%EF%BC%9A"><span class="toc-number">1.3.</span> <span class="toc-text">1.3 Docker镜像加载原理：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-4-Docker%E9%95%9C%E5%83%8FCommit%E6%93%8D%E4%BD%9C"><span class="toc-number">1.4.</span> <span class="toc-text">1.4 Docker镜像Commit操作</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%8C%E3%80%81Docker%E5%AE%B9%E5%99%A8%E6%95%B0%E6%8D%AE%E5%8D%B7"><span class="toc-number">2.</span> <span class="toc-text">二、Docker容器数据卷</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#2-1-%E5%AE%B9%E5%99%A8%E5%86%85%E6%B7%BB%E5%8A%A0%E6%95%B0%E6%8D%AE%E5%8D%B7"><span class="toc-number">2.1.</span> <span class="toc-text">2.1 容器内添加数据卷</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-%E7%9B%B4%E6%8E%A5%E5%91%BD%E4%BB%A4%E6%B7%BB%E5%8A%A0"><span class="toc-number">2.1.1.</span> <span class="toc-text">2.1 直接命令添加</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-Docker%E6%B7%BB%E5%8A%A0"><span class="toc-number">2.1.2.</span> <span class="toc-text">2.2 Docker添加</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-%E6%95%B0%E6%8D%AE%E5%8D%B7%E5%AE%B9%E5%99%A8"><span class="toc-number">2.1.3.</span> <span class="toc-text">2.3 数据卷容器</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%89%E3%80%81DockerFile%E8%A7%A3%E6%9E%90"><span class="toc-number">3.</span> <span class="toc-text">三、DockerFile解析</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#3-1-%E6%9E%84%E5%BB%BA%E6%AD%A5%E9%AA%A4"><span class="toc-number">3.1.</span> <span class="toc-text">3.1 构建步骤</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-1-%E6%A0%BC%E5%BC%8F"><span class="toc-number">3.1.1.</span> <span class="toc-text">3.1.1 格式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-2-%E8%AF%AD%E6%B3%95"><span class="toc-number">3.1.2.</span> <span class="toc-text">3.1.2 语法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-3-Docker%E6%89%A7%E8%A1%8CDockerFile%E7%9A%84%E5%A4%A7%E8%87%B4%E6%B5%81%E7%A8%8B"><span class="toc-number">3.1.3.</span> <span class="toc-text">3.1.3 Docker执行DockerFile的大致流程</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-2-DockerFile%E4%BF%9D%E7%95%99%E5%AD%97%E6%8C%87%E4%BB%A4"><span class="toc-number">3.2.</span> <span class="toc-text">3.2 DockerFile保留字指令</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-1-%E4%BF%9D%E7%95%99%E5%AD%97%E6%95%B4%E5%90%88%E6%A1%88%E4%BE%8B"><span class="toc-number">3.2.1.</span> <span class="toc-text">3.2.1 保留字整合案例</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E9%95%9C%E5%83%8F"><span class="toc-number">3.2.1.1.</span> <span class="toc-text">自定义镜像</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89tomcat9"><span class="toc-number">3.2.1.2.</span> <span class="toc-text">自定义tomcat9</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9B%9B%E3%80%81Docker%E5%AE%89%E8%A3%85%E8%BD%AF%E4%BB%B6"><span class="toc-number">4.</span> <span class="toc-text">四、Docker安装软件</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#4-1-MySQL"><span class="toc-number">4.1.</span> <span class="toc-text">4.1 MySQL</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-2-Redis"><span class="toc-number">4.2.</span> <span class="toc-text">4.2 Redis</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-3-RabbitMQ"><span class="toc-number">4.3.</span> <span class="toc-text">4.3 RabbitMQ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-4-MongoDB"><span class="toc-number">4.4.</span> <span class="toc-text">4.4 MongoDB</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-5-%E5%AE%89%E8%A3%85vsftpd-Nignx-%E5%9B%BE%E7%89%87%E6%9C%8D%E5%8A%A1%E5%99%A8"><span class="toc-number">4.5.</span> <span class="toc-text">4.5 安装vsftpd+Nignx(图片服务器)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-5-1-%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA"><span class="toc-number">4.5.1.</span> <span class="toc-text">4.5.1 环境搭建</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-5-2-%E4%BB%A3%E7%A0%81%E6%B5%8B%E8%AF%95"><span class="toc-number">4.5.2.</span> <span class="toc-text">4.5.2 代码测试</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%94%E3%80%81%E5%8F%91%E5%B8%83%E9%95%9C%E5%83%8F%E5%88%B0%E9%98%BF%E9%87%8C%E4%BA%91"><span class="toc-number">5.</span> <span class="toc-text">五、发布镜像到阿里云</span></a></li></ol>
                                  </div>
                              </button>
                          
                          
                      
                    
                      <a href="#nexmoe-content" class="toc-link" aria-label="回到顶部" title="top"><button class="mdui-fab mdui-ripple"><i class="nexmoefont icon-caret-top"></i></button></a>
                  </div>
              </div>
            </div>
        </div>
    </div>
     
    <div id="nexmoe-search-space">
        <div class="search-container">
            <div class="search-header">
                <div class="search-input-container">
                    <input class="search-input" type="text" placeholder="Search" oninput="sinput();">
                </div>
                <a class="search-close" onclick="sclose();">×</a>
            </div>
            <div class="search-body"></div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/combine/npm/lazysizes@5.1.0/lazysizes.min.js,npm/mdui@0.4.3/dist/js/mdui.min.js?v=1"></script>
<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>

 

<script async src="/js/app.js?v=1653534086793"></script>



<script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js"></script>
<script>
	$(".justified-gallery").justifiedGallery({
		rowHeight: 160,
		margins: 10,
	});
</script>


    





    <!-- baidu Analytics -->
<script>
    var _hmt = _hmt || [];
    (function() {var hm = document.createElement('script');
    hm.src = 'https://hm.baidu.com/hm.js?0a7e154da92f76d05c83b48cbab331da#&lt;ID&gt;';
    var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(hm, s);
    })();
</script>

</body>

</html>
