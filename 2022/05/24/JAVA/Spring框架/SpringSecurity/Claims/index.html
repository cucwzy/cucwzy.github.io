<!DOCTYPE html>

<html lang="en">

<head>
    
    <title>Claims - Shuyan</title>
    <meta charset="UTF-8">
    <meta name="keywords" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5">
    
    

    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
    <meta name="description" content="Java Claims类代码示例本文整理汇总了Java中io.jsonwebtoken.Claims类的典型用法代码示例。如果您正苦于以下问题：Java Claims类的具体用法？Java Claims怎么用？Java Claims使用的例子？那么恭喜您, 这里精选的类代码示例或许可以为您提供帮助。 Claims类属于io.jsonwebtoken包，在下文中一共展示了Claims类的20个代码示">
<meta property="og:type" content="article">
<meta property="og:title" content="Claims">
<meta property="og:url" content="http://example.com/2022/05/24/JAVA/Spring%E6%A1%86%E6%9E%B6/SpringSecurity/Claims/index.html">
<meta property="og:site_name" content="Shuyan">
<meta property="og:description" content="Java Claims类代码示例本文整理汇总了Java中io.jsonwebtoken.Claims类的典型用法代码示例。如果您正苦于以下问题：Java Claims类的具体用法？Java Claims怎么用？Java Claims使用的例子？那么恭喜您, 这里精选的类代码示例或许可以为您提供帮助。 Claims类属于io.jsonwebtoken包，在下文中一共展示了Claims类的20个代码示">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2022-05-24T03:29:01.000Z">
<meta property="article:modified_time" content="2022-05-25T10:21:24.928Z">
<meta property="article:author" content="Shuyan">
<meta property="article:tag" content="Security">
<meta name="twitter:card" content="summary">
    <link rel="stylesheet" href="/lib/jquery.fancybox.min.css?v=1656038931364">
    
        <link rel="stylesheet" href="//at.alicdn.com/t/font_1038733_0xvrvpg9c0r.css">
    
    <link rel="stylesheet" href="/lib/mdui_043tiny/css/mdui.css?v=1656038931364">
    <link rel="stylesheet" href="/lib/iconfont/iconfont.css?v=1656038931364">
    <link rel="stylesheet" href="/css/style.css?v=1656038931364">
     
    
<meta name="generator" content="Hexo 5.4.0"></head>

<body class="mdui-drawer-body-left">
    
    <div id="nexmoe-background">
        <div class="nexmoe-bg" style="background-image: url(http://mms0.baidu.com/it/u=2467909075,3604847220&amp;fm=253&amp;app=138&amp;f=JPEG&amp;fmt=auto&amp;q=75?w=801&amp;h=500)"></div>
        <div class="mdui-appbar mdui-shadow-0">
            <div class="mdui-toolbar">
                <a mdui-drawer="{target: '#drawer', swipe: true}" title="menu" class="mdui-btn mdui-btn-icon mdui-ripple"><i class="mdui-icon nexmoefont icon-menu"></i></a>
                <div class="mdui-toolbar-spacer"></div>
                <!--<a href="javascript:;" class="mdui-btn mdui-btn-icon"><i class="mdui-icon material-icons">search</i></a>-->
                <a href="/" title="Shuyan" class="mdui-btn mdui-btn-icon"><img src="http://mms2.baidu.com/it/u=1730774443,2723245118&amp;fm=253&amp;app=120&amp;f=JPEG&amp;fmt=auto&amp;q=75?w=500&amp;h=500" alt="Shuyan"></a>
            </div>
        </div>
    </div>
    <div id="nexmoe-header">
        <div class="nexmoe-drawer mdui-drawer" id="drawer">
    <div class="nexmoe-avatar mdui-ripple">
        <a href="/" title="Shuyan">
            <img src="http://mms2.baidu.com/it/u=1730774443,2723245118&amp;fm=253&amp;app=120&amp;f=JPEG&amp;fmt=auto&amp;q=75?w=500&amp;h=500" alt="Shuyan" alt="Shuyan">
        </a>
    </div>
    <div class="nexmoe-count">
        <div><span>Articles</span>95</div>
        <div><span>Tags</span>20</div>
        <div><span>Categories</span>33</div>
    </div>
    <div class="nexmoe-list mdui-list" mdui-collapse="{accordion: true}">
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple false" href="/" title="回到首页">
            <i class="mdui-list-item-icon nexmoefont icon-home"></i>
            <div class="mdui-list-item-content">
                回到首页
            </div>
        </a>
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple false" href="/categories" title="文章归档">
            <i class="mdui-list-item-icon nexmoefont icon-container"></i>
            <div class="mdui-list-item-content">
                文章归档
            </div>
        </a>
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple false" href="/about" title="梦华录">
            <i class="mdui-list-item-icon nexmoefont icon-info-circle"></i>
            <div class="mdui-list-item-content">
                梦华录
            </div>
        </a>
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple false" href="/PY.html" title="我的朋友">
            <i class="mdui-list-item-icon nexmoefont icon-unorderedlist"></i>
            <div class="mdui-list-item-content">
                我的朋友
            </div>
        </a>
        
    </div>
    <aside id="nexmoe-sidebar">
    
    <div class="nexmoe-widget-wrap">
    <div class="nexmoe-widget nexmoe-search">
         
            <form id="search_form" action_e="https://cn.bing.com/search?q=site:nexmoe.com" onsubmit="return search();">
                <label><input id="search_value" name="q" type="search" placeholder="Search"></label>
            </form>
         
    </div>
</div>
    
    <div class="nexmoe-widget-wrap">
    <div class="nexmoe-widget nexmoe-social">
        <a class="mdui-ripple" href="https://qm.qq.com/cgi-bin/qm/qr?k=rd1wdMWxpIZJe5AIruJkY7xD8d68h031&noverify=0" target="_blank" mdui-tooltip="{content: 'QQ'}" style="color: rgb(249, 174, 8);background-color: rgba(249, 174, 8, .1);">
            <i class="nexmoefont icon-QQ"></i>
        </a><a class="mdui-ripple" href="https://space.bilibili.com/400417888" target="_blank" mdui-tooltip="{content: '哔哩哔哩'}" style="color: rgb(231, 106, 141);background-color: rgba(231, 106, 141, .15);">
            <i class="nexmoefont icon-bilibili"></i>
        </a><a class="mdui-ripple" href="https://github.com/nexmoe/" target="_blank" mdui-tooltip="{content: 'GitHub'}" style="color: rgb(25, 23, 23);background-color: rgba(25, 23, 23, .15);">
            <i class="nexmoefont icon-github"></i>
        </a>
    </div>
</div>
    
    
  <div class="nexmoe-widget-wrap">
    <h3 class="nexmoe-widget-title">Categories</h3>
    <div class="nexmoe-widget">

      <ul class="category-list">

        


        

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/C语言/">C语言</a>
          <span class="category-list-count">3</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Docker/">Docker</a>
          <span class="category-list-count">1</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/JAVA/">JAVA</a>
          <span class="category-list-count">42</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/JAVA/“Spring框架”/JavaWeb/">JavaWeb</a>
          <span class="category-list-count">3</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/LaTex/">LaTex</a>
          <span class="category-list-count">1</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Leetcode/">Leetcode</a>
          <span class="category-list-count">21</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Linux/">Linux</a>
          <span class="category-list-count">2</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/JAVA/“Spring框架”/Mybaits/">Mybaits</a>
          <span class="category-list-count">6</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/JAVA/“Spring框架”/SSM/">SSM</a>
          <span class="category-list-count">1</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/C语言/STL/">STL</a>
          <span class="category-list-count">3</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/JAVA/“Spring框架”/Spring/">Spring</a>
          <span class="category-list-count">7</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/JAVA/“Spring框架”/SpringBoot/">SpringBoot</a>
          <span class="category-list-count">3</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/JAVA/“Spring框架”/SpringMVC/">SpringMVC</a>
          <span class="category-list-count">1</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/JAVA/Spring框架/">Spring框架</a>
          <span class="category-list-count">2</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Leetcode/sort/">sort</a>
          <span class="category-list-count">3</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/JAVA/“Docker”/">“Docker”</a>
          <span class="category-list-count">2</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/JAVA/“JAVA基础知识”/">“JAVA基础知识”</a>
          <span class="category-list-count">2</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/JAVA/“JVM”/">“JVM”</a>
          <span class="category-list-count">3</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/JAVA/“Nginx”/">“Nginx”</a>
          <span class="category-list-count">8</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/JAVA/“Redis”/">“Redis”</a>
          <span class="category-list-count">3</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/JAVA/Spring框架/“Security”/">“Security”</a>
          <span class="category-list-count">2</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/JAVA/“Spring框架”/">“Spring框架”</a>
          <span class="category-list-count">22</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Leetcode/二叉树/">二叉树</a>
          <span class="category-list-count">4</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Leetcode/剑指offer/">剑指offer</a>
          <span class="category-list-count">1</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Leetcode/动态规划/">动态规划</a>
          <span class="category-list-count">2</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Leetcode/线性表/单链表/">单链表</a>
          <span class="category-list-count">1</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Leetcode/字符串/">字符串</a>
          <span class="category-list-count">2</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Leetcode/线性表/数组/">数组</a>
          <span class="category-list-count">2</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Leetcode/栈和队列/">栈和队列</a>
          <span class="category-list-count">1</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Leetcode/算法/">算法</a>
          <span class="category-list-count">1</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Leetcode/线性表/">线性表</a>
          <span class="category-list-count">3</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/联邦学习/">联邦学习</a>
          <span class="category-list-count">8</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Leetcode/贪心算法/">贪心算法</a>
          <span class="category-list-count">1</span>
        </li>

        
      </ul>

    </div>
  </div>


    
    
  <div class="nexmoe-widget-wrap">
    <h3 class="nexmoe-widget-title">Tag Cloud</h3>
    <div id="randomtagcloud" class="nexmoe-widget tagcloud">
      <a href="/tags/Docker/" style="font-size: 12.86px;">Docker</a> <a href="/tags/JAVA/" style="font-size: 11.43px;">JAVA</a> <a href="/tags/JVM/" style="font-size: 12.86px;">JVM</a> <a href="/tags/JavaWeb/" style="font-size: 12.86px;">JavaWeb</a> <a href="/tags/LaTex/" style="font-size: 10px;">LaTex</a> <a href="/tags/Leetcode/" style="font-size: 20px;">Leetcode</a> <a href="/tags/Linux/" style="font-size: 11.43px;">Linux</a> <a href="/tags/Mybaits/" style="font-size: 15.71px;">Mybaits</a> <a href="/tags/Nginx/" style="font-size: 18.57px;">Nginx</a> <a href="/tags/Redis/" style="font-size: 12.86px;">Redis</a> <a href="/tags/SSM/" style="font-size: 10px;">SSM</a> <a href="/tags/STL/" style="font-size: 12.86px;">STL</a> <a href="/tags/Security/" style="font-size: 11.43px;">Security</a> <a href="/tags/Spring/" style="font-size: 17.14px;">Spring</a> <a href="/tags/SpringBoot/" style="font-size: 12.86px;">SpringBoot</a> <a href="/tags/SpringMVC/" style="font-size: 11.43px;">SpringMVC</a> <a href="/tags/%E4%BA%8C%E5%8F%89%E6%A0%91/" style="font-size: 14.29px;">二叉树</a> <a href="/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/" style="font-size: 11.43px;">动态规划</a> <a href="/tags/%E6%90%9C%E7%B4%A2/" style="font-size: 11.43px;">搜索</a> <a href="/tags/%E8%81%94%E9%82%A6%E5%AD%A6%E4%B9%A0/" style="font-size: 18.57px;">联邦学习</a>
    </div>
    
  </div>
  <style>
    #nexmoe-header .nexmoe-widget-wrap .tagcloud a:nth-child(7n+1) {
    background-color: rgba(255,78,106,0.15);
    color: rgba(255,78,106,0.8);
    }
    #nexmoe-header .nexmoe-widget-wrap .tagcloud a:nth-child(7n+2) {
    background-color: rgba(255,170,115,0.15);
    color: #ffaa73;
    }
    #nexmoe-header .nexmoe-widget-wrap .tagcloud a:nth-child(7n+3) {
    background-color: rgba(254,212,102,0.15);
    color: #fed466;
    }
    #nexmoe-header .nexmoe-widget-wrap .tagcloud a:nth-child(7n+4) {
    background-color: rgba(60,220,130,0.15);
    color: #3cdc82;
    }
    #nexmoe-header .nexmoe-widget-wrap .tagcloud a:nth-child(7n+5) {
    background-color: rgba(100,220,240,0.15);
    color: #64dcf0;
    }
    #nexmoe-header .nexmoe-widget-wrap .tagcloud a:nth-child(7n+6) {
    background-color: rgba(100,185,255,0.15);
    color: #64b9ff;
    }
    #nexmoe-header .nexmoe-widget-wrap .tagcloud a:nth-child(7n+7) {
    background-color: rgba(180,180,255,0.15);
    color: #b4b4ff;
    }
    #nexmoe-content .nexmoe-post .nexmoe-post-meta {
    margin: 25px 0px;
    font-size: 0;
    }
    #nexmoe-content .nexmoe-post .nexmoe-post-meta a {
    border-radius: 20px;
    padding: 10px 18px;
    color: #fff;
    font-size: 14px;
    display: inline-block;
    margin-bottom: 5px;
    margin-right: 10px;
    }
    #nexmoe-content .nexmoe-post .nexmoe-post-meta a .nexmoefont {
    font-size: 14px;
    }
    #nexmoe-content .nexmoe-post .nexmoe-post-meta a:before,
    #nexmoe-content .nexmoe-post .nexmoe-post-meta i:before {
    margin-right: 5px;
    }
    #nexmoe-content .nexmoe-post .nexmoe-post-meta a:nth-child(7n+1) {
    background-color: rgba(255,78,106,0.15);
    color: #ff4e6a;
    }
    #nexmoe-content .nexmoe-post .nexmoe-post-meta a:nth-child(7n+2) {
    background-color: rgba(255,170,115,0.15);
    color: #ffaa73;
    }
    #nexmoe-content .nexmoe-post .nexmoe-post-meta a:nth-child(7n+3) {
    background-color: rgba(254,212,102,0.15);
    color: #fed466;
    }
    #nexmoe-content .nexmoe-post .nexmoe-post-meta a:nth-child(7n+4) {
    background-color: rgba(60,220,130,0.15);
    color: #3cdc82;
    }
    #nexmoe-content .nexmoe-post .nexmoe-post-meta a:nth-child(7n+5) {
    background-color: rgba(100,220,240,0.15);
    color: #64dcf0;
    }
    #nexmoe-content .nexmoe-post .nexmoe-post-meta a:nth-child(7n+6) {
    background-color: rgba(100,185,255,0.15);
    color: #64b9ff;
    }
    #nexmoe-content .nexmoe-post .nexmoe-post-meta a:nth-child(7n+7) {
    background-color: rgba(180,180,255,0.15);
    color: #b4b4ff;
    }
  </style>


    
</aside>
    <div class="nexmoe-copyright">
        &copy; 2022 Shuyan
        Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
        & <a href="https://github.com/theme-nexmoe/hexo-theme-nexmoe" target="_blank">Nexmoe</a>
        <br><a target="_blank" href=" "><img src="http://mms0.baidu.com/it/u=991445098,3809803602&fm=253&app=138&f=JPEG&fmt=auto&q=75?w=500&h=500" width="100px" ></a><script data-ad-client="ca-pub-2058306854838448" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    </div>
</div><!-- .nexmoe-drawer -->
    </div>
    <div id="nexmoe-content">
        <div class="nexmoe-primary">
            <div class="nexmoe-post">

  <article>
      
          <div class="nexmoe-post-cover" style="padding-bottom: 62.5%;"> 
              <img data-src="/img/RedisTemplate.jpg" data-sizes="auto" alt="Claims" class="lazyload">
              <h1>Claims</h1>
          </div>
      
      
      <div class="nexmoe-post-meta nexmoe-rainbow" style="margin:10px 0!important;">
    <a><i class="nexmoefont icon-calendar-fill"></i>2022年05月24日</a>
</div>

      

      <h1 id="Java-Claims类代码示例"><a href="#Java-Claims类代码示例" class="headerlink" title="Java Claims类代码示例"></a>Java Claims类代码示例</h1><p>本文整理汇总了Java中<strong>io.jsonwebtoken.Claims</strong>类的典型用法代码示例。如果您正苦于以下问题：Java Claims类的具体用法？Java Claims怎么用？Java Claims使用的例子？那么恭喜您, 这里精选的类代码示例或许可以为您提供帮助。</p>
<p><strong>Claims类</strong>属于io.jsonwebtoken包，在下文中一共展示了<strong>Claims类</strong>的20个代码示例，这些例子默认根据受欢迎程度排序。您可以为喜欢或者感觉有用的代码点赞，您的评价将有助于我们的系统推荐出更棒的Java代码示例。</p>
<h2 id="示例1-createRefreshToken"><a href="#示例1-createRefreshToken" class="headerlink" title="示例1: createRefreshToken"></a>示例1: createRefreshToken</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> io.jsonwebtoken.Claims; <span class="hljs-comment">//导入依赖的package包/类</span><br><br><span class="hljs-function"><span class="hljs-keyword">public</span> JwtToken <span class="hljs-title">createRefreshToken</span><span class="hljs-params">(UserContext userContext)</span> </span>&#123;<br>  <br>  <span class="hljs-keyword">if</span> (StringUtils.isBlank(userContext.getTenantId())) <br>    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> IllegalArgumentException(<span class="hljs-string">&quot;Cannot create JWT Token without tenantId&quot;</span>);<br><br>  <span class="hljs-keyword">if</span> (StringUtils.isBlank(userContext.getOrgId())) <br>    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> IllegalArgumentException(<span class="hljs-string">&quot;Cannot create JWT Token without orgId&quot;</span>);<br><br>    DateTime currentTime = <span class="hljs-keyword">new</span> DateTime();<br><br>    Claims claims = Jwts.claims().setSubject(userContext.getOrgId());<br>    <br>    claims.put(<span class="hljs-string">&quot;scopes&quot;</span>, userContext.getAuthorities().stream().map(<br>        s -&gt; s.toString()).collect(Collectors.toList()<br>    ));<br>    <br>    claims.put(<span class="hljs-string">&quot;tenant&quot;</span>, userContext.getTenantId());<br>    <br>    String token = Jwts.builder()<br>      .setClaims(claims)<br>      .setIssuer(settings.getTokenIssuer())<br>      .setId(UUID.randomUUID().toString())<br>      .setIssuedAt(currentTime.toDate())<br>      .setExpiration(currentTime.plusMinutes(settings.getRefreshTokenExpTime()).toDate())<br>      .signWith(SignatureAlgorithm.HS512, settings.getTokenSigningKey())<br>    .compact();<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> AccessJwtToken(token, claims);<br>&#125;<br> <br></code></pre></td></tr></table></figure>
<h2 id="示例2-getConnUser"><a href="#示例2-getConnUser" class="headerlink" title="示例2: getConnUser"></a>示例2: getConnUser</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> io.jsonwebtoken.Claims; <span class="hljs-comment">//导入依赖的package包/类</span><br><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> RequestUserDTO <span class="hljs-title">getConnUser</span><span class="hljs-params">(HttpServletRequest request)</span> </span>&#123;<br>    <br>    String token = request.getHeader(HEADER_STRING);<br>    <br>    <span class="hljs-keyword">if</span> (token == <span class="hljs-keyword">null</span>) &#123;<br>        token = getTokenFromCookis(request);<br>    &#125;<br>    <br>    <span class="hljs-keyword">if</span> (token != <span class="hljs-keyword">null</span>) &#123;<br>        <span class="hljs-comment">// 解析 Token</span><br>        Claims claims = Jwts.parser().setSigningKey(SECRET)<br>                .parseClaimsJws(token).getBody();<br><br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> RequestUserDTO(<br>                claims.get(<span class="hljs-string">&quot;DomainId&quot;</span>, String.class),<br>                claims.get(<span class="hljs-string">&quot;UserId&quot;</span>, String.class),<br>                claims.get(<span class="hljs-string">&quot;OrgUnitId&quot;</span>, String.class));<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> RequestUserDTO();<br>&#125;<br> <br></code></pre></td></tr></table></figure>
<h2 id="示例3-authenticate"><a href="#示例3-authenticate" class="headerlink" title="示例3: authenticate"></a>示例3: authenticate</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> io.jsonwebtoken.Claims; <span class="hljs-comment">//导入依赖的package包/类</span><br><br><span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> Authentication <span class="hljs-title">authenticate</span><span class="hljs-params">(Authentication authentication)</span> <span class="hljs-keyword">throws</span> AuthenticationException </span>&#123;<br>    <br>    <span class="hljs-keyword">final</span> JwtToken token = (JwtToken) authentication.getCredentials();<br>    <span class="hljs-keyword">final</span> Claims claims = jwt.validate(token);<br><br>    <span class="hljs-keyword">final</span> String userId = claims.getSubject();<br>    <span class="hljs-keyword">final</span> String email  = claims.get(<span class="hljs-string">&quot;mail&quot;</span>, String.class);<br><br>    <span class="hljs-meta">@SuppressWarnings(&quot;unchecked&quot;)</span><br>    <span class="hljs-keyword">final</span> List&lt;String&gt; scopes = (List&lt;String&gt;) claims.get(<span class="hljs-string">&quot;scopes&quot;</span>, List.class);<br>    <span class="hljs-keyword">final</span> List&lt;GrantedAuthority&gt; auths = scopes.stream()<br>        .map(SimpleGrantedAuthority::<span class="hljs-keyword">new</span>)<br>        .collect(Collectors.toList());<br><br>    <span class="hljs-keyword">final</span> JwtUserDetails user = <span class="hljs-keyword">new</span> JwtUserDetails(userId, email, auths);<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> JwtAuthentication(token, user);<br>&#125;<br> <br></code></pre></td></tr></table></figure>


<h2 id="示例4-sign-token-with-KMS-and-verify"><a href="#示例4-sign-token-with-KMS-and-verify" class="headerlink" title="示例4: sign_token_with_KMS_and_verify"></a>示例4: sign_token_with_KMS_and_verify</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> io.jsonwebtoken.Claims; <span class="hljs-comment">//导入依赖的package包/类</span><br><br><span class="hljs-meta">@Test</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">sign_token_with_KMS_and_verify</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>    String[] params = &#123;<br>            <span class="hljs-string">&quot;--region&quot;</span>, TEST_AWS_REGION,<br>            <span class="hljs-string">&quot;--key&quot;</span>, TEST_AWS_KEY_ARN,<br>            <span class="hljs-string">&quot;--username&quot;</span>, <br>            <span class="hljs-string">&quot;userXYZ&quot;</span>,<br>            <span class="hljs-string">&quot;--journey&quot;</span>, <br>            <span class="hljs-string">&quot;SUM,UPR&quot;</span>,<br>    &#125;;<br>    GenerateTokenApp.main(params);<br>    String jwtToken = getTokenFromStdout();<br>    System.out.println(<span class="hljs-string">&quot;jwt: &quot;</span>+jwtToken);<br><br>    KMSDecrypt kmsDecrypt = <span class="hljs-keyword">new</span> KMSDecrypt(KMS_CLIENT, Collections.singleton(TEST_AWS_KEY_ARN));<br>    Claims claims = <span class="hljs-keyword">new</span> JWTDecoder(kmsDecrypt).decodeAndVerify(jwtToken);<br>    assertThat(claims.get(<span class="hljs-string">&quot;usr&quot;</span>), is(<span class="hljs-string">&quot;userXYZ&quot;</span>));<br>&#125;<br> <br></code></pre></td></tr></table></figure>
<h2 id="示例5-getEnterpriseToken"><a href="#示例5-getEnterpriseToken" class="headerlink" title="示例5: getEnterpriseToken"></a>示例5: getEnterpriseToken</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> io.jsonwebtoken.Claims; <span class="hljs-comment">//导入依赖的package包/类</span><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Get the enterprise token witch can used to invoke admin api,such as managing departments and groups</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> enterpriseId Your enterprise id</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> expirationTimeSeconds Expiration time seconds in the future(can not be bigger than 60)</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@return</span> Detailed user access information</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@throws</span> YfyException</span><br><span class="hljs-comment"> */</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> YfyAuthFinish <span class="hljs-title">getEnterpriseToken</span><span class="hljs-params">(<span class="hljs-keyword">long</span> enterpriseId, <span class="hljs-keyword">int</span> expirationTimeSeconds)</span> <span class="hljs-keyword">throws</span> YfyException </span>&#123;<br>    Claims claims = <span class="hljs-keyword">new</span> DefaultClaims();<br>    claims.put(<span class="hljs-string">&quot;yifangyun_sub_type&quot;</span>, <span class="hljs-string">&quot;enterprise&quot;</span>);<br>    claims.setSubject(String.valueOf(enterpriseId));<br>    claims.setExpiration(getExpirationTimeSecondsInTheFuture(expirationTimeSeconds));<br>    claims.setIssuedAt(<span class="hljs-keyword">new</span> Date());<br>    claims.setId(getGeneratedJwtId(<span class="hljs-number">16</span>));<br>    <span class="hljs-keyword">final</span> String compactJws = Jwts.builder().setHeader(headers).setClaims(claims).signWith(SignatureAlgorithm.RS256, key).compact();<br><br>    <span class="hljs-keyword">return</span> YfyRequestUtil.doPostInAuth(<br>            requestConfig,<br>            YfyAppInfo.getHost().getAuth(),<br>            <span class="hljs-string">&quot;oauth/token&quot;</span>,<br>            <span class="hljs-keyword">new</span> HashMap&lt;String, String&gt;() &#123;&#123;<br>                put(<span class="hljs-string">&quot;grant_type&quot;</span>, <span class="hljs-string">&quot;jwt&quot;</span>);<br>                put(<span class="hljs-string">&quot;assertion&quot;</span>, compactJws);<br>            &#125;&#125;,<br>            YfyAuthFinish.class);<br>&#125;<br> <br></code></pre></td></tr></table></figure>
<h2 id="示例6-refreshAuthenticationToken"><a href="#示例6-refreshAuthenticationToken" class="headerlink" title="示例6: refreshAuthenticationToken"></a>示例6: refreshAuthenticationToken</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> io.jsonwebtoken.Claims; <span class="hljs-comment">//导入依赖的package包/类</span><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Clients should call this in order to refresh a JWT.</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> request the request from the client.</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@return</span> the JWT with an extended expiry time if the client was authenticated, a 400 Bad Request otherwise.</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@RequestMapping(value = &quot;/refresh&quot;, method = RequestMethod.GET)</span><br><span class="hljs-keyword">public</span> ResponseEntity&lt;?&gt; refreshAuthenticationToken(HttpServletRequest request) &#123;<br><br>    <span class="hljs-keyword">final</span> String authorizationHeader = request.getHeader(<span class="hljs-string">&quot;Authorization&quot;</span>);<br>    <span class="hljs-keyword">final</span> Claims claims = jwtUtils.validateTokenAndGetClaims(authorizationHeader);<br>    <span class="hljs-keyword">final</span> String username = jwtUtils.getUsernameFromTokenClaims(claims);<br>    <span class="hljs-keyword">final</span> JwtUser user = (JwtUser) userDetailsService.loadUserByUsername(username);<br><br>    <span class="hljs-keyword">if</span> (jwtUtils.canTokenBeRefreshed(claims, <span class="hljs-keyword">new</span> Date(user.getLastPasswordResetDate()))) &#123;<br>        <span class="hljs-keyword">final</span> String refreshedToken = jwtUtils.refreshToken(authorizationHeader);<br>        <span class="hljs-keyword">return</span> ResponseEntity.ok(<span class="hljs-keyword">new</span> JwtAuthenticationResponse(refreshedToken));<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">return</span> ResponseEntity.badRequest().body(<span class="hljs-keyword">null</span>);<br>    &#125;<br>&#125;<br> <br></code></pre></td></tr></table></figure>
<h2 id="示例7-getCaptcha"><a href="#示例7-getCaptcha" class="headerlink" title="示例7: getCaptcha"></a>示例7: getCaptcha</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> io.jsonwebtoken.Claims; <span class="hljs-comment">//导入依赖的package包/类</span><br><br><span class="hljs-meta">@GetMapping(&quot;/specials/captcha&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">getCaptcha</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>    Claims claims = (Claims) request.getAttribute(AppConstants.CLAIMS);<br><br>    <span class="hljs-comment">// 缓存验证码数值</span><br>    CaptchaGenerator instance = CaptchaGenerator.INSTANCE;<br>    BufferedImage bi = instance.genImage();<br>    specialService.saveCaptcha(claims, instance.getCaptcha());<br><br>    <span class="hljs-comment">// 输出验证码图片</span><br>    response.setHeader(<span class="hljs-string">&quot;Cache-Control&quot;</span>, <span class="hljs-string">&quot;no-store&quot;</span>);<br>    response.setHeader(<span class="hljs-string">&quot;Pragma&quot;</span>, <span class="hljs-string">&quot;no-cache&quot;</span>);<br>    response.setDateHeader(<span class="hljs-string">&quot;Expires&quot;</span>, <span class="hljs-number">0</span>);<br>    response.setContentType(<span class="hljs-string">&quot;image/JPEG&quot;</span>);<br>    ImageIO.write(bi, <span class="hljs-string">&quot;JPEG&quot;</span>, response.getOutputStream());<br>    response.getOutputStream().flush();<br>&#125;<br> <br></code></pre></td></tr></table></figure>


<h2 id="示例8-parseTokenFromBase64EncodedString"><a href="#示例8-parseTokenFromBase64EncodedString" class="headerlink" title="示例8: parseTokenFromBase64EncodedString"></a>示例8: parseTokenFromBase64EncodedString</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> io.jsonwebtoken.Claims; <span class="hljs-comment">//导入依赖的package包/类</span><br><br><span class="hljs-function"><span class="hljs-keyword">private</span> Jws&lt;Claims&gt; <span class="hljs-title">parseTokenFromBase64EncodedString</span><span class="hljs-params">(<span class="hljs-keyword">final</span> String base64EncodedToken)</span> <span class="hljs-keyword">throws</span> JwtException </span>&#123;<br>    <span class="hljs-keyword">try</span> &#123;<br>        <span class="hljs-keyword">return</span> Jwts.parser().setSigningKeyResolver(<span class="hljs-keyword">new</span> SigningKeyResolverAdapter() &#123;<br>            <span class="hljs-meta">@Override</span><br>            <span class="hljs-keyword">public</span> <span class="hljs-keyword">byte</span>[] resolveSigningKeyBytes(JwsHeader header, Claims claims) &#123;<br>                <span class="hljs-keyword">final</span> String identity = claims.getSubject();<br><br>                <span class="hljs-comment">// Get the key based on the key id in the claims</span><br>                <span class="hljs-keyword">final</span> String keyId = claims.get(KEY_ID_CLAIM, String.class);<br>                <span class="hljs-keyword">final</span> Key key = keyService.getKey(keyId);<br><br>                <span class="hljs-comment">// Ensure we were able to find a key that was previously issued by this key service for this user</span><br>                <span class="hljs-keyword">if</span> (key == <span class="hljs-keyword">null</span> || key.getKey() == <span class="hljs-keyword">null</span>) &#123;<br>                    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> UnsupportedJwtException(<span class="hljs-string">&quot;Unable to determine signing key for &quot;</span> <br>                        + identity + <span class="hljs-string">&quot; [kid: &quot;</span> + keyId + <span class="hljs-string">&quot;]&quot;</span>);<br>                &#125;<br><br>                <span class="hljs-keyword">return</span> key.getKey().getBytes(StandardCharsets.UTF_8);<br>            &#125;<br>        &#125;).parseClaimsJws(base64EncodedToken);<br>    &#125; <span class="hljs-keyword">catch</span> (<span class="hljs-keyword">final</span> MalformedJwtException | <br>        UnsupportedJwtException | SignatureException | ExpiredJwtException | IllegalArgumentException e) &#123;<br>        <br>        <span class="hljs-comment">// <span class="hljs-doctag">TODO:</span> Exercise all exceptions to ensure none leak key material to logs</span><br>        <span class="hljs-keyword">final</span> String errorMessage = <span class="hljs-string">&quot;Unable to validate the access token.&quot;</span>;<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> JwtException(errorMessage, e);<br>    &#125;<br>&#125;<br> <br></code></pre></td></tr></table></figure>
<h2 id="示例9-doFilter"><a href="#示例9-doFilter" class="headerlink" title="示例9: doFilter"></a>示例9: doFilter</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> io.jsonwebtoken.Claims; <span class="hljs-comment">//导入依赖的package包/类</span><br><br><span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doFilter</span><span class="hljs-params">(<span class="hljs-keyword">final</span> ServletRequest req,</span></span><br><span class="hljs-params"><span class="hljs-function">                     <span class="hljs-keyword">final</span> ServletResponse res,</span></span><br><span class="hljs-params"><span class="hljs-function">                     <span class="hljs-keyword">final</span> FilterChain chain)</span> <span class="hljs-keyword">throws</span> IOException, ServletException </span>&#123;<br>    <span class="hljs-keyword">final</span> HttpServletRequest request = (HttpServletRequest) req;<br><br>    <span class="hljs-keyword">final</span> String authHeader = request.getHeader(<span class="hljs-string">&quot;Authorization&quot;</span>);<br>    <span class="hljs-keyword">if</span> (authHeader == <span class="hljs-keyword">null</span> || !authHeader.startsWith(<span class="hljs-string">&quot;Bearer &quot;</span>)) &#123;<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> ServletException(<span class="hljs-string">&quot;Missing or invalid Authorization header.&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">final</span> String token = authHeader.substring(<span class="hljs-number">7</span>); <span class="hljs-comment">// The part after &quot;Bearer &quot;</span><br><br>    <span class="hljs-keyword">try</span> &#123;<br>        <span class="hljs-keyword">final</span> Claims claims = Jwts.parser().setSigningKey(<span class="hljs-string">&quot;secretkey&quot;</span>)<br>            .parseClaimsJws(token).getBody();<br>        request.setAttribute(<span class="hljs-string">&quot;claims&quot;</span>, claims);<br>    &#125;<br>    <span class="hljs-keyword">catch</span> (<span class="hljs-keyword">final</span> SignatureException e) &#123;<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> ServletException(<span class="hljs-string">&quot;Invalid token.&quot;</span>);<br>    &#125;<br><br>    chain.doFilter(req, res);<br>&#125;<br> <br></code></pre></td></tr></table></figure>


<h2 id="示例10-createJwtToken"><a href="#示例10-createJwtToken" class="headerlink" title="示例10: createJwtToken"></a>示例10: createJwtToken</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> io.jsonwebtoken.Claims; <span class="hljs-comment">//导入依赖的package包/类</span><br><br><span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">createJwtToken</span><span class="hljs-params">(Authentication authentication, <span class="hljs-keyword">int</span> minutes)</span> </span>&#123;<br>  Claims claims = Jwts.claims()<br>      .setId(String.valueOf(IdentityGenerator.generate()))<br>      .setSubject(authentication.getName())<br>      .setExpiration(<span class="hljs-keyword">new</span> Date(currentTimeMillis() + minutes * <span class="hljs-number">60</span> * <span class="hljs-number">1000</span>))<br>      .setIssuedAt(<span class="hljs-keyword">new</span> Date());<br><br>  String authorities = authentication.getAuthorities()<br>      .stream()<br>      .map(GrantedAuthority::getAuthority)<br>      .map(String::toUpperCase)<br>      .collect(Collectors.joining(<span class="hljs-string">&quot;,&quot;</span>));<br><br>  claims.put(AUTHORITIES, authorities);<br><br>  <span class="hljs-keyword">return</span> Jwts.builder()<br>      .setClaims(claims)<br>      .signWith(HS512, secretkey)<br>      .compact();<br>&#125;<br> <br></code></pre></td></tr></table></figure>

<h2 id="示例11-authenticate"><a href="#示例11-authenticate" class="headerlink" title="示例11: authenticate"></a>示例11: authenticate</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> io.jsonwebtoken.Claims; <span class="hljs-comment">//导入依赖的package包/类</span><br><br><span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> Authentication <span class="hljs-title">authenticate</span><span class="hljs-params">(Authentication authentication)</span> <span class="hljs-keyword">throws</span> AuthenticationException </span>&#123;<br>    RawAccessJwtToken rawAccessToken = (RawAccessJwtToken) authentication.getCredentials();<br><br>    Jws&lt;Claims&gt; jwsClaims = rawAccessToken.parseClaims(jwtSettings.getTokenSigningKey());<br>    String orgId = jwsClaims.getBody().getSubject();<br>    String tenantId = jwsClaims.getBody().get(<span class="hljs-string">&quot;tenant&quot;</span>, String.class);<br>    List&lt;String&gt; scopes = jwsClaims.getBody().get(<span class="hljs-string">&quot;scopes&quot;</span>, List.class);<br>    List&lt;GrantedAuthority&gt; authorities = scopes.stream()<br>            .map(authority -&gt; <span class="hljs-keyword">new</span> SimpleGrantedAuthority(authority))<br>            .collect(Collectors.toList());<br>    <br>    UserContext context = UserContext.create(tenantId, orgId, authorities);<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> JwtAuthenticationToken(context, context.getAuthorities());<br>&#125;<br> <br></code></pre></td></tr></table></figure>



<h2 id="示例12-executeSignOut"><a href="#示例12-executeSignOut" class="headerlink" title="示例12: executeSignOut"></a>示例12: executeSignOut</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> io.jsonwebtoken.Claims; <span class="hljs-comment">//导入依赖的package包/类</span><br><br><span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> JsonResult <span class="hljs-title">executeSignOut</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response)</span> </span>&#123;<br>    JsonResult result = <span class="hljs-keyword">new</span> JsonResult();<br><br>    Cookie tokenCookie = CookieUtil.getCookieByName(request, AppConstants.ACCESS_TOKEN);<br>    <span class="hljs-keyword">if</span> (tokenCookie != <span class="hljs-keyword">null</span>) &#123;<br>        Claims requestClaims = JwtTokenUtil.getClaims(tokenCookie.getValue(), appProperties.getJwtSecretKey());<br>        <span class="hljs-comment">// 清除缓存</span><br>        String cacheKey = AppConstants.CACHE_ACCESS_TOKEN + requestClaims.getAudience();<br>        byteRedisClient.del(cacheKey);<br>    &#125;<br><br>    <span class="hljs-comment">// 清除Cookie</span><br>    CookieUtil.removeCookie(AppConstants.ACCESS_TOKEN, <span class="hljs-string">&quot;lovexq.net&quot;</span>, response);<br>    CookieUtil.removeCookie(AppConstants.USER_NAME, <span class="hljs-string">&quot;lovexq.net&quot;</span>, response);<br><br>    <span class="hljs-keyword">return</span> result;<br>&#125;<br> <br></code></pre></td></tr></table></figure>

<h2 id="示例13-getAudienceFromToken"><a href="#示例13-getAudienceFromToken" class="headerlink" title="示例13: getAudienceFromToken"></a>示例13: getAudienceFromToken</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> io.jsonwebtoken.Claims; <span class="hljs-comment">//导入依赖的package包/类</span><br><br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getAudienceFromToken</span><span class="hljs-params">(String token)</span> </span>&#123;<br>    String audience;<br>    <span class="hljs-keyword">try</span> &#123;<br>        <span class="hljs-keyword">final</span> Claims claims = getClaimsFromToken(token);<br>        audience = (String) claims.get(CLAIM_KEY_AUDIENCE);<br>    &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>        audience = <span class="hljs-keyword">null</span>;<br>    &#125;<br>    <span class="hljs-keyword">return</span> audience;<br>&#125;<br> <br></code></pre></td></tr></table></figure>

<h2 id="示例14-getAudienceFromToken"><a href="#示例14-getAudienceFromToken" class="headerlink" title="示例14: getAudienceFromToken"></a>示例14: getAudienceFromToken</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> io.jsonwebtoken.Claims; <span class="hljs-comment">//导入依赖的package包/类</span><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> token</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@return</span></span><br><span class="hljs-comment"> */</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getAudienceFromToken</span> <span class="hljs-params">( String token )</span> </span>&#123;<br>    String audience;<br>    <span class="hljs-keyword">try</span> &#123;<br>        <span class="hljs-keyword">final</span> Claims claims = getClaimsFromToken( token );<br>        audience = ( String ) claims.get( CLAIM_KEY_AUDIENCE );<br>    &#125; <span class="hljs-keyword">catch</span> ( Exception e ) &#123;<br>        audience = <span class="hljs-keyword">null</span>;<br>    &#125;<br>    <span class="hljs-keyword">return</span> audience;<br>&#125;<br> <br></code></pre></td></tr></table></figure>
<h2 id="示例15-getClaimsFromToken"><a href="#示例15-getClaimsFromToken" class="headerlink" title="示例15: getClaimsFromToken"></a>示例15: getClaimsFromToken</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> io.jsonwebtoken.Claims; <span class="hljs-comment">//导入依赖的package包/类</span><br><br><span class="hljs-function"><span class="hljs-keyword">private</span> Claims <span class="hljs-title">getClaimsFromToken</span><span class="hljs-params">(String token)</span> </span>&#123;<br>    Claims claims;<br>    <span class="hljs-keyword">try</span> &#123;<br>        claims = Jwts.parser()<br>                .setSigningKey(secret)<br>                .parseClaimsJws(token)<br>                .getBody();<br>    &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>        claims = <span class="hljs-keyword">null</span>;<br>    &#125;<br>    <span class="hljs-keyword">return</span> claims;<br>&#125;<br> <br></code></pre></td></tr></table></figure>

<h2 id="示例16-getClaimsFromToken"><a href="#示例16-getClaimsFromToken" class="headerlink" title="示例16: getClaimsFromToken"></a>示例16: getClaimsFromToken</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> io.jsonwebtoken.Claims; <span class="hljs-comment">//导入依赖的package包/类</span><br><br><span class="hljs-function"><span class="hljs-keyword">private</span> Claims <span class="hljs-title">getClaimsFromToken</span><span class="hljs-params">(String token)</span> </span>&#123;<br>    <span class="hljs-keyword">return</span> Jwts.parser()<br>            .requireIssuer(ISSUER)<br>            .requireAudience(AUDIENCE)<br>            .setSigningKey(secret)<br>            .parseClaimsJws(token)<br>            .getBody();<br>&#125;<br> <br></code></pre></td></tr></table></figure>


<h2 id="示例17-refreshToken"><a href="#示例17-refreshToken" class="headerlink" title="示例17: refreshToken"></a>示例17: refreshToken</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> io.jsonwebtoken.Claims; <span class="hljs-comment">//导入依赖的package包/类</span><br><br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">refreshToken</span><span class="hljs-params">(String token)</span> </span>&#123;<br>    <span class="hljs-keyword">final</span> Date createdDate = timeProvider.now();<br>    <span class="hljs-keyword">final</span> Date expirationDate = calculateExpirationDate(createdDate);<br><br>    <span class="hljs-keyword">final</span> Claims claims = getAllClaimsFromToken(token);<br>    claims.setIssuedAt(createdDate);<br>    claims.setExpiration(expirationDate);<br><br>    <span class="hljs-keyword">return</span> Jwts.builder()<br>            .setClaims(claims)<br>            .signWith(SignatureAlgorithm.HS512, secret)<br>            .compact();<br>&#125;<br> <br></code></pre></td></tr></table></figure>

<h2 id="示例18-getExpirationDateFromToken"><a href="#示例18-getExpirationDateFromToken" class="headerlink" title="示例18: getExpirationDateFromToken"></a>示例18: getExpirationDateFromToken</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> io.jsonwebtoken.Claims; <span class="hljs-comment">//导入依赖的package包/类</span><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Retorna a data de expiração de um token JWT.</span><br><span class="hljs-comment"> * </span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> token</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@return</span> Date</span><br><span class="hljs-comment"> */</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> Date <span class="hljs-title">getExpirationDateFromToken</span><span class="hljs-params">(String token)</span> </span>&#123;<br>    Date expiration;<br>    <span class="hljs-keyword">try</span> &#123;<br>        Claims claims = getClaimsFromToken(token);<br>        expiration = claims.getExpiration();<br>    &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>        expiration = <span class="hljs-keyword">null</span>;<br>    &#125;<br>    <span class="hljs-keyword">return</span> expiration;<br>&#125;<br> <br></code></pre></td></tr></table></figure>


<h2 id="示例19-getUsernameFromToken"><a href="#示例19-getUsernameFromToken" class="headerlink" title="示例19: getUsernameFromToken"></a>示例19: getUsernameFromToken</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> io.jsonwebtoken.Claims; <span class="hljs-comment">//导入依赖的package包/类</span><br><br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getUsernameFromToken</span><span class="hljs-params">(String token)</span> </span>&#123;<br>    String username;<br>    <span class="hljs-keyword">try</span> &#123;<br>        <span class="hljs-keyword">final</span> Claims claims = getClaimsFromToken(token);<br>        username = claims.getSubject();<br>    &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>        username = <span class="hljs-keyword">null</span>;<br>    &#125;<br>    <span class="hljs-keyword">return</span> username;<br>&#125;<br> <br></code></pre></td></tr></table></figure>


<h2 id="示例20-getExpirationDateFromToken"><a href="#示例20-getExpirationDateFromToken" class="headerlink" title="示例20: getExpirationDateFromToken"></a>示例20: getExpirationDateFromToken</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> io.jsonwebtoken.Claims; <span class="hljs-comment">//导入依赖的package包/类</span><br><br><span class="hljs-function"><span class="hljs-keyword">public</span> Date <span class="hljs-title">getExpirationDateFromToken</span><span class="hljs-params">(String token)</span> </span>&#123;<br>    Date expiration;<br>    <span class="hljs-keyword">try</span> &#123;<br>        <span class="hljs-keyword">final</span> Claims claims = getClaimsFromToken(token);<br>        expiration = claims.getExpiration();<br>    &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>        expiration = <span class="hljs-keyword">null</span>;<br>    &#125;<br>    <span class="hljs-keyword">return</span> expiration;<br>&#125;<br> <br></code></pre></td></tr></table></figure>

<h1 id="Claims-getSubject"><a href="#Claims-getSubject" class="headerlink" title="Claims.getSubject"></a>Claims.getSubject</h1><p>本文整理汇总了Java中<strong>io.jsonwebtoken.Claims.getSubject</strong>方法的典型用法代码示例。如果您正苦于以下问题：Java Claims.getSubject方法的具体用法？Java Claims.getSubject怎么用？Java Claims.getSubject使用的例子？那么恭喜您, 这里精选的方法代码示例或许可以为您提供帮助。您也可以进一步了解该方法所在<strong>类</strong>[<code>io.jsonwebtoken.Claims</code>]的用法示例。</p>
<p>在下文中一共展示了<strong>Claims.getSubject方法</strong>的14个代码示例，这些例子默认根据受欢迎程度排序。您可以为喜欢或者感觉有用的代码点赞，您的评价将有助于我们的系统推荐出更棒的Java代码示例。</p>
<h2 id="示例1-getAuthentication"><a href="#示例1-getAuthentication" class="headerlink" title="示例1: getAuthentication"></a>示例1: getAuthentication</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> io.jsonwebtoken.Claims; <span class="hljs-comment">//导入方法依赖的package包/类</span><br><br><span class="hljs-function"><span class="hljs-keyword">public</span> Authentication <span class="hljs-title">getAuthentication</span><span class="hljs-params">(String token)</span> </span>&#123;<br>    Claims claims = Jwts.parser()<br>        .setSigningKey(secretKey)<br>        .parseClaimsJws(token)<br>        .getBody();<br><br>    Collection&lt;? extends GrantedAuthority&gt; authorities = Arrays.stream(claims.get(AUTHORITIES_KEY)<br>        .toString()<br>        .split(<span class="hljs-string">&quot;,&quot;</span>))<br>        .map(SimpleGrantedAuthority::<span class="hljs-keyword">new</span>)<br>        .collect(Collectors.toList());<br><br>    User principal = <span class="hljs-keyword">new</span> User(claims.getSubject(), <span class="hljs-string">&quot;&quot;</span>, authorities);<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> UsernamePasswordAuthenticationToken(principal, token, authorities);<br>&#125;<br> <br></code></pre></td></tr></table></figure>


<h2 id="示例2-parseRefreshToken"><a href="#示例2-parseRefreshToken" class="headerlink" title="示例2: parseRefreshToken"></a>示例2: parseRefreshToken</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> io.jsonwebtoken.Claims; <span class="hljs-comment">//导入方法依赖的package包/类</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> SecurityUser <span class="hljs-title">parseRefreshToken</span><span class="hljs-params">(RawAccessJwtToken rawAccessToken)</span> </span>&#123;<br>  Jws&lt;Claims&gt; jwsClaims = rawAccessToken.parseClaims(settings.getTokenSigningKey());<br>  Claims claims = jwsClaims.getBody();<br>  String subject = claims.getSubject();<br>  List&lt;String&gt; scopes = claims.get(SCOPES, List.class);<br>  <span class="hljs-keyword">if</span> (scopes == <span class="hljs-keyword">null</span> || scopes.isEmpty()) &#123;<br>    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> IllegalArgumentException(<span class="hljs-string">&quot;Refresh Token doesn&#x27;t have any scopes&quot;</span>);<br>  &#125;<br>  <span class="hljs-keyword">if</span> (!scopes.get(<span class="hljs-number">0</span>).equals(Authority.REFRESH_TOKEN.name())) &#123;<br>    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> IllegalArgumentException(<span class="hljs-string">&quot;Invalid Refresh Token scope&quot;</span>);<br>  &#125;<br>  <span class="hljs-keyword">boolean</span> isPublic = claims.get(IS_PUBLIC, Boolean.class);<br>  UserPrincipal principal = <span class="hljs-keyword">new</span> UserPrincipal(isPublic ? UserPrincipal.Type.PUBLIC_ID : UserPrincipal.Type.USER_NAME,<br>      subject);<br>  SecurityUser securityUser = <span class="hljs-keyword">new</span> SecurityUser(<span class="hljs-keyword">new</span> UserId(UUID.fromString(claims.get(USER_ID, String.class))));<br>  securityUser.setUserPrincipal(principal);<br>  <span class="hljs-keyword">return</span> securityUser;<br>&#125;<br> <br></code></pre></td></tr></table></figure>

<h2 id="示例3-getAuthentication"><a href="#示例3-getAuthentication" class="headerlink" title="示例3: getAuthentication"></a>示例3: getAuthentication</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> io.jsonwebtoken.Claims; <span class="hljs-comment">//导入方法依赖的package包/类</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> Authentication <span class="hljs-title">getAuthentication</span><span class="hljs-params">(String token)</span> </span>&#123;<br>    Claims claims = Jwts.parser()<br>        .setSigningKey(secretKey)<br>        .parseClaimsJws(token)<br>        .getBody();<br><br>    Collection&lt;? extends GrantedAuthority&gt; authorities =<br>        Arrays.asList(claims.get(AUTHORITIES_KEY).toString().split(<span class="hljs-string">&quot;,&quot;</span>)).stream()<br>            .map(SimpleGrantedAuthority::<span class="hljs-keyword">new</span>)<br>            .collect(Collectors.toList());<br><br>    User principal = <span class="hljs-keyword">new</span> User(claims.getSubject(), <span class="hljs-string">&quot;&quot;</span>,<br>        authorities);<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> UsernamePasswordAuthenticationToken(principal, <span class="hljs-string">&quot;&quot;</span>, authorities);<br>&#125;<br> <br></code></pre></td></tr></table></figure>

<h2 id="示例4-getUserFromToken"><a href="#示例4-getUserFromToken" class="headerlink" title="示例4: getUserFromToken"></a>示例4: getUserFromToken</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> io.jsonwebtoken.Claims; <span class="hljs-comment">//导入方法依赖的package包/类</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> JWTUserDetails <span class="hljs-title">getUserFromToken</span><span class="hljs-params">(String token)</span></span>&#123;<br>    JWTUserDetails user;<br>    <span class="hljs-keyword">try</span> &#123;<br>        <span class="hljs-keyword">final</span> Claims claims=getClaimsFromToken(token);<br>       String userId = getUserIdFromToken(token);<br>        String username=claims.getSubject();<br>        List&lt;GrantedAuthority&gt; authorities =AuthorityUtils.commaSeparatedStringToAuthorityList((String) claims.get(CLAIM_KEY_AUTHORITIES));<br>       <span class="hljs-comment">/* boolean account_enabled = (Boolean) claims.get(CLAIM_KEY_ACCOUNT_ENABLED);</span><br><span class="hljs-comment">        boolean account_non_locked = (Boolean) claims.get(CLAIM_KEY_ACCOUNT_NON_LOCKED);</span><br><span class="hljs-comment">        boolean account_non_expired = (Boolean) claims.get(CLAIM_KEY_ACCOUNT_NON_EXPIRED);*/</span><br><br>        user = <span class="hljs-keyword">new</span> JWTUserDetails(userId, username, <span class="hljs-string">&quot;password&quot;</span>,  authorities);<br>    &#125;<span class="hljs-keyword">catch</span> (Exception e)&#123;<br>        logger.error(<span class="hljs-string">&quot;getUserFromToken error&quot;</span>);<br>        user=<span class="hljs-keyword">null</span>;<br>    &#125;<br>    <span class="hljs-keyword">return</span> user;<br>&#125;<br> <br></code></pre></td></tr></table></figure>


<h2 id="示例5-parseAccessJwtToken"><a href="#示例5-parseAccessJwtToken" class="headerlink" title="示例5: parseAccessJwtToken"></a>示例5: parseAccessJwtToken</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> io.jsonwebtoken.Claims; <span class="hljs-comment">//导入方法依赖的package包/类</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> SecurityUser <span class="hljs-title">parseAccessJwtToken</span><span class="hljs-params">(RawAccessJwtToken rawAccessToken)</span> </span>&#123;<br>  Jws&lt;Claims&gt; jwsClaims = rawAccessToken.parseClaims(settings.getTokenSigningKey());<br>  Claims claims = jwsClaims.getBody();<br>  String subject = claims.getSubject();<br>  List&lt;String&gt; scopes = claims.get(SCOPES, List.class);<br>  <span class="hljs-keyword">if</span> (scopes == <span class="hljs-keyword">null</span> || scopes.isEmpty()) &#123;<br>    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> IllegalArgumentException(<span class="hljs-string">&quot;JWT Token doesn&#x27;t have any scopes&quot;</span>);<br>  &#125;<br><br>  SecurityUser securityUser = <span class="hljs-keyword">new</span> SecurityUser(<span class="hljs-keyword">new</span> UserId(UUID.fromString(claims.get(USER_ID, String.class))));<br>  securityUser.setEmail(subject);<br>  securityUser.setAuthority(Authority.parse(scopes.get(<span class="hljs-number">0</span>)));<br>  securityUser.setFirstName(claims.get(FIRST_NAME, String.class));<br>  securityUser.setLastName(claims.get(LAST_NAME, String.class));<br>  securityUser.setEnabled(claims.get(ENABLED, Boolean.class));<br>  <span class="hljs-keyword">boolean</span> isPublic = claims.get(IS_PUBLIC, Boolean.class);<br>  UserPrincipal principal = <span class="hljs-keyword">new</span> UserPrincipal(isPublic ? UserPrincipal.Type.PUBLIC_ID : UserPrincipal.Type.USER_NAME,<br>      subject);<br>  securityUser.setUserPrincipal(principal);<br>  String tenantId = claims.get(TENANT_ID, String.class);<br>  <span class="hljs-keyword">if</span> (tenantId != <span class="hljs-keyword">null</span>) &#123;<br>    securityUser.setTenantId(<span class="hljs-keyword">new</span> TenantId(UUID.fromString(tenantId)));<br>  &#125;<br>  String customerId = claims.get(CUSTOMER_ID, String.class);<br>  <span class="hljs-keyword">if</span> (customerId != <span class="hljs-keyword">null</span>) &#123;<br>    securityUser.setCustomerId(<span class="hljs-keyword">new</span> CustomerId(UUID.fromString(customerId)));<br>  &#125;<br><br>  <span class="hljs-keyword">return</span> securityUser;<br>&#125;<br> <br></code></pre></td></tr></table></figure>

<h2 id="示例6-getUsernameFromToken"><a href="#示例6-getUsernameFromToken" class="headerlink" title="示例6: getUsernameFromToken"></a>示例6: getUsernameFromToken</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> io.jsonwebtoken.Claims; <span class="hljs-comment">//导入方法依赖的package包/类</span><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Obtém o username (email) contido no token JWT.</span><br><span class="hljs-comment"> * </span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> token</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@return</span> String</span><br><span class="hljs-comment"> */</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getUsernameFromToken</span><span class="hljs-params">(String token)</span> </span>&#123;<br>    String username;<br>    <span class="hljs-keyword">try</span> &#123;<br>        Claims claims = getClaimsFromToken(token);<br>        username = claims.getSubject();<br>    &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>        username = <span class="hljs-keyword">null</span>;<br>    &#125;<br>    <span class="hljs-keyword">return</span> username;<br>&#125;<br> <br></code></pre></td></tr></table></figure>


<h2 id="示例7-getUsernameFromToken"><a href="#示例7-getUsernameFromToken" class="headerlink" title="示例7: getUsernameFromToken"></a>示例7: getUsernameFromToken</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> io.jsonwebtoken.Claims; <span class="hljs-comment">//导入方法依赖的package包/类</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getUsernameFromToken</span><span class="hljs-params">(String token)</span> </span>&#123;<br>    String username;<br>    <span class="hljs-keyword">try</span> &#123;<br>        <span class="hljs-keyword">final</span> Claims claims = getClaimsFromToken(token);<br>        username = claims.getSubject();<br>    &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>        username = <span class="hljs-keyword">null</span>;<br>    &#125;<br>    <span class="hljs-keyword">return</span> username;<br>&#125;<br> <br></code></pre></td></tr></table></figure>


<h2 id="示例8-getUsernameFromToken"><a href="#示例8-getUsernameFromToken" class="headerlink" title="示例8: getUsernameFromToken"></a>示例8: getUsernameFromToken</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> io.jsonwebtoken.Claims; <span class="hljs-comment">//导入方法依赖的package包/类</span><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 根据token得到用户名</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> token</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@return</span></span><br><span class="hljs-comment"> */</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getUsernameFromToken</span> <span class="hljs-params">( String token )</span> </span>&#123;<br>    String username;<br>    <span class="hljs-keyword">try</span> &#123;<br>        <span class="hljs-keyword">final</span> Claims claims = getClaimsFromToken( token );<br>        username = claims.getSubject();<br>    &#125; <span class="hljs-keyword">catch</span> ( Exception e ) &#123;<br>        username = <span class="hljs-keyword">null</span>;<br>    &#125;<br>    <span class="hljs-keyword">return</span> username;<br>&#125;<br> <br></code></pre></td></tr></table></figure>

<h2 id="示例9-getAuthentication"><a href="#示例9-getAuthentication" class="headerlink" title="示例9: getAuthentication"></a>示例9: getAuthentication</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> io.jsonwebtoken.Claims; <span class="hljs-comment">//导入方法依赖的package包/类</span><br><span class="hljs-function"><span class="hljs-keyword">static</span> Authentication <span class="hljs-title">getAuthentication</span><span class="hljs-params">(HttpServletRequest request)</span> </span>&#123;<br>    <span class="hljs-comment">// 从Header中拿到token</span><br>    String token = request.getHeader(HEADER_STRING);<br><br>    <span class="hljs-keyword">if</span> (token != <span class="hljs-keyword">null</span>) &#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-comment">// 解析 Token</span><br>            Claims claims = Jwts.parser()<br>                    <span class="hljs-comment">// 验签</span><br>                    .setSigningKey(SECRET)<br>                    <span class="hljs-comment">// 去掉 Bearer</span><br>                    .parseClaimsJws(token.replace(TOKEN_PREFIX, <span class="hljs-string">&quot;&quot;</span>))<br>                    .getBody();<br><br>            <span class="hljs-comment">// 拿用户名</span><br>            String user = claims.getSubject();<br><br>            <span class="hljs-comment">// 得到 权限（角色）</span><br>            List&lt;GrantedAuthority&gt; authorities = AuthorityUtils.commaSeparatedStringToAuthorityList((String) claims.get(<span class="hljs-string">&quot;authorities&quot;</span>));<br><br>            <span class="hljs-comment">// 返回验证令牌</span><br>            <span class="hljs-keyword">return</span> user != <span class="hljs-keyword">null</span> ?<br>                    <span class="hljs-keyword">new</span> UsernamePasswordAuthenticationToken(user, <span class="hljs-keyword">null</span>, authorities) :<br>                    <span class="hljs-keyword">null</span>;<br>        &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;<br>&#125;<br> <br></code></pre></td></tr></table></figure>


<h2 id="示例10-getUsernameFromToken"><a href="#示例10-getUsernameFromToken" class="headerlink" title="示例10: getUsernameFromToken"></a>示例10: getUsernameFromToken</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> io.jsonwebtoken.Claims; <span class="hljs-comment">//导入方法依赖的package包/类</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getUsernameFromToken</span><span class="hljs-params">(String token)</span> </span>&#123;<br>    String username;<br>    <span class="hljs-keyword">try</span> &#123;<br>        <span class="hljs-keyword">final</span> Claims clamis=getClaimsFromToken(token);<br>        username=clamis.getSubject();<br>    &#125;<span class="hljs-keyword">catch</span> (Exception e)&#123;<br>        username=<span class="hljs-keyword">null</span>;<br>    &#125;<br>    <span class="hljs-keyword">return</span> username;<br>&#125;<br> <br></code></pre></td></tr></table></figure>


<h2 id="示例11-isAdmin"><a href="#示例11-isAdmin" class="headerlink" title="示例11: isAdmin"></a>示例11: isAdmin</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> io.jsonwebtoken.Claims; <span class="hljs-comment">//导入方法依赖的package包/类</span><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Checks if use is an admin</span><br><span class="hljs-comment"> * </span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> token the JWT given</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@return</span> true if admin exists, false otherwise</span><br><span class="hljs-comment"> */</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">isAdmin</span><span class="hljs-params">(String token)</span> </span>&#123;<br>    Claims claims = <span class="hljs-keyword">null</span>;<br>    UserDaoImpl ud = <span class="hljs-keyword">new</span> UserDaoImpl();<br>    User user = <span class="hljs-keyword">null</span>;<br>    String cUsername = <span class="hljs-keyword">null</span>;<br>    <span class="hljs-keyword">boolean</span> verified = <span class="hljs-keyword">false</span>;<br>    <br>    <span class="hljs-keyword">if</span>(token == <span class="hljs-keyword">null</span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;<br>    &#125;<br>    <br>    <span class="hljs-keyword">try</span> &#123;<br>        claims = Jwts.parser()<br>                .setSigningKey(getSecret())<br>                .parseClaimsJws(token).getBody();<br>        <br>        cUsername = claims.getSubject();<br>        user = ud.getUserByUsername(cUsername);<br>        <br>        <span class="hljs-keyword">if</span>(cUsername == <span class="hljs-keyword">null</span> || user == <span class="hljs-keyword">null</span> || user.getRoleFlag() != <span class="hljs-number">2</span>) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;<br>        &#125;<br>        <br>        verified = <span class="hljs-keyword">true</span>;<br>        <br>    &#125;<span class="hljs-keyword">catch</span>(SignatureException se) &#123;<br>        se.printStackTrace();<br>    &#125;<br>    <br>    <span class="hljs-keyword">return</span> verified;<br>&#125;<br> <br></code></pre></td></tr></table></figure>


<h2 id="示例12-getAuthentication"><a href="#示例12-getAuthentication" class="headerlink" title="示例12: getAuthentication"></a>示例12: getAuthentication</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> io.jsonwebtoken.Claims; <span class="hljs-comment">//导入方法依赖的package包/类</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> Authentication <span class="hljs-title">getAuthentication</span><span class="hljs-params">(String token)</span> </span>&#123;<br>        Claims claims = Jwts.parser()<br>            .setSigningKey(secretKey)<br>            .parseClaimsJws(token)<br>            .getBody();<br><br>        Collection&lt;? extends GrantedAuthority&gt; authorities =<br>            Arrays.stream(claims.get(AUTHORITIES_KEY).toString().split(<span class="hljs-string">&quot;,&quot;</span>))<br>                .map(SimpleGrantedAuthority::<span class="hljs-keyword">new</span>)<br>                .collect(Collectors.toList());<br><br>        User principal = <span class="hljs-keyword">new</span> User(claims.getSubject(), <span class="hljs-string">&quot;&quot;</span>, authorities);<br><br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> UsernamePasswordAuthenticationToken(principal, <span class="hljs-string">&quot;&quot;</span>, authorities);<br><br><span class="hljs-comment">//        Claims claims = Jwts.parser()</span><br><span class="hljs-comment">//                .setSigningKey(secretKey)</span><br><span class="hljs-comment">//                .parseClaimsJws(token)</span><br><span class="hljs-comment">//                .getBody();</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">//        String principal = claims.getSubject();</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">//        // CHANGES START HERE</span><br><span class="hljs-comment">//        String roles = claims.get(AUTHORITIES_KEY, Map.class).get(&quot;roles&quot;).toString();</span><br><span class="hljs-comment">//        if(roles != null &amp;&amp; roles.length() &gt; 0) &#123;</span><br><span class="hljs-comment">//            roles = roles.substring(1, roles.length() - 1);</span><br><span class="hljs-comment">//        &#125;</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">//        Collection&lt;? extends GrantedAuthority&gt; authorities =</span><br><span class="hljs-comment">//                Arrays.asList(roles.split(&quot;,&quot;)).stream()</span><br><span class="hljs-comment">//                        .map(authority -&gt; new SimpleGrantedAuthority(&quot;ROLE_&quot; + authority.toUpperCase()))</span><br><span class="hljs-comment">//                        .collect(Collectors.toList());</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">//        return new UsernamePasswordAuthenticationToken(principal, token, authorities);</span><br>    &#125;<br> <br></code></pre></td></tr></table></figure>

<h2 id="示例13-getUsernameFromToken"><a href="#示例13-getUsernameFromToken" class="headerlink" title="示例13: getUsernameFromToken"></a>示例13: getUsernameFromToken</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> io.jsonwebtoken.Claims; <span class="hljs-comment">//导入方法依赖的package包/类</span><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 从token中获取username信息</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> token token</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@return</span></span><br><span class="hljs-comment"> */</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getUsernameFromToken</span><span class="hljs-params">(String token)</span> </span>&#123;<br>    String username;<br>    <span class="hljs-keyword">try</span> &#123;<br>        <span class="hljs-keyword">final</span> Claims claims = <span class="hljs-keyword">this</span>.getClaimsFromToken(token);<br>        username = claims.getSubject();<br>    &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>        username = <span class="hljs-keyword">null</span>;<br>    &#125;<br>    <span class="hljs-keyword">return</span> username;<br>&#125;<br> <br></code></pre></td></tr></table></figure>


<h2 id="示例14-decodeCookie"><a href="#示例14-decodeCookie" class="headerlink" title="示例14: decodeCookie"></a>示例14: decodeCookie</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> io.jsonwebtoken.Claims; <span class="hljs-comment">//导入方法依赖的package包/类</span><br><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">protected</span> String[] decodeCookie(String cookieValue) <span class="hljs-keyword">throws</span> InvalidCookieException &#123;<br>  <span class="hljs-keyword">try</span> &#123;<br>    Claims claims = Jwts.parser()<br>        .setSigningKey(getKey())<br>        .parseClaimsJws(cookieValue)<br>        .getBody();<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> String[] &#123; claims.getId(), claims.getSubject() &#125;;<br>  &#125; <span class="hljs-keyword">catch</span> (JwtException e) &#123;<br>    LOGGER.warn(e.getMessage());<br>    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> InvalidCookieException(e.getMessage());<br>  &#125;<br>&#125;<br> <br></code></pre></td></tr></table></figure>

<h1 id="Claims-get方法"><a href="#Claims-get方法" class="headerlink" title="Claims.get方法"></a>Claims.get方法</h1><p>本文整理汇总了Java中<strong>io.jsonwebtoken.Claims.get</strong>方法的典型用法代码示例。如果您正苦于以下问题：Java Claims.get方法的具体用法？Java Claims.get怎么用？Java Claims.get使用的例子？那么恭喜您, 这里精选的方法代码示例或许可以为您提供帮助。您也可以进一步了解该方法所在<strong>类</strong>[<code>io.jsonwebtoken.Claims</code>]的用法示例。</p>
<p>在下文中一共展示了<strong>Claims.get方法</strong>的12个代码示例，这些例子默认根据受欢迎程度排序。您可以为喜欢或者感觉有用的代码点赞，您的评价将有助于我们的系统推荐出更棒的Java代码示例。</p>
<h2 id="示例1-getConnUser"><a href="#示例1-getConnUser" class="headerlink" title="示例1: getConnUser"></a>示例1: getConnUser</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> io.jsonwebtoken.Claims; <span class="hljs-comment">//导入方法依赖的package包/类</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> RequestUserDTO <span class="hljs-title">getConnUser</span><span class="hljs-params">(HttpServletRequest request)</span> </span>&#123;<br>    String token = request.getHeader(HEADER_STRING);<br>    <span class="hljs-keyword">if</span> (token == <span class="hljs-keyword">null</span>) &#123;<br>        token = getTokenFromCookis(request);<br>    &#125;<br>    <span class="hljs-keyword">if</span> (token != <span class="hljs-keyword">null</span>) &#123;<br>        <span class="hljs-comment">// 解析 Token</span><br>        Claims claims = Jwts.parser().setSigningKey(SECRET)<br>                .parseClaimsJws(token).getBody();<br><br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> RequestUserDTO(<br>                claims.get(<span class="hljs-string">&quot;DomainId&quot;</span>, String.class),<br>                claims.get(<span class="hljs-string">&quot;UserId&quot;</span>, String.class),<br>                claims.get(<span class="hljs-string">&quot;OrgUnitId&quot;</span>, String.class));<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> RequestUserDTO();<br>&#125;<br> <br></code></pre></td></tr></table></figure>


<h2 id="示例2-authenticate"><a href="#示例2-authenticate" class="headerlink" title="示例2: authenticate"></a>示例2: authenticate</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> io.jsonwebtoken.Claims; <span class="hljs-comment">//导入方法依赖的package包/类</span><br><span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> Authentication <span class="hljs-title">authenticate</span><span class="hljs-params">(Authentication authentication)</span></span><br><span class="hljs-function"><span class="hljs-keyword">throws</span> AuthenticationException </span>&#123;<br>    <span class="hljs-keyword">final</span> JwtToken token = (JwtToken) authentication.getCredentials();<br>    <span class="hljs-keyword">final</span> Claims claims = jwt.validate(token);<br><br>    <span class="hljs-keyword">final</span> String userId = claims.getSubject();<br>    <span class="hljs-keyword">final</span> String email  = claims.get(<span class="hljs-string">&quot;mail&quot;</span>, String.class);<br><br>    <span class="hljs-meta">@SuppressWarnings(&quot;unchecked&quot;)</span><br>    <span class="hljs-keyword">final</span> List&lt;String&gt; scopes = (List&lt;String&gt;) claims.get(<span class="hljs-string">&quot;scopes&quot;</span>, List.class);<br>    <span class="hljs-keyword">final</span> List&lt;GrantedAuthority&gt; auths = scopes.stream()<br>        .map(SimpleGrantedAuthority::<span class="hljs-keyword">new</span>)<br>        .collect(Collectors.toList());<br><br>    <span class="hljs-keyword">final</span> JwtUserDetails user = <span class="hljs-keyword">new</span> JwtUserDetails(userId, email, auths);<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> JwtAuthentication(token, user);<br>&#125;<br> <br></code></pre></td></tr></table></figure>


<h2 id="示例3-parseAndValidate"><a href="#示例3-parseAndValidate" class="headerlink" title="示例3: parseAndValidate"></a>示例3: parseAndValidate</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> io.jsonwebtoken.Claims; <span class="hljs-comment">//导入方法依赖的package包/类</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> AuthTokenDetails <span class="hljs-title">parseAndValidate</span><span class="hljs-params">(String token)</span> </span>&#123;<br>    AuthTokenDetails authTokenDetails = <span class="hljs-keyword">null</span>;<br>    <span class="hljs-keyword">try</span> &#123;<br>        Claims claims = Jwts.parser().setSigningKey(getSecretKey())<br>                .parseClaimsJws(token)<br>                .getBody();<br>        String userId = claims.getSubject();<br>        String username = (String) claims.get(<span class="hljs-string">&quot;username&quot;</span>);<br>        List&lt;String&gt; roleNames = (List) claims.get(<span class="hljs-string">&quot;roleNames&quot;</span>);<br>        Date expirationDate = claims.getExpiration();<br><br>        authTokenDetails = <span class="hljs-keyword">new</span> AuthTokenDetails();<br>        authTokenDetails.setId(Long.valueOf(userId));<br>        authTokenDetails.setUsername(username);<br>        authTokenDetails.setRoleNames(roleNames);<br>        authTokenDetails.setExpirationDate(expirationDate);<br>    &#125; <span class="hljs-keyword">catch</span> (JwtException ex) &#123;<br>        logger.error(ex.getMessage(), ex);<br>    &#125;<br>    <span class="hljs-keyword">return</span> authTokenDetails;<br>&#125;<br> <br></code></pre></td></tr></table></figure>



<h2 id="示例4-getPayload"><a href="#示例4-getPayload" class="headerlink" title="示例4: getPayload"></a>示例4: getPayload</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> io.jsonwebtoken.Claims; <span class="hljs-comment">//导入方法依赖的package包/类</span><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Parses the token header into a payload data map</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> tokenHeader Object holding the token</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@return</span> data map of the token parsed</span><br><span class="hljs-comment"> */</span><br><span class="hljs-function"><span class="hljs-keyword">private</span> Map&lt;String, String&gt; <span class="hljs-title">getPayload</span><span class="hljs-params">(String tokenHeader)</span> </span>&#123;<br>    String tokenWithoutBearer = tokenHeader.replace(TOKEN_PREFIX, <span class="hljs-string">&quot;&quot;</span>);<br>    String tokenWithoutSignatureAndBearer = removeSignature(tokenWithoutBearer);<br>    Claims body = Jwts.parser()<br>            .parseClaimsJwt(tokenWithoutSignatureAndBearer)<br>            .getBody();<br>    <span class="hljs-keyword">return</span> body.get(<span class="hljs-string">&quot;data&quot;</span>, Map.class);<br>&#125;<br> <br></code></pre></td></tr></table></figure>


<h2 id="示例5-getAudienceFromToken"><a href="#示例5-getAudienceFromToken" class="headerlink" title="示例5: getAudienceFromToken"></a>示例5: getAudienceFromToken</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> io.jsonwebtoken.Claims; <span class="hljs-comment">//导入方法依赖的package包/类</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getAudienceFromToken</span><span class="hljs-params">(String token)</span> </span>&#123;<br>    String audience;<br>    <span class="hljs-keyword">try</span> &#123;<br>        <span class="hljs-keyword">final</span> Claims claims = getClaimsFromToken(token);<br>        audience = (String) claims.get(CLAIM_KEY_AUDIENCE);<br>    &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>        audience = <span class="hljs-keyword">null</span>;<br>    &#125;<br>    <span class="hljs-keyword">return</span> audience;<br>&#125;<br> <br></code></pre></td></tr></table></figure>


<h2 id="示例6-login"><a href="#示例6-login" class="headerlink" title="示例6: login"></a>示例6: login</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> io.jsonwebtoken.Claims; <span class="hljs-comment">//导入方法依赖的package包/类</span><br><span class="hljs-meta">@RequestMapping(value = &quot;api/me&quot;, method = &#123;RequestMethod.GET&#125;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> User <span class="hljs-title">login</span><span class="hljs-params">(<span class="hljs-keyword">final</span> HttpServletRequest request)</span> <span class="hljs-keyword">throws</span> ServletException </span>&#123;<br>  <span class="hljs-keyword">final</span> Claims claims = (Claims) request.getAttribute(<span class="hljs-string">&quot;claims&quot;</span>);<br>  <span class="hljs-keyword">final</span> Integer userId = (Integer) claims.get(<span class="hljs-string">&quot;userId&quot;</span>);<br><br>  <span class="hljs-keyword">return</span> rbacService.getUserByUserId(userId.longValue());<br>&#125;<br> <br></code></pre></td></tr></table></figure>


<h2 id="示例7-parseAccessJwtToken"><a href="#示例7-parseAccessJwtToken" class="headerlink" title="示例7: parseAccessJwtToken"></a>示例7: parseAccessJwtToken</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> io.jsonwebtoken.Claims; <span class="hljs-comment">//导入方法依赖的package包/类</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> SecurityUser <span class="hljs-title">parseAccessJwtToken</span><span class="hljs-params">(RawAccessJwtToken rawAccessToken)</span> </span>&#123;<br>  Jws&lt;Claims&gt; jwsClaims = rawAccessToken.parseClaims(settings.getTokenSigningKey());<br>  Claims claims = jwsClaims.getBody();<br>  String subject = claims.getSubject();<br>  List&lt;String&gt; scopes = claims.get(SCOPES, List.class);<br>  <span class="hljs-keyword">if</span> (scopes == <span class="hljs-keyword">null</span> || scopes.isEmpty()) &#123;<br>    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> IllegalArgumentException(<span class="hljs-string">&quot;JWT Token doesn&#x27;t have any scopes&quot;</span>);<br>  &#125;<br><br>  SecurityUser securityUser = <span class="hljs-keyword">new</span> SecurityUser(<span class="hljs-keyword">new</span> UserId(UUID.fromString(claims.get(USER_ID, String.class))));<br>  securityUser.setEmail(subject);<br>  securityUser.setAuthority(Authority.parse(scopes.get(<span class="hljs-number">0</span>)));<br>  securityUser.setFirstName(claims.get(FIRST_NAME, String.class));<br>  securityUser.setLastName(claims.get(LAST_NAME, String.class));<br>  securityUser.setEnabled(claims.get(ENABLED, Boolean.class));<br>  <span class="hljs-keyword">boolean</span> isPublic = claims.get(IS_PUBLIC, Boolean.class);<br>  UserPrincipal principal = <span class="hljs-keyword">new</span> UserPrincipal(isPublic ? UserPrincipal.Type.PUBLIC_ID : UserPrincipal.Type.USER_NAME,<br>      subject);<br>  securityUser.setUserPrincipal(principal);<br>  String tenantId = claims.get(TENANT_ID, String.class);<br>  <span class="hljs-keyword">if</span> (tenantId != <span class="hljs-keyword">null</span>) &#123;<br>    securityUser.setTenantId(<span class="hljs-keyword">new</span> TenantId(UUID.fromString(tenantId)));<br>  &#125;<br>  String customerId = claims.get(CUSTOMER_ID, String.class);<br>  <span class="hljs-keyword">if</span> (customerId != <span class="hljs-keyword">null</span>) &#123;<br>    securityUser.setCustomerId(<span class="hljs-keyword">new</span> CustomerId(UUID.fromString(customerId)));<br>  &#125;<br><br>  <span class="hljs-keyword">return</span> securityUser;<br>&#125;<br> <br></code></pre></td></tr></table></figure>


<h2 id="示例8-getLastPasswordResetDateFromTokenClaims"><a href="#示例8-getLastPasswordResetDateFromTokenClaims" class="headerlink" title="示例8: getLastPasswordResetDateFromTokenClaims"></a>示例8: getLastPasswordResetDateFromTokenClaims</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> io.jsonwebtoken.Claims; <span class="hljs-comment">//导入方法依赖的package包/类</span><br><span class="hljs-function">Date <span class="hljs-title">getLastPasswordResetDateFromTokenClaims</span><span class="hljs-params">(Claims claims)</span> </span>&#123;<br>    Date lastPasswordResetDate;<br>    <span class="hljs-keyword">try</span> &#123;<br>        lastPasswordResetDate = <span class="hljs-keyword">new</span> Date((Long) claims.get(CLAIM_KEY_LAST_PASSWORD_CHANGE_DATE));<br>    &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>        LOG.error(<span class="hljs-string">&quot;Failed to extract lastPasswordResetDate claim from token!&quot;</span>, e);<br>        lastPasswordResetDate = <span class="hljs-keyword">null</span>;<br>    &#125;<br>    <span class="hljs-keyword">return</span> lastPasswordResetDate;<br>&#125;<br> <br></code></pre></td></tr></table></figure>


<h2 id="示例9-getAudienceFromToken"><a href="#示例9-getAudienceFromToken" class="headerlink" title="示例9: getAudienceFromToken"></a>示例9: getAudienceFromToken</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> io.jsonwebtoken.Claims; <span class="hljs-comment">//导入方法依赖的package包/类</span><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> token</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@return</span></span><br><span class="hljs-comment"> */</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getAudienceFromToken</span> <span class="hljs-params">( String token )</span> </span>&#123;<br>    String audience;<br>    <span class="hljs-keyword">try</span> &#123;<br>        <span class="hljs-keyword">final</span> Claims claims = getClaimsFromToken( token );<br>        audience = ( String ) claims.get( CLAIM_KEY_AUDIENCE );<br>    &#125; <span class="hljs-keyword">catch</span> ( Exception e ) &#123;<br>        audience = <span class="hljs-keyword">null</span>;<br>    &#125;<br>    <span class="hljs-keyword">return</span> audience;<br>&#125;<br> <br></code></pre></td></tr></table></figure>


<h2 id="示例10-getClaims"><a href="#示例10-getClaims" class="headerlink" title="示例10: getClaims"></a>示例10: getClaims</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> io.jsonwebtoken.Claims; <span class="hljs-comment">//导入方法依赖的package包/类</span><br><span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> Claims <span class="hljs-title">getClaims</span><span class="hljs-params">(String requestedPrincipal, String authToken)</span> <span class="hljs-keyword">throws</span> AuthenticationException, AuthorizationException </span>&#123;<br>    Claims claims;<br>    <span class="hljs-keyword">try</span> &#123;<br>        claims = jwtDecoder.decodeAndVerify(authToken);<br>        String principalIdFromToken = claims.get(<span class="hljs-string">&quot;usr&quot;</span>, String.class);<br>        <span class="hljs-keyword">if</span> (!Objects.equals(requestedPrincipal, principalIdFromToken)) &#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> AuthorizationException(<span class="hljs-string">&quot;User not authorized to perform action&quot;</span>);<br>        &#125;<br><br>        <span class="hljs-keyword">return</span> claims;<br>    &#125; <span class="hljs-keyword">catch</span> (JWTVerificationException e) &#123;<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> AuthenticationException(<span class="hljs-string">&quot;JWT Token not valid&quot;</span>);<br>    &#125;<br>&#125;<br> <br></code></pre></td></tr></table></figure>


<h2 id="示例11-getUserIdFromToken"><a href="#示例11-getUserIdFromToken" class="headerlink" title="示例11: getUserIdFromToken"></a>示例11: getUserIdFromToken</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> io.jsonwebtoken.Claims; <span class="hljs-comment">//导入方法依赖的package包/类</span><br><span class="hljs-function"><span class="hljs-keyword">private</span> String <span class="hljs-title">getUserIdFromToken</span><span class="hljs-params">(String token)</span> </span>&#123;<br>    String userId;<br>    <span class="hljs-keyword">try</span> &#123;<br>        <span class="hljs-keyword">final</span> Claims clamis=getClaimsFromToken(token);<br>        userId= (String) clamis.get(CLAIM_KEY_USER_ID);<br>    &#125;<span class="hljs-keyword">catch</span> (Exception e)&#123;<br>        userId=<span class="hljs-keyword">null</span>;<br>    &#125;<br>    <span class="hljs-keyword">return</span> userId;<br>&#125;<br> <br></code></pre></td></tr></table></figure>


<h2 id="示例12-doFilterInternal"><a href="#示例12-doFilterInternal" class="headerlink" title="示例12: doFilterInternal"></a>示例12: doFilterInternal</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> io.jsonwebtoken.Claims; <span class="hljs-comment">//导入方法依赖的package包/类</span><br><span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doFilterInternal</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response, FilterChain chain)</span> <span class="hljs-keyword">throws</span> ServletException, IOException </span>&#123;<br>    <br>    <span class="hljs-comment">//CORS</span><br>    response.addHeader(<span class="hljs-string">&quot;Access-Control-Allow-Origin&quot;</span>, <span class="hljs-string">&quot;*&quot;</span>);<br>    <span class="hljs-keyword">if</span> (request.getHeader(<span class="hljs-string">&quot;Access-Control-Request-Method&quot;</span>) != <span class="hljs-keyword">null</span> &amp;&amp; <span class="hljs-string">&quot;OPTIONS&quot;</span>.equalsIgnoreCase(request.getMethod())) &#123;<br>        response.addHeader(<span class="hljs-string">&quot;Access-Control-Allow-Headers&quot;</span>, <span class="hljs-string">&quot;Authorization&quot;</span>);<br>        response.addHeader(<span class="hljs-string">&quot;Access-Control-Allow-Headers&quot;</span>, <span class="hljs-string">&quot;Content-Type&quot;</span>);<br>        response.addHeader(<span class="hljs-string">&quot;Access-Control-Max-Age&quot;</span>, <span class="hljs-string">&quot;1&quot;</span>);<br>        response.addHeader(<span class="hljs-string">&quot;Access-Control-Allow-Methods&quot;</span>, <span class="hljs-string">&quot;GET, POST, PUT, DELETE&quot;</span>);<br>    &#125;<br>    <br>    <span class="hljs-keyword">final</span> String authHeader = request.getHeader(<span class="hljs-keyword">this</span>.authHeader);<br>    <br>    String username;<br>    String authToken;<br>    <br>    <span class="hljs-keyword">if</span> (authHeader != <span class="hljs-keyword">null</span> &amp;&amp; authHeader.startsWith(<span class="hljs-string">&quot;Bearer &quot;</span>)) &#123;<br>        authToken = authHeader.substring(<span class="hljs-number">7</span>);<br>        <span class="hljs-keyword">try</span> &#123;<br>            username = jwtTokenUtil.getUsernameFromToken(authToken);<br>        &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>            username = <span class="hljs-keyword">null</span>;<br>            authToken = <span class="hljs-keyword">null</span>;<br>        &#125;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        username = <span class="hljs-keyword">null</span>;<br>        authToken = <span class="hljs-keyword">null</span>;<br>    &#125;<br>    <br>    <span class="hljs-keyword">if</span> (username != <span class="hljs-keyword">null</span> &amp;&amp; authToken != <span class="hljs-keyword">null</span> &amp;&amp; SecurityContextHolder.getContext().getAuthentication() == <span class="hljs-keyword">null</span>) &#123;<br>        Claims claims = jwtTokenUtil.getAllClaimsFromToken(authToken);<br>        <span class="hljs-keyword">if</span> (jwtTokenUtil.validateToken(authToken)) &#123;<br>            List&lt;String&gt; rolesMap = claims.get(<span class="hljs-string">&quot;role&quot;</span>, List.class);<br>            List&lt;Role&gt; roles = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();<br>            <span class="hljs-keyword">for</span> (String rolemap : rolesMap) &#123;<br>                roles.add(Role.valueOf(rolemap));<br>            &#125;<br>            UserDetails userDetails = <span class="hljs-keyword">new</span> JWTUser(<br>                username, <span class="hljs-keyword">null</span>, JWTUserFactory.mapToGrantedAuthorities(roles), claims.get(<span class="hljs-string">&quot;enable&quot;</span>, Boolean.class)<br>            );<br>            UsernamePasswordAuthenticationToken authentication = <span class="hljs-keyword">new</span> UsernamePasswordAuthenticationToken(userDetails, <span class="hljs-keyword">null</span>, userDetails.getAuthorities());<br>            authentication.setDetails(<span class="hljs-keyword">new</span> WebAuthenticationDetailsSource().buildDetails(request));<br>            SecurityContextHolder.getContext().setAuthentication(authentication);<br>        &#125;<br>    &#125;<br>    <br>    <span class="hljs-keyword">if</span> (!request.getMethod().equalsIgnoreCase(<span class="hljs-string">&quot;OPTIONS&quot;</span>)) &#123;<br>        chain.doFilter(request, response);<br>    &#125;<br>&#125;<br> <br></code></pre></td></tr></table></figure>


































  </article>

  
      
    <div class="nexmoe-post-copyright">
        <strong>Author：</strong>Shuyan<br>
        <strong>Link：</strong><a href="http://example.com/2022/05/24/JAVA/Spring%E6%A1%86%E6%9E%B6/SpringSecurity/Claims/" title="http:&#x2F;&#x2F;example.com&#x2F;2022&#x2F;05&#x2F;24&#x2F;JAVA&#x2F;Spring%E6%A1%86%E6%9E%B6&#x2F;SpringSecurity&#x2F;Claims&#x2F;" target="_blank" rel="noopener">http:&#x2F;&#x2F;example.com&#x2F;2022&#x2F;05&#x2F;24&#x2F;JAVA&#x2F;Spring%E6%A1%86%E6%9E%B6&#x2F;SpringSecurity&#x2F;Claims&#x2F;</a><br>
        
            <strong>版权声明：</strong>本文采用 <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/cn/deed.zh" target="_blank">CC BY-NC-SA 3.0 CN</a> 协议进行许可
        
    </div>


  
  
  <div class="nexmoe-post-meta nexmoe-rainbow">
    
        <a class="nexmoefont icon-appstore-fill -link" href="/categories/JAVA/">JAVA</a><a class="nexmoefont icon-appstore-fill -link" href="/categories/JAVA/Spring%E6%A1%86%E6%9E%B6/">Spring框架</a><a class="nexmoefont icon-appstore-fill -link" href="/categories/JAVA/Spring%E6%A1%86%E6%9E%B6/%E2%80%9CSecurity%E2%80%9D/">“Security”</a>
    
    
        <a class="nexmoefont icon-tag-fill -none-link" href="/tags/Security/" rel="tag">Security</a>
    
</div>

  
      <div class="nexmoe-post-footer">
          <section class="nexmoe-comment">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@latest/dist/gitalk.min.css">
<div id="gitalk"></div>
<script src="https://cdn.jsdelivr.net/npm/gitalk@latest/dist/gitalk.min.js"></script>
<script type="text/javascript">
    var gitalk = new Gitalk({
        clientID: '80b2453b6d5f37ad6225',
        clientSecret: '43e99fa852795c9a7b3eb924b2558c64b84bbdeb',
        id: window.location.pathname,
        repo: 'nexmoe.github.io',
        owner: 'nexmoe',
        admin: 'nexmoe'
    })
    gitalk.render('gitalk')
</script>
</section>
      </div>
  
</div>
            <div class="nexmoe-post-right">
              <div class="nexmoe-fixed">
                  <div class="nexmoe-tool"> 
                    
                      
                        
                          
                          
                              <button class="mdui-fab catalog" style="overflow:unset;">
                                  <i class="nexmoefont icon-i-catalog"></i>
                                  <div class="nexmoe-toc">
                                      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Java-Claims%E7%B1%BB%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B"><span class="toc-number">1.</span> <span class="toc-text">Java Claims类代码示例</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B1-createRefreshToken"><span class="toc-number">1.1.</span> <span class="toc-text">示例1: createRefreshToken</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B2-getConnUser"><span class="toc-number">1.2.</span> <span class="toc-text">示例2: getConnUser</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B3-authenticate"><span class="toc-number">1.3.</span> <span class="toc-text">示例3: authenticate</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B4-sign-token-with-KMS-and-verify"><span class="toc-number">1.4.</span> <span class="toc-text">示例4: sign_token_with_KMS_and_verify</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B5-getEnterpriseToken"><span class="toc-number">1.5.</span> <span class="toc-text">示例5: getEnterpriseToken</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B6-refreshAuthenticationToken"><span class="toc-number">1.6.</span> <span class="toc-text">示例6: refreshAuthenticationToken</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B7-getCaptcha"><span class="toc-number">1.7.</span> <span class="toc-text">示例7: getCaptcha</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B8-parseTokenFromBase64EncodedString"><span class="toc-number">1.8.</span> <span class="toc-text">示例8: parseTokenFromBase64EncodedString</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B9-doFilter"><span class="toc-number">1.9.</span> <span class="toc-text">示例9: doFilter</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B10-createJwtToken"><span class="toc-number">1.10.</span> <span class="toc-text">示例10: createJwtToken</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B11-authenticate"><span class="toc-number">1.11.</span> <span class="toc-text">示例11: authenticate</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B12-executeSignOut"><span class="toc-number">1.12.</span> <span class="toc-text">示例12: executeSignOut</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B13-getAudienceFromToken"><span class="toc-number">1.13.</span> <span class="toc-text">示例13: getAudienceFromToken</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B14-getAudienceFromToken"><span class="toc-number">1.14.</span> <span class="toc-text">示例14: getAudienceFromToken</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B15-getClaimsFromToken"><span class="toc-number">1.15.</span> <span class="toc-text">示例15: getClaimsFromToken</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B16-getClaimsFromToken"><span class="toc-number">1.16.</span> <span class="toc-text">示例16: getClaimsFromToken</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B17-refreshToken"><span class="toc-number">1.17.</span> <span class="toc-text">示例17: refreshToken</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B18-getExpirationDateFromToken"><span class="toc-number">1.18.</span> <span class="toc-text">示例18: getExpirationDateFromToken</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B19-getUsernameFromToken"><span class="toc-number">1.19.</span> <span class="toc-text">示例19: getUsernameFromToken</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B20-getExpirationDateFromToken"><span class="toc-number">1.20.</span> <span class="toc-text">示例20: getExpirationDateFromToken</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Claims-getSubject"><span class="toc-number">2.</span> <span class="toc-text">Claims.getSubject</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B1-getAuthentication"><span class="toc-number">2.1.</span> <span class="toc-text">示例1: getAuthentication</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B2-parseRefreshToken"><span class="toc-number">2.2.</span> <span class="toc-text">示例2: parseRefreshToken</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B3-getAuthentication"><span class="toc-number">2.3.</span> <span class="toc-text">示例3: getAuthentication</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B4-getUserFromToken"><span class="toc-number">2.4.</span> <span class="toc-text">示例4: getUserFromToken</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B5-parseAccessJwtToken"><span class="toc-number">2.5.</span> <span class="toc-text">示例5: parseAccessJwtToken</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B6-getUsernameFromToken"><span class="toc-number">2.6.</span> <span class="toc-text">示例6: getUsernameFromToken</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B7-getUsernameFromToken"><span class="toc-number">2.7.</span> <span class="toc-text">示例7: getUsernameFromToken</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B8-getUsernameFromToken"><span class="toc-number">2.8.</span> <span class="toc-text">示例8: getUsernameFromToken</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B9-getAuthentication"><span class="toc-number">2.9.</span> <span class="toc-text">示例9: getAuthentication</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B10-getUsernameFromToken"><span class="toc-number">2.10.</span> <span class="toc-text">示例10: getUsernameFromToken</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B11-isAdmin"><span class="toc-number">2.11.</span> <span class="toc-text">示例11: isAdmin</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B12-getAuthentication"><span class="toc-number">2.12.</span> <span class="toc-text">示例12: getAuthentication</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B13-getUsernameFromToken"><span class="toc-number">2.13.</span> <span class="toc-text">示例13: getUsernameFromToken</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B14-decodeCookie"><span class="toc-number">2.14.</span> <span class="toc-text">示例14: decodeCookie</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Claims-get%E6%96%B9%E6%B3%95"><span class="toc-number">3.</span> <span class="toc-text">Claims.get方法</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B1-getConnUser"><span class="toc-number">3.1.</span> <span class="toc-text">示例1: getConnUser</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B2-authenticate"><span class="toc-number">3.2.</span> <span class="toc-text">示例2: authenticate</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B3-parseAndValidate"><span class="toc-number">3.3.</span> <span class="toc-text">示例3: parseAndValidate</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B4-getPayload"><span class="toc-number">3.4.</span> <span class="toc-text">示例4: getPayload</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B5-getAudienceFromToken"><span class="toc-number">3.5.</span> <span class="toc-text">示例5: getAudienceFromToken</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B6-login"><span class="toc-number">3.6.</span> <span class="toc-text">示例6: login</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B7-parseAccessJwtToken"><span class="toc-number">3.7.</span> <span class="toc-text">示例7: parseAccessJwtToken</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B8-getLastPasswordResetDateFromTokenClaims"><span class="toc-number">3.8.</span> <span class="toc-text">示例8: getLastPasswordResetDateFromTokenClaims</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B9-getAudienceFromToken"><span class="toc-number">3.9.</span> <span class="toc-text">示例9: getAudienceFromToken</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B10-getClaims"><span class="toc-number">3.10.</span> <span class="toc-text">示例10: getClaims</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B11-getUserIdFromToken"><span class="toc-number">3.11.</span> <span class="toc-text">示例11: getUserIdFromToken</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B12-doFilterInternal"><span class="toc-number">3.12.</span> <span class="toc-text">示例12: doFilterInternal</span></a></li></ol></li></ol>
                                  </div>
                              </button>
                          
                          
                      
                    
                      <a href="#nexmoe-content" class="toc-link" aria-label="回到顶部" title="top"><button class="mdui-fab mdui-ripple"><i class="nexmoefont icon-caret-top"></i></button></a>
                  </div>
              </div>
            </div>
        </div>
    </div>
     
    <div id="nexmoe-search-space">
        <div class="search-container">
            <div class="search-header">
                <div class="search-input-container">
                    <input class="search-input" type="text" placeholder="Search" oninput="sinput();">
                </div>
                <a class="search-close" onclick="sclose();">×</a>
            </div>
            <div class="search-body"></div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/combine/npm/lazysizes@5.1.0/lazysizes.min.js,npm/mdui@0.4.3/dist/js/mdui.min.js?v=1"></script>
<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>

 

<script async src="/js/app.js?v=1656038931372"></script>



<script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js"></script>
<script>
	$(".justified-gallery").justifiedGallery({
		rowHeight: 160,
		margins: 10,
	});
</script>


    





    <!-- baidu Analytics -->
<script>
    var _hmt = _hmt || [];
    (function() {var hm = document.createElement('script');
    hm.src = 'https://hm.baidu.com/hm.js?0a7e154da92f76d05c83b48cbab331da#&lt;ID&gt;';
    var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(hm, s);
    })();
</script>

</body>

</html>
