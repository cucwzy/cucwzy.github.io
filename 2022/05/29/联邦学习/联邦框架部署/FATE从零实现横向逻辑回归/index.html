<!DOCTYPE html>

<html lang="en">

<head>
    
    <title>FATE从零实现横向逻辑回归 - Shuyan</title>
    <meta charset="UTF-8">
    <meta name="keywords" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5">
    
    

    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
    <meta name="description" content="联邦学习之逻辑回归横向逻辑回归（HomoLR）横向联邦中模型的一般训练过程：  第三方分发公私钥：参与方持有PK，第三方持有SK 参与方本地训练模型，加密上传到第三方 第三方解密，聚合模型，做加权平均 发送给各参与方，参与方本地更新模型直到收敛。  其中，模型聚合使用了安全聚合算法：SecureAggregation。大概思路是：各参与方通过加入随机数，汇总后的随机数能够抵消，使得第三方只能得到总">
<meta property="og:type" content="article">
<meta property="og:title" content="FATE从零实现横向逻辑回归">
<meta property="og:url" content="http://example.com/2022/05/29/%E8%81%94%E9%82%A6%E5%AD%A6%E4%B9%A0/%E8%81%94%E9%82%A6%E6%A1%86%E6%9E%B6%E9%83%A8%E7%BD%B2/FATE%E4%BB%8E%E9%9B%B6%E5%AE%9E%E7%8E%B0%E6%A8%AA%E5%90%91%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92/index.html">
<meta property="og:site_name" content="Shuyan">
<meta property="og:description" content="联邦学习之逻辑回归横向逻辑回归（HomoLR）横向联邦中模型的一般训练过程：  第三方分发公私钥：参与方持有PK，第三方持有SK 参与方本地训练模型，加密上传到第三方 第三方解密，聚合模型，做加权平均 发送给各参与方，参与方本地更新模型直到收敛。  其中，模型聚合使用了安全聚合算法：SecureAggregation。大概思路是：各参与方通过加入随机数，汇总后的随机数能够抵消，使得第三方只能得到总">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/2022/05/29/%E8%81%94%E9%82%A6%E5%AD%A6%E4%B9%A0/%E8%81%94%E9%82%A6%E6%A1%86%E6%9E%B6%E9%83%A8%E7%BD%B2/FATE%E4%BB%8E%E9%9B%B6%E5%AE%9E%E7%8E%B0%E6%A8%AA%E5%90%91%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92/FATE%E4%BB%8E%E9%9B%B6%E5%AE%9E%E7%8E%B0%E6%A8%AA%E5%90%91%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92.assets/image-20220603110936978.png">
<meta property="og:image" content="http://example.com/2022/05/29/%E8%81%94%E9%82%A6%E5%AD%A6%E4%B9%A0/%E8%81%94%E9%82%A6%E6%A1%86%E6%9E%B6%E9%83%A8%E7%BD%B2/FATE%E4%BB%8E%E9%9B%B6%E5%AE%9E%E7%8E%B0%E6%A8%AA%E5%90%91%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92/FATE%E4%BB%8E%E9%9B%B6%E5%AE%9E%E7%8E%B0%E6%A8%AA%E5%90%91%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92.assets/image-20220603111006601.png">
<meta property="og:image" content="http://example.com/2022/05/29/%E8%81%94%E9%82%A6%E5%AD%A6%E4%B9%A0/%E8%81%94%E9%82%A6%E6%A1%86%E6%9E%B6%E9%83%A8%E7%BD%B2/FATE%E4%BB%8E%E9%9B%B6%E5%AE%9E%E7%8E%B0%E6%A8%AA%E5%90%91%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92/FATE%E4%BB%8E%E9%9B%B6%E5%AE%9E%E7%8E%B0%E6%A8%AA%E5%90%91%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92.assets/image-20220603111037150.png">
<meta property="og:image" content="http://example.com/2022/05/29/%E8%81%94%E9%82%A6%E5%AD%A6%E4%B9%A0/%E8%81%94%E9%82%A6%E6%A1%86%E6%9E%B6%E9%83%A8%E7%BD%B2/FATE%E4%BB%8E%E9%9B%B6%E5%AE%9E%E7%8E%B0%E6%A8%AA%E5%90%91%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92/FATE%E4%BB%8E%E9%9B%B6%E5%AE%9E%E7%8E%B0%E6%A8%AA%E5%90%91%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92.assets/image-20220602175903034.png">
<meta property="og:image" content="http://example.com/2022/05/29/%E8%81%94%E9%82%A6%E5%AD%A6%E4%B9%A0/%E8%81%94%E9%82%A6%E6%A1%86%E6%9E%B6%E9%83%A8%E7%BD%B2/FATE%E4%BB%8E%E9%9B%B6%E5%AE%9E%E7%8E%B0%E6%A8%AA%E5%90%91%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92/FATE%E4%BB%8E%E9%9B%B6%E5%AE%9E%E7%8E%B0%E6%A8%AA%E5%90%91%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92.assets/image-20220602175345762.png">
<meta property="og:image" content="http://example.com/2022/05/29/%E8%81%94%E9%82%A6%E5%AD%A6%E4%B9%A0/%E8%81%94%E9%82%A6%E6%A1%86%E6%9E%B6%E9%83%A8%E7%BD%B2/FATE%E4%BB%8E%E9%9B%B6%E5%AE%9E%E7%8E%B0%E6%A8%AA%E5%90%91%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92/FATE%E4%BB%8E%E9%9B%B6%E5%AE%9E%E7%8E%B0%E6%A8%AA%E5%90%91%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92.assets/image-20220602175211839.png">
<meta property="og:image" content="http://example.com/2022/05/29/%E8%81%94%E9%82%A6%E5%AD%A6%E4%B9%A0/%E8%81%94%E9%82%A6%E6%A1%86%E6%9E%B6%E9%83%A8%E7%BD%B2/FATE%E4%BB%8E%E9%9B%B6%E5%AE%9E%E7%8E%B0%E6%A8%AA%E5%90%91%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92/FATE%E4%BB%8E%E9%9B%B6%E5%AE%9E%E7%8E%B0%E6%A8%AA%E5%90%91%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92.assets/image-20220602175239458.png">
<meta property="og:image" content="http://example.com/2022/05/29/%E8%81%94%E9%82%A6%E5%AD%A6%E4%B9%A0/%E8%81%94%E9%82%A6%E6%A1%86%E6%9E%B6%E9%83%A8%E7%BD%B2/FATE%E4%BB%8E%E9%9B%B6%E5%AE%9E%E7%8E%B0%E6%A8%AA%E5%90%91%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92/FATE%E4%BB%8E%E9%9B%B6%E5%AE%9E%E7%8E%B0%E6%A8%AA%E5%90%91%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92.assets/image-20220606114621536.png">
<meta property="og:image" content="http://example.com/2022/05/29/%E8%81%94%E9%82%A6%E5%AD%A6%E4%B9%A0/%E8%81%94%E9%82%A6%E6%A1%86%E6%9E%B6%E9%83%A8%E7%BD%B2/FATE%E4%BB%8E%E9%9B%B6%E5%AE%9E%E7%8E%B0%E6%A8%AA%E5%90%91%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92/FATE%E4%BB%8E%E9%9B%B6%E5%AE%9E%E7%8E%B0%E6%A8%AA%E5%90%91%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92.assets/image-20220603105626741.png">
<meta property="og:image" content="http://example.com/2022/05/29/%E8%81%94%E9%82%A6%E5%AD%A6%E4%B9%A0/%E8%81%94%E9%82%A6%E6%A1%86%E6%9E%B6%E9%83%A8%E7%BD%B2/FATE%E4%BB%8E%E9%9B%B6%E5%AE%9E%E7%8E%B0%E6%A8%AA%E5%90%91%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92/FATE%E4%BB%8E%E9%9B%B6%E5%AE%9E%E7%8E%B0%E6%A8%AA%E5%90%91%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92.assets/image-20220603100020589.png">
<meta property="og:image" content="http://example.com/2022/05/29/%E8%81%94%E9%82%A6%E5%AD%A6%E4%B9%A0/%E8%81%94%E9%82%A6%E6%A1%86%E6%9E%B6%E9%83%A8%E7%BD%B2/FATE%E4%BB%8E%E9%9B%B6%E5%AE%9E%E7%8E%B0%E6%A8%AA%E5%90%91%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92/FATE%E4%BB%8E%E9%9B%B6%E5%AE%9E%E7%8E%B0%E6%A8%AA%E5%90%91%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92.assets/image-20220603100129097.png">
<meta property="og:image" content="http://example.com/2022/05/29/%E8%81%94%E9%82%A6%E5%AD%A6%E4%B9%A0/%E8%81%94%E9%82%A6%E6%A1%86%E6%9E%B6%E9%83%A8%E7%BD%B2/FATE%E4%BB%8E%E9%9B%B6%E5%AE%9E%E7%8E%B0%E6%A8%AA%E5%90%91%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92/FATE%E4%BB%8E%E9%9B%B6%E5%AE%9E%E7%8E%B0%E6%A8%AA%E5%90%91%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92.assets/image-20220603100241724.png">
<meta property="og:image" content="http://example.com/2022/05/29/%E8%81%94%E9%82%A6%E5%AD%A6%E4%B9%A0/%E8%81%94%E9%82%A6%E6%A1%86%E6%9E%B6%E9%83%A8%E7%BD%B2/FATE%E4%BB%8E%E9%9B%B6%E5%AE%9E%E7%8E%B0%E6%A8%AA%E5%90%91%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92/FATE%E4%BB%8E%E9%9B%B6%E5%AE%9E%E7%8E%B0%E6%A8%AA%E5%90%91%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92.assets/image-20220603100208225.png">
<meta property="article:published_time" content="2022-05-29T03:11:05.000Z">
<meta property="article:modified_time" content="2022-06-06T04:03:43.853Z">
<meta property="article:author" content="Shuyan">
<meta property="article:tag" content="联邦学习">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/2022/05/29/%E8%81%94%E9%82%A6%E5%AD%A6%E4%B9%A0/%E8%81%94%E9%82%A6%E6%A1%86%E6%9E%B6%E9%83%A8%E7%BD%B2/FATE%E4%BB%8E%E9%9B%B6%E5%AE%9E%E7%8E%B0%E6%A8%AA%E5%90%91%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92/FATE%E4%BB%8E%E9%9B%B6%E5%AE%9E%E7%8E%B0%E6%A8%AA%E5%90%91%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92.assets/image-20220603110936978.png">
    <link rel="stylesheet" href="/lib/jquery.fancybox.min.css?v=1656038931329">
    
        <link rel="stylesheet" href="//at.alicdn.com/t/font_1038733_0xvrvpg9c0r.css">
    
    <link rel="stylesheet" href="/lib/mdui_043tiny/css/mdui.css?v=1656038931329">
    <link rel="stylesheet" href="/lib/iconfont/iconfont.css?v=1656038931329">
    <link rel="stylesheet" href="/css/style.css?v=1656038931329">
     
    
<meta name="generator" content="Hexo 5.4.0"></head>

<body class="mdui-drawer-body-left">
    
    <div id="nexmoe-background">
        <div class="nexmoe-bg" style="background-image: url(http://mms0.baidu.com/it/u=2467909075,3604847220&amp;fm=253&amp;app=138&amp;f=JPEG&amp;fmt=auto&amp;q=75?w=801&amp;h=500)"></div>
        <div class="mdui-appbar mdui-shadow-0">
            <div class="mdui-toolbar">
                <a mdui-drawer="{target: '#drawer', swipe: true}" title="menu" class="mdui-btn mdui-btn-icon mdui-ripple"><i class="mdui-icon nexmoefont icon-menu"></i></a>
                <div class="mdui-toolbar-spacer"></div>
                <!--<a href="javascript:;" class="mdui-btn mdui-btn-icon"><i class="mdui-icon material-icons">search</i></a>-->
                <a href="/" title="Shuyan" class="mdui-btn mdui-btn-icon"><img src="http://mms2.baidu.com/it/u=1730774443,2723245118&amp;fm=253&amp;app=120&amp;f=JPEG&amp;fmt=auto&amp;q=75?w=500&amp;h=500" alt="Shuyan"></a>
            </div>
        </div>
    </div>
    <div id="nexmoe-header">
        <div class="nexmoe-drawer mdui-drawer" id="drawer">
    <div class="nexmoe-avatar mdui-ripple">
        <a href="/" title="Shuyan">
            <img src="http://mms2.baidu.com/it/u=1730774443,2723245118&amp;fm=253&amp;app=120&amp;f=JPEG&amp;fmt=auto&amp;q=75?w=500&amp;h=500" alt="Shuyan" alt="Shuyan">
        </a>
    </div>
    <div class="nexmoe-count">
        <div><span>Articles</span>95</div>
        <div><span>Tags</span>20</div>
        <div><span>Categories</span>33</div>
    </div>
    <div class="nexmoe-list mdui-list" mdui-collapse="{accordion: true}">
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple false" href="/" title="回到首页">
            <i class="mdui-list-item-icon nexmoefont icon-home"></i>
            <div class="mdui-list-item-content">
                回到首页
            </div>
        </a>
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple false" href="/categories" title="文章归档">
            <i class="mdui-list-item-icon nexmoefont icon-container"></i>
            <div class="mdui-list-item-content">
                文章归档
            </div>
        </a>
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple false" href="/about" title="梦华录">
            <i class="mdui-list-item-icon nexmoefont icon-info-circle"></i>
            <div class="mdui-list-item-content">
                梦华录
            </div>
        </a>
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple false" href="/PY.html" title="我的朋友">
            <i class="mdui-list-item-icon nexmoefont icon-unorderedlist"></i>
            <div class="mdui-list-item-content">
                我的朋友
            </div>
        </a>
        
    </div>
    <aside id="nexmoe-sidebar">
    
    <div class="nexmoe-widget-wrap">
    <div class="nexmoe-widget nexmoe-search">
         
            <form id="search_form" action_e="https://cn.bing.com/search?q=site:nexmoe.com" onsubmit="return search();">
                <label><input id="search_value" name="q" type="search" placeholder="Search"></label>
            </form>
         
    </div>
</div>
    
    <div class="nexmoe-widget-wrap">
    <div class="nexmoe-widget nexmoe-social">
        <a class="mdui-ripple" href="https://qm.qq.com/cgi-bin/qm/qr?k=rd1wdMWxpIZJe5AIruJkY7xD8d68h031&noverify=0" target="_blank" mdui-tooltip="{content: 'QQ'}" style="color: rgb(249, 174, 8);background-color: rgba(249, 174, 8, .1);">
            <i class="nexmoefont icon-QQ"></i>
        </a><a class="mdui-ripple" href="https://space.bilibili.com/400417888" target="_blank" mdui-tooltip="{content: '哔哩哔哩'}" style="color: rgb(231, 106, 141);background-color: rgba(231, 106, 141, .15);">
            <i class="nexmoefont icon-bilibili"></i>
        </a><a class="mdui-ripple" href="https://github.com/nexmoe/" target="_blank" mdui-tooltip="{content: 'GitHub'}" style="color: rgb(25, 23, 23);background-color: rgba(25, 23, 23, .15);">
            <i class="nexmoefont icon-github"></i>
        </a>
    </div>
</div>
    
    
  <div class="nexmoe-widget-wrap">
    <h3 class="nexmoe-widget-title">Categories</h3>
    <div class="nexmoe-widget">

      <ul class="category-list">

        


        

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/C语言/">C语言</a>
          <span class="category-list-count">3</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Docker/">Docker</a>
          <span class="category-list-count">1</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/JAVA/">JAVA</a>
          <span class="category-list-count">42</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/JAVA/“Spring框架”/JavaWeb/">JavaWeb</a>
          <span class="category-list-count">3</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/LaTex/">LaTex</a>
          <span class="category-list-count">1</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Leetcode/">Leetcode</a>
          <span class="category-list-count">21</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Linux/">Linux</a>
          <span class="category-list-count">2</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/JAVA/“Spring框架”/Mybaits/">Mybaits</a>
          <span class="category-list-count">6</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/JAVA/“Spring框架”/SSM/">SSM</a>
          <span class="category-list-count">1</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/C语言/STL/">STL</a>
          <span class="category-list-count">3</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/JAVA/“Spring框架”/Spring/">Spring</a>
          <span class="category-list-count">7</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/JAVA/“Spring框架”/SpringBoot/">SpringBoot</a>
          <span class="category-list-count">3</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/JAVA/“Spring框架”/SpringMVC/">SpringMVC</a>
          <span class="category-list-count">1</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/JAVA/Spring框架/">Spring框架</a>
          <span class="category-list-count">2</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Leetcode/sort/">sort</a>
          <span class="category-list-count">3</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/JAVA/“Docker”/">“Docker”</a>
          <span class="category-list-count">2</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/JAVA/“JAVA基础知识”/">“JAVA基础知识”</a>
          <span class="category-list-count">2</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/JAVA/“JVM”/">“JVM”</a>
          <span class="category-list-count">3</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/JAVA/“Nginx”/">“Nginx”</a>
          <span class="category-list-count">8</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/JAVA/“Redis”/">“Redis”</a>
          <span class="category-list-count">3</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/JAVA/Spring框架/“Security”/">“Security”</a>
          <span class="category-list-count">2</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/JAVA/“Spring框架”/">“Spring框架”</a>
          <span class="category-list-count">22</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Leetcode/二叉树/">二叉树</a>
          <span class="category-list-count">4</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Leetcode/剑指offer/">剑指offer</a>
          <span class="category-list-count">1</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Leetcode/动态规划/">动态规划</a>
          <span class="category-list-count">2</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Leetcode/线性表/单链表/">单链表</a>
          <span class="category-list-count">1</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Leetcode/字符串/">字符串</a>
          <span class="category-list-count">2</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Leetcode/线性表/数组/">数组</a>
          <span class="category-list-count">2</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Leetcode/栈和队列/">栈和队列</a>
          <span class="category-list-count">1</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Leetcode/算法/">算法</a>
          <span class="category-list-count">1</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Leetcode/线性表/">线性表</a>
          <span class="category-list-count">3</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/联邦学习/">联邦学习</a>
          <span class="category-list-count">8</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Leetcode/贪心算法/">贪心算法</a>
          <span class="category-list-count">1</span>
        </li>

        
      </ul>

    </div>
  </div>


    
    
  <div class="nexmoe-widget-wrap">
    <h3 class="nexmoe-widget-title">Tag Cloud</h3>
    <div id="randomtagcloud" class="nexmoe-widget tagcloud">
      <a href="/tags/Docker/" style="font-size: 12.86px;">Docker</a> <a href="/tags/JAVA/" style="font-size: 11.43px;">JAVA</a> <a href="/tags/JVM/" style="font-size: 12.86px;">JVM</a> <a href="/tags/JavaWeb/" style="font-size: 12.86px;">JavaWeb</a> <a href="/tags/LaTex/" style="font-size: 10px;">LaTex</a> <a href="/tags/Leetcode/" style="font-size: 20px;">Leetcode</a> <a href="/tags/Linux/" style="font-size: 11.43px;">Linux</a> <a href="/tags/Mybaits/" style="font-size: 15.71px;">Mybaits</a> <a href="/tags/Nginx/" style="font-size: 18.57px;">Nginx</a> <a href="/tags/Redis/" style="font-size: 12.86px;">Redis</a> <a href="/tags/SSM/" style="font-size: 10px;">SSM</a> <a href="/tags/STL/" style="font-size: 12.86px;">STL</a> <a href="/tags/Security/" style="font-size: 11.43px;">Security</a> <a href="/tags/Spring/" style="font-size: 17.14px;">Spring</a> <a href="/tags/SpringBoot/" style="font-size: 12.86px;">SpringBoot</a> <a href="/tags/SpringMVC/" style="font-size: 11.43px;">SpringMVC</a> <a href="/tags/%E4%BA%8C%E5%8F%89%E6%A0%91/" style="font-size: 14.29px;">二叉树</a> <a href="/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/" style="font-size: 11.43px;">动态规划</a> <a href="/tags/%E6%90%9C%E7%B4%A2/" style="font-size: 11.43px;">搜索</a> <a href="/tags/%E8%81%94%E9%82%A6%E5%AD%A6%E4%B9%A0/" style="font-size: 18.57px;">联邦学习</a>
    </div>
    
  </div>
  <style>
    #nexmoe-header .nexmoe-widget-wrap .tagcloud a:nth-child(7n+1) {
    background-color: rgba(255,78,106,0.15);
    color: rgba(255,78,106,0.8);
    }
    #nexmoe-header .nexmoe-widget-wrap .tagcloud a:nth-child(7n+2) {
    background-color: rgba(255,170,115,0.15);
    color: #ffaa73;
    }
    #nexmoe-header .nexmoe-widget-wrap .tagcloud a:nth-child(7n+3) {
    background-color: rgba(254,212,102,0.15);
    color: #fed466;
    }
    #nexmoe-header .nexmoe-widget-wrap .tagcloud a:nth-child(7n+4) {
    background-color: rgba(60,220,130,0.15);
    color: #3cdc82;
    }
    #nexmoe-header .nexmoe-widget-wrap .tagcloud a:nth-child(7n+5) {
    background-color: rgba(100,220,240,0.15);
    color: #64dcf0;
    }
    #nexmoe-header .nexmoe-widget-wrap .tagcloud a:nth-child(7n+6) {
    background-color: rgba(100,185,255,0.15);
    color: #64b9ff;
    }
    #nexmoe-header .nexmoe-widget-wrap .tagcloud a:nth-child(7n+7) {
    background-color: rgba(180,180,255,0.15);
    color: #b4b4ff;
    }
    #nexmoe-content .nexmoe-post .nexmoe-post-meta {
    margin: 25px 0px;
    font-size: 0;
    }
    #nexmoe-content .nexmoe-post .nexmoe-post-meta a {
    border-radius: 20px;
    padding: 10px 18px;
    color: #fff;
    font-size: 14px;
    display: inline-block;
    margin-bottom: 5px;
    margin-right: 10px;
    }
    #nexmoe-content .nexmoe-post .nexmoe-post-meta a .nexmoefont {
    font-size: 14px;
    }
    #nexmoe-content .nexmoe-post .nexmoe-post-meta a:before,
    #nexmoe-content .nexmoe-post .nexmoe-post-meta i:before {
    margin-right: 5px;
    }
    #nexmoe-content .nexmoe-post .nexmoe-post-meta a:nth-child(7n+1) {
    background-color: rgba(255,78,106,0.15);
    color: #ff4e6a;
    }
    #nexmoe-content .nexmoe-post .nexmoe-post-meta a:nth-child(7n+2) {
    background-color: rgba(255,170,115,0.15);
    color: #ffaa73;
    }
    #nexmoe-content .nexmoe-post .nexmoe-post-meta a:nth-child(7n+3) {
    background-color: rgba(254,212,102,0.15);
    color: #fed466;
    }
    #nexmoe-content .nexmoe-post .nexmoe-post-meta a:nth-child(7n+4) {
    background-color: rgba(60,220,130,0.15);
    color: #3cdc82;
    }
    #nexmoe-content .nexmoe-post .nexmoe-post-meta a:nth-child(7n+5) {
    background-color: rgba(100,220,240,0.15);
    color: #64dcf0;
    }
    #nexmoe-content .nexmoe-post .nexmoe-post-meta a:nth-child(7n+6) {
    background-color: rgba(100,185,255,0.15);
    color: #64b9ff;
    }
    #nexmoe-content .nexmoe-post .nexmoe-post-meta a:nth-child(7n+7) {
    background-color: rgba(180,180,255,0.15);
    color: #b4b4ff;
    }
  </style>


    
</aside>
    <div class="nexmoe-copyright">
        &copy; 2022 Shuyan
        Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
        & <a href="https://github.com/theme-nexmoe/hexo-theme-nexmoe" target="_blank">Nexmoe</a>
        <br><a target="_blank" href=" "><img src="http://mms0.baidu.com/it/u=991445098,3809803602&fm=253&app=138&f=JPEG&fmt=auto&q=75?w=500&h=500" width="100px" ></a><script data-ad-client="ca-pub-2058306854838448" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    </div>
</div><!-- .nexmoe-drawer -->
    </div>
    <div id="nexmoe-content">
        <div class="nexmoe-primary">
            <div class="nexmoe-post">

  <article>
      
          <div class="nexmoe-post-cover" style="padding-bottom: 62.5%;"> 
              <img data-src="/img/联邦学习.jpg" data-sizes="auto" alt="FATE从零实现横向逻辑回归" class="lazyload">
              <h1>FATE从零实现横向逻辑回归</h1>
          </div>
      
      
      <div class="nexmoe-post-meta nexmoe-rainbow" style="margin:10px 0!important;">
    <a><i class="nexmoefont icon-calendar-fill"></i>2022年05月29日</a>
</div>

      

      <h1 id="联邦学习之逻辑回归"><a href="#联邦学习之逻辑回归" class="headerlink" title="联邦学习之逻辑回归"></a>联邦学习之逻辑回归</h1><h2 id="横向逻辑回归（HomoLR）"><a href="#横向逻辑回归（HomoLR）" class="headerlink" title="横向逻辑回归（HomoLR）"></a>横向逻辑回归（HomoLR）</h2><p>横向联邦中模型的一般训练过程：</p>
<ul>
<li>第三方分发公私钥：参与方持有PK，第三方持有SK</li>
<li>参与方本地训练模型，加密上传到第三方</li>
<li>第三方解密，聚合模型，做加权平均</li>
<li>发送给各参与方，参与方本地更新模型直到收敛。</li>
</ul>
<p>其中，模型聚合使用了安全聚合算法：<code>SecureAggregation</code>。大概思路是：各参与方通过加入随机数，汇总后的随机数能够抵消，使得第三方只能得到总模型，无法得知某个参与方的具体模型。</p>
<blockquote>
<p>算法 paper：<a target="_blank" rel="noopener" href="https://dl.acm.org/doi/abs/10.1145/3133956.3133982">Practical Secure Aggregation for Privacy-Preserving Machine Learning</a></p>
</blockquote>
<p><img data-fancybox="gallery" data-sizes="auto" data-src="FATE%E4%BB%8E%E9%9B%B6%E5%AE%9E%E7%8E%B0%E6%A8%AA%E5%90%91%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92.assets/image-20220603110936978.png" alt="image-20220603110936978" class="lazyload"></p>
<h2 id="2、纵向逻辑回归（HeteroLR）"><a href="#2、纵向逻辑回归（HeteroLR）" class="headerlink" title="2、纵向逻辑回归（HeteroLR）"></a>2、纵向逻辑回归（HeteroLR）</h2><p>纵向联邦中模型的一般训练过程：</p>
<ul>
<li><p>加密样本对齐</p>
</li>
<li><p>参考横向联邦的一般过程</p>
</li>
</ul>
<p><img data-fancybox="gallery" data-sizes="auto" data-src="FATE%E4%BB%8E%E9%9B%B6%E5%AE%9E%E7%8E%B0%E6%A8%AA%E5%90%91%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92.assets/image-20220603111006601.png" alt="image-20220603111006601" class="lazyload"></p>
<p>纵向联邦场景中需要进行一步隐私集合求交操作（PSI），FATE 中基本操作是使用<code>RSA+Hash</code>的方案。此处暂不做介绍。</p>
<blockquote>
<p>方案 Paper：<a target="_blank" rel="noopener" href="https://codeantenna.com/a/MSJuBu6AKD">Private federated learning on vertically partitioned data via entity resolution and additively homomorphic encryption</a></p>
</blockquote>
<p>另外，纵向联邦中我们通常会使用加法同态（Paillier）对梯度进行加密，但是加密只支持同态加和标量乘。因此，我们需要对一般的逻辑回归公式进行处理。这里的处理方法是使用泰勒公式对式子在零点处展开。</p>
<blockquote>
<p>方案 paper：<a target="_blank" rel="noopener" href="https://arxiv.org/abs/1912.00513v1">A Quasi-Newton Method Based Vertical Federated</a></p>
</blockquote>
<p>符号说明：</p>
<table>
<thead>
<tr>
<th align="center">符号</th>
<th align="center">含义</th>
</tr>
</thead>
<tbody><tr>
<td align="center">【【*】】</td>
<td align="center">同态加密</td>
</tr>
<tr>
<td align="center">$U^A_1$</td>
<td align="center">$W_AX_A$</td>
</tr>
<tr>
<td align="center">$U^B_1$</td>
<td align="center">$W_BX_B$</td>
</tr>
<tr>
<td align="center">loss</td>
<td align="center">$$log(1+exp(-yW^Tx)) \approx log2-\frac{1}{2}yW^Tx+\frac{1}{8}(W^Tx)^2$$</td>
</tr>
<tr>
<td align="center">梯度g</td>
<td align="center">$(\frac{1}{1+exp(-yW^Tx)}-1)yx \approx (\frac{1}{2}yW^Tx - 1) \frac{1}{2}yx$</td>
</tr>
<tr>
<td align="center">残差d</td>
<td align="center">$(\frac{1}{1+exp(-yW^Tx)}-1)y \approx (\frac{1}{2}yW^Tx - 1) \frac{1}{2}y$；即$g=dx$</td>
</tr>
</tbody></table>
<p>根据逻辑回归背景知识，</p>
<p>具体过程说明：</p>
<p>UB 表示 guest，UA 表示 host，C 表示 abitier。</p>
<ul>
<li><p>guest 计算本地残差并发给 host，然后向中心发送梯度gb；</p>
</li>
<li><p>host 利用残差计算本地梯度ga并发送到中心；</p>
</li>
<li><p>abitier 持有私钥解密更新全局梯度g，再返回给参与方。</p>
</li>
</ul>
<p><img data-fancybox="gallery" data-sizes="auto" data-src="FATE%E4%BB%8E%E9%9B%B6%E5%AE%9E%E7%8E%B0%E6%A8%AA%E5%90%91%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92.assets/image-20220603111037150.png" alt="image-20220603111037150" class="lazyload"></p>
<h2 id="3、总结"><a href="#3、总结" class="headerlink" title="3、总结"></a>3、总结</h2><p>横向联邦中：最终训练的模型是共享的；</p>
<p>纵向联邦中：模型分布在各参与方，模型的使用需要参与方共同参与。</p>
<h1 id="一、安装FATE平台"><a href="#一、安装FATE平台" class="headerlink" title="一、安装FATE平台"></a>一、安装FATE平台</h1><p>FATE是微众银行开源的联邦学习框架</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-meta">官方地址：https</span>:<span class="hljs-string">//fate.fedai.org</span><br><br><span class="hljs-meta">文档：https</span>:<span class="hljs-string">//fate.readthedocs.io/en/latest/_build_temp/standalone-deploy/doc/Fate-standalone_deployment_guide_zh.html</span><br><br><span class="hljs-attr">https</span>:<span class="hljs-string">//github.com/FederatedAI/Practicing-Federated-Learning/tree/main/chapter05_FATE_HFL</span><br></code></pre></td></tr></table></figure>

<p>注意：书本使用的FATE是1.4.0版本，而我使用的是1.6.0版本（2021-8-13），文中的配置文件中的注释在使用时要去除</p>
<p>采用在<a target="_blank" rel="noopener" href="https://fate.readthedocs.io/en/latest/_build_temp/standalone-deploy/doc/Fate-standalone_deployment_guide_zh.html#id1">主机安装FATE的安装模式</a></p>
<p>官方文档中的命令都是用<code>sh</code>运行，因为本机的环境不同，所以采用<code>bash</code></p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-attr">wget</span> <span class="hljs-string">https://webank-ai-1251170195.cos.ap-guangzhou.myqcloud.com/standalone_fate_master_1.6.0.tar.gz</span><br><br><span class="hljs-attr">tar</span> <span class="hljs-string">-xzvf  standalone_fate_master_1.6.0.tar.gz</span><br><br><span class="hljs-attr">cd</span> <span class="hljs-string">standalone_fate_master_1.6.0</span><br><span class="hljs-attr">source</span> <span class="hljs-string">bin/init_env.sh</span><br><span class="hljs-attr">bash</span> <span class="hljs-string">init.sh init</span><br></code></pre></td></tr></table></figure>

<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-meta">问题：service.sh</span>: <span class="hljs-string">[[ not found</span><br><br><span class="hljs-attr">解决：修改init.sh文件中的sh命令为bash</span><br></code></pre></td></tr></table></figure>

<p><img data-fancybox="gallery" data-sizes="auto" data-src="FATE%E4%BB%8E%E9%9B%B6%E5%AE%9E%E7%8E%B0%E6%A8%AA%E5%90%91%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92.assets/image-20220602175903034.png" alt="image-20220602175903034" class="lazyload"></p>
<p>测试：</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-attr">cd</span> <span class="hljs-string">standalone_fate_master_1.6.0</span><br><span class="hljs-attr">source</span> <span class="hljs-string">bin/init_env.sh</span><br><span class="hljs-attr">bash</span> <span class="hljs-string">./python/federatedml/test/run_test.sh</span><br></code></pre></td></tr></table></figure>

<p>会输出一系列的测试输出：</p>
<p><img data-fancybox="gallery" data-sizes="auto" data-src="FATE%E4%BB%8E%E9%9B%B6%E5%AE%9E%E7%8E%B0%E6%A8%AA%E5%90%91%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92.assets/image-20220602175345762.png" alt="image-20220602175345762" class="lazyload"></p>
<p>toy测试</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">python ./examples/toy_example/run_toy_example.py 10000 10000 0<br></code></pre></td></tr></table></figure>

<p>运行起来之后可以看到：</p>
<p><img data-fancybox="gallery" data-sizes="auto" data-src="FATE%E4%BB%8E%E9%9B%B6%E5%AE%9E%E7%8E%B0%E6%A8%AA%E5%90%91%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92.assets/image-20220602175211839.png" alt="image-20220602175211839" class="lazyload"></p>
<p>控制台（<code>IP:8080</code>）：</p>
<p><img data-fancybox="gallery" data-sizes="auto" data-src="FATE%E4%BB%8E%E9%9B%B6%E5%AE%9E%E7%8E%B0%E6%A8%AA%E5%90%91%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92.assets/image-20220602175239458.png" alt="image-20220602175239458" class="lazyload"></p>
<p>可以看到在<code>fate dsl_conf</code>的V2版本，模型种类又比书中所描述的详细不少。<br>V2版本在预设任务配置上有一些改变和提升，最直观的一点是不会自动为训练任务生成预测dsl，需要用户自定义，也可以使用flow命令自动配置预测dsl。<br>为了在V2中使用命令行客户端，即flow命令，需要进行一系列配置。参考<a target="_blank" rel="noopener" href="https://github.com/FederatedAI/FATE-Flow/blob/main/doc/fate_flow_client.zh.md">官方文档</a>，<code>FATE Client</code>包含了FATE项目多个客户端：<code>Pipeline</code>, <code>FATE Flow Client</code> 和 <code>FATE Test</code>。<br>获取所有命令分类和子命令：</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-attr">[IN]</span><br><span class="hljs-attr">flow</span><br><br><span class="hljs-attr">[OUT]</span><br><span class="hljs-attr">Usage</span>: <span class="hljs-string">flow COMMAND [OPTIONS]</span><br><br>  <span class="hljs-attr">Fate</span> <span class="hljs-string">Flow Client</span><br><br><span class="hljs-attr">Options：</span><br>  <span class="hljs-meta">-h,</span> <span class="hljs-string">--help  Show this message and exit.</span><br><br><span class="hljs-attr">Commands：</span><br>  <span class="hljs-attr">component</span>   <span class="hljs-string">Component Operations</span><br>  <span class="hljs-attr">data</span>        <span class="hljs-string">Data Operations</span><br>  <span class="hljs-attr">init</span>        <span class="hljs-string">Flow CLI Init Command</span><br>  <span class="hljs-attr">job</span>         <span class="hljs-string">Job Operations</span><br>  <span class="hljs-attr">model</span>       <span class="hljs-string">Model Operations</span><br>  <span class="hljs-attr">queue</span>       <span class="hljs-string">Queue Operations</span><br>  <span class="hljs-attr">table</span>       <span class="hljs-string">Table Operations</span><br>  <span class="hljs-attr">task</span>        <span class="hljs-string">Task Operations</span><br></code></pre></td></tr></table></figure>



<p>安装FATE-Client和FATE-Test</p>
<p>为方便使用FATE，我们提供了便捷的交互工具<a target="_blank" rel="noopener" href="https://fate.readthedocs.io/en/latest/_build_temp/python/fate_client">FATE-Client</a>以及测试工具<a target="_blank" rel="noopener" href="https://fate.readthedocs.io/en/latest/_build_temp/python/fate_test">FATE-Test</a>.</p>
<p>请在环境内使用以下指令安装：</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-attr">python</span> <span class="hljs-string">-m pip install fate-client</span><br><br><span class="hljs-attr">python</span> <span class="hljs-string">-m pip install fate-test</span><br></code></pre></td></tr></table></figure>

<h1 id="二、切分数据集"><a href="#二、切分数据集" class="headerlink" title="二、切分数据集"></a>二、切分数据集</h1><p>这是一个典型的二分类模型的训练，数据集并不大，使用简单的逻辑回归作为实验模型。<br>传统的线性回归定义：</p>
<p>$$y=W^TX+b,其中W=(w_1;w_2;…;w_n)，X=(x_1,x_2,…,x_n)$$<br>但是对于二分类模型来说，简单的函数线性映射是不能够分类的，还需要一个非线性函数映射到离散标签，</p>
<p>$$y=f(W^TX+b)$$</p>
<p>在逻辑回归中，使用logistic函数进行非线性映射，logistic表示为：</p>
<p>$$f(z)=\frac{1}{1+e^{-z}}$$</p>
<p>数据集：威斯康星州临床科学中心开源的乳腺癌肿瘤数据集</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> sklearn.datasets <span class="hljs-keyword">import</span> load_breast_cancer<br></code></pre></td></tr></table></figure>

<p>为了模拟横向联邦建模的场景，我们首先在本地将乳腺癌数据集切分为特征相同的横向联邦形式，当前的breast数据集有569条样本，我们将前面的469条作为训练样本，后面的100条作为评估测试样本。</p>
<p>从469条训练样本中，选取前200条作为公司A的本地数据，保存为<code>breast_1_train.csv</code>，将剩余的269条数据作为公司B的本地数据，保存为<code>breast_2_train.csv</code>。<br>测试数据集可以不需要切分，两个参与方使用相同的一份测试数据即可，文件命名为<code>breast_eval.csv</code>。<br><code>splitDataset.py</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> sklearn.datasets <span class="hljs-keyword">import</span> load_breast_cancer<br><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd<br><br>breast_dataset = load_breast_cancer()<br><br>breast = pd.DataFrame(breast_dataset.data, columns=breast_dataset.feature_names)<br><br>breast = (breast-breast.mean())/(breast.std())<br><br>col_names = breast.columns.values.tolist()<br><br>columns = &#123;&#125;<br><span class="hljs-keyword">for</span> idx, n <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(col_names):<br>	columns[n] = <span class="hljs-string">&quot;x%d&quot;</span>%idx<br><br>breast = breast.rename(columns=columns)<br><br>breast[<span class="hljs-string">&#x27;y&#x27;</span>] = breast_dataset.target<br><br>breast[<span class="hljs-string">&#x27;idx&#x27;</span>] = <span class="hljs-built_in">range</span>(breast.shape[<span class="hljs-number">0</span>])<br><br>idx = breast[<span class="hljs-string">&#x27;idx&#x27;</span>]<br><br>breast.drop(labels=[<span class="hljs-string">&#x27;idx&#x27;</span>], axis=<span class="hljs-number">1</span>, inplace = <span class="hljs-literal">True</span>)<br><br>breast.insert(<span class="hljs-number">0</span>, <span class="hljs-string">&#x27;idx&#x27;</span>, idx)<br><br>breast = breast.sample(frac=<span class="hljs-number">1</span>)<br><br>train = breast.iloc[:<span class="hljs-number">469</span>]<br><br><span class="hljs-built_in">eval</span> = breast.iloc[<span class="hljs-number">469</span>:]<br><br>breast_1_train = train.iloc[:<span class="hljs-number">200</span>]<br><br>breast_1_train.to_csv(<span class="hljs-string">&#x27;breast_1_train.csv&#x27;</span>, index=<span class="hljs-literal">False</span>, header=<span class="hljs-literal">True</span>)<br><br>breast_2_train = train.iloc[<span class="hljs-number">200</span>:]<br><br>breast_2_train.to_csv(<span class="hljs-string">&#x27;breast_2_train.csv&#x27;</span>, index=<span class="hljs-literal">False</span>, header=<span class="hljs-literal">True</span>)<br><br><span class="hljs-built_in">eval</span>.to_csv(<span class="hljs-string">&#x27;breast_eval.csv&#x27;</span>, index=<span class="hljs-literal">False</span>, header=<span class="hljs-literal">True</span>)<br></code></pre></td></tr></table></figure>

<p><strong>注意：官方地址中的csv文件是有问题的，要运行这个切割数据集自己生成新的数据集文件</strong></p>
<h1 id="三、利用FATE构建横向联邦学习Pipeline"><a href="#三、利用FATE构建横向联邦学习Pipeline" class="headerlink" title="三、利用FATE构建横向联邦学习Pipeline"></a>三、利用FATE构建横向联邦学习Pipeline</h1><p>用FATE构建横向联邦学习Pipeline，涉及到三个方面的工作：</p>
<ul>
<li>数据转换输入<br>将数据文件（csv、txt）等转换成为FATE独有的基础数据结构DTable，从而方便进一步的操作，该操作可以使用<code>rz</code>命令完成。</li>
</ul>
<ul>
<li><p>模型训练<br>FATE以模型训练构建流水线pipeline</p>
</li>
<li><p>模型评估：（可选）<br>评估模型性能的手段</p>
</li>
</ul>
<p><strong>如果只使用框架自带的模型，那么其实我们需要修改的就是配置文件即可</strong></p>
<h2 id="3-1-数据转换输入"><a href="#3-1-数据转换输入" class="headerlink" title="3.1 数据转换输入"></a>3.1 数据转换输入</h2><p>新建一个项目目录<code>chapter05</code>（可自行修改）</p>
<p>将数据集放到该目录下的data目录中：</p>
<p>完成数据转换，需要一个配置文件和一个启动程序：</p>
<p>配置文件<br><code>upload_data.json</code>文件编写配置，内容为：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash">&#123;<br>  <span class="hljs-string">&quot;file&quot;</span>: <span class="hljs-string">&quot;data/breast_1_train.csv&quot;</span>,		// 数据文件路径，相对于当前所在路径<br>  <span class="hljs-string">&quot;head&quot;</span>: 1,								// 指定数据文件是否包含表头，1: 是，0: 否<br>  <span class="hljs-string">&quot;partition&quot;</span>: 16,							// 指定用于存储数据的分区数<br>  <span class="hljs-string">&quot;work_mode&quot;</span>: 0,							// 指定工作模式，0: 单机版，1: 集群版<br>  <span class="hljs-string">&quot;table_name&quot;</span>: <span class="hljs-string">&quot;homo_breast_1_train&quot;</span>,		// 需要转换为DTable格式的表名（相当于后续需要使用的表）<br>  <span class="hljs-string">&quot;namespace&quot;</span>: <span class="hljs-string">&quot;homo_host_breast_train&quot;</span>		// DTable格式的表名对应的命名空间<br>&#125;<br></code></pre></td></tr></table></figure>

<p>字段说明：</p>
<ul>
<li><p><strong>file：</strong> 数据文件路径，相对于当前所在路径</p>
</li>
<li><p><strong>head：</strong> 指定数据文件是否包含表头</p>
</li>
<li><p><strong>partition：</strong> 指定用于存储数据的分区数</p>
</li>
<li><p><strong>work_mode：</strong> 指定工作模式，0代表单机版，1代表集群版</p>
</li>
<li><p><strong>table_name：</strong>转换为<code>DTable</code>格式的表名</p>
</li>
<li><p><strong>namespace：</strong> <code>DTable</code>格式的表名对应的命名空间</p>
</li>
<li><p><strong>backend：</strong> 指定后端，0代表<code>EGGROLL</code>， 1代表<code>SPARK</code>加<code>RabbitMQ</code>， 2代表<code>SPARK加Pulsar</code> （暂时未用到）</p>
</li>
</ul>
<p><strong>fate-flow上传数据</strong></p>
<p>​        使用<code>fate-flow</code>上传数据。从FATE-1.5开始，推荐使用 <code>FATE-Flow Client Command Line</code> 执行FATE-Flow任务。</p>
<p>提示：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">&#123;                                                                                                                 <br>	<span class="hljs-string">&quot;retcode&quot;</span>: 100,                                                                                               <br>	<span class="hljs-string">&quot;retmsg&quot;</span>: <span class="hljs-string">&quot;Fate flow CLI has not been initialized yet or configured incorrectly. Please initialize it before using CLI at 	the first time. And make sure the address of fate flow server is configured correctly. The configuration file path is: /ai/xwj/federate_learning/fate_dir/standalone_fate_master_1.6.0/venv/lib/python3.6/site-packages/flow_client/settings.yaml.&quot;</span>                                                                                       <br>&#125;<br></code></pre></td></tr></table></figure>

<p>解决：<strong>先初始化flow</strong></p>
<p>​        使用flow首先要初始化一下：</p>
<p>​        <a target="_blank" rel="noopener" href="https://fate.readthedocs.io/en/latest/_build_temp/python/fate_client/flow_client/README_zh.html#init">flow init文档</a></p>
<p>​        Fate Flow 命令行初始化命令。用户可选择提供fate服务器配置文件路径或指定fate服务器ip地址及端口进行初始化。注意：若用户同时使用上述两种方式进行初始化，CLI将优先读取配置文件内容，而用户所配置的服务器ip地址及端口信息将被忽略。</p>
<p>​        因为之前init命令直接已经启动了flow，所以直接初始化即可</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">flow init --ip 127.0.0.1 --port 9380<br><br>&#123;<br>    <span class="hljs-string">&quot;retcode&quot;</span>: 0,<br>    <span class="hljs-string">&quot;retmsg&quot;</span>: <span class="hljs-string">&quot;Fate Flow CLI has been initialized successfully.&quot;</span><br>&#125;<br></code></pre></td></tr></table></figure>



<p>​        从FATE-1.5开始，推荐使用<code>FATE-Flow-Client Command Lin</code>e执行<code>FATE-Flow</code>任务，上传命令格式为：    </p>
<p>​        因为之前上传命令会自动将原始的本地文件转为DTable格式</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-attr">flow</span> <span class="hljs-string">data upload -c upload_data.json</span><br></code></pre></td></tr></table></figure>

<p>​        <strong>注意，新版本支持命令行直接使用</strong></p>
<p>​        或者，在FATE-1.6.0版本中，fate_flow的目录存放在<code>fateflow/python/</code>中，所以执行upload的过程和书中不一样，为：</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-attr">python</span> <span class="hljs-string">/fate/python/fate_flow/fate_flow_client.py -f upload -c upload_data.json</span><br></code></pre></td></tr></table></figure>



<p>​        如果提示没有flow命令，那么可能没有使用提供的conda环境，解决如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">source</span> bin/init_env.sh<br><br>&#123;<br>    <span class="hljs-string">&quot;data&quot;</span>: &#123;<br>        <span class="hljs-string">&quot;board_url&quot;</span>: <span class="hljs-string">&quot;http://127.0.0.1:8080/index.html#/dashboard?job_id=202108151639113656812&amp;role=local&amp;party_id=0&quot;</span>,<br>        <span class="hljs-string">&quot;job_dsl_path&quot;</span>: <span class="hljs-string">&quot;/home/jiangbo/FATE/standalone_fate_master_1.6.0/jobs/202108151639113656812/job_dsl.json&quot;</span>,<br>        <span class="hljs-string">&quot;job_id&quot;</span>: <span class="hljs-string">&quot;202108151639113656812&quot;</span>,<br>        <span class="hljs-string">&quot;job_runtime_conf_on_party_path&quot;</span>: <span class="hljs-string">&quot;/home/jiangbo/FATE/standalone_fate_master_1.6.0/jobs/202108151639113656812/local/job_runtime_on_party_conf.json&quot;</span>,<br>        <span class="hljs-string">&quot;job_runtime_conf_path&quot;</span>: <span class="hljs-string">&quot;/home/jiangbo/FATE/standalone_fate_master_1.6.0/jobs/202108151639113656812/job_runtime_conf.json&quot;</span>,<br>        <span class="hljs-string">&quot;logs_directory&quot;</span>: <span class="hljs-string">&quot;/home/jiangbo/FATE/standalone_fate_master_1.6.0/logs/202108151639113656812&quot;</span>,<br>        <span class="hljs-string">&quot;model_info&quot;</span>: &#123;<br>            <span class="hljs-string">&quot;model_id&quot;</span>: <span class="hljs-string">&quot;local-0#model&quot;</span>,<br>            <span class="hljs-string">&quot;model_version&quot;</span>: <span class="hljs-string">&quot;202108151639113656812&quot;</span><br>        &#125;,<br>        <span class="hljs-string">&quot;namespace&quot;</span>: <span class="hljs-string">&quot;homo_host_breast_train&quot;</span>,<br>        <span class="hljs-string">&quot;pipeline_dsl_path&quot;</span>: <span class="hljs-string">&quot;/home/jiangbo/FATE/standalone_fate_master_1.6.0/jobs/202108151639113656812/pipeline_dsl.json&quot;</span>,<br>        <span class="hljs-string">&quot;table_name&quot;</span>: <span class="hljs-string">&quot;homo_breast_1_train&quot;</span>,<br>        <span class="hljs-string">&quot;train_runtime_conf_path&quot;</span>: <span class="hljs-string">&quot;/home/jiangbo/FATE/standalone_fate_master_1.6.0/jobs/202108151639113656812/train_runtime_conf.json&quot;</span><br>    &#125;,<br>    <span class="hljs-string">&quot;jobId&quot;</span>: <span class="hljs-string">&quot;202108151639113656812&quot;</span>,<br>    <span class="hljs-string">&quot;retcode&quot;</span>: 0,<br>    <span class="hljs-string">&quot;retmsg&quot;</span>: <span class="hljs-string">&quot;success&quot;</span><br>&#125;<br></code></pre></td></tr></table></figure>

<p>访问<code>board_url</code>可以在浏览器中看到对应的详情;</p>
<p>对于breast_2_train.csv以及测试集合同样的过程：</p>
<p>测试集上传到两个参与方，并各自转换为DTable格式</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs bash">&#123;<br>  <span class="hljs-string">&quot;file&quot;</span>: <span class="hljs-string">&quot;data/breast_2_train.csv&quot;</span>,<br>  <span class="hljs-string">&quot;head&quot;</span>: 1,<br>  <span class="hljs-string">&quot;partition&quot;</span>: 16,<br>  <span class="hljs-string">&quot;work_mode&quot;</span>: 0,<br>  <span class="hljs-string">&quot;table_name&quot;</span>: <span class="hljs-string">&quot;homo_breast_2_train&quot;</span>,<br>  <span class="hljs-string">&quot;namespace&quot;</span>: <span class="hljs-string">&quot;homo_guest_breast_train&quot;</span><br>&#125;<br><br>// host<br>&#123;<br>  <span class="hljs-string">&quot;file&quot;</span>: <span class="hljs-string">&quot;data/breast_eval.csv&quot;</span>,<br>  <span class="hljs-string">&quot;head&quot;</span>: 1,<br>  <span class="hljs-string">&quot;partition&quot;</span>: 16,<br>  <span class="hljs-string">&quot;work_mode&quot;</span>: 0,<br>  <span class="hljs-string">&quot;table_name&quot;</span>: <span class="hljs-string">&quot;homo_breast_1_train&quot;</span>,<br>  <span class="hljs-string">&quot;namespace&quot;</span>: <span class="hljs-string">&quot;homo_host_breast_eval&quot;</span><br>&#125;<br><br>// guest<br>&#123;<br>  <span class="hljs-string">&quot;file&quot;</span>: <span class="hljs-string">&quot;data/breast_eval.csv&quot;</span>,<br>  <span class="hljs-string">&quot;head&quot;</span>: 1,<br>  <span class="hljs-string">&quot;partition&quot;</span>: 16,<br>  <span class="hljs-string">&quot;work_mode&quot;</span>: 0,<br>  <span class="hljs-string">&quot;table_name&quot;</span>: <span class="hljs-string">&quot;homo_breast_2_train&quot;</span>,<br>  <span class="hljs-string">&quot;namespace&quot;</span>: <span class="hljs-string">&quot;homo_guest_breast_eval&quot;</span><br>&#125;<br></code></pre></td></tr></table></figure>

<p>通常，只需要修改<code> file、table_name、name_space</code> 即可。</p>
<p>这里的4个数据集分别代表 host 和 guest 的训练、验证数据集。</p>
<p><strong>验证</strong><br>查询任务情况</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-attr">flow</span> <span class="hljs-string">job query</span><br></code></pre></td></tr></table></figure>

<p>返回以下即可：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">&#123;<br>    <span class="hljs-string">&quot;data&quot;</span>: [],<br>    <span class="hljs-string">&quot;retcode&quot;</span>: 0,<br>    <span class="hljs-string">&quot;retmsg&quot;</span>: <span class="hljs-string">&quot;no job could be found&quot;</span><br>&#125;<br></code></pre></td></tr></table></figure>



<h2 id="3-2-模型训练"><a href="#3-2-模型训练" class="headerlink" title="3.2 模型训练"></a>3.2 模型训练</h2><p>FATE构建联邦学习模型有两种不同编程范式。</p>
<ul>
<li>组件化配置：模型训练拆分为不同的任务，每个任务以组建的形式通过有向无环图相连，联邦学习所需的配置参数在配置文件中定义。该模式中，用户只需自定义和提交配置文件，就可以直接执行联邦训练。</li>
<li>脚本编程：FATE提供API接口，用户通过脚本编程的方式实现联邦模型，类似直接使用Python编程。</li>
</ul>
<p>由于脚本编程不够稳定，这里只使用组件化配置阐述。组件化配置需要提供两个配置文件。</p>
<ul>
<li>dsl配置文件：FATE内置的一套自定义领域特定语言，在dsl中，常见的机器学习任务划分为不同的模块，如数据读写、模型训练、模型评估可以通过一个有向无环图连接。</li>
<li>conf配置文件：设置dsl中组件模块的参数。</li>
</ul>
<p>利用FATE组件化配置的优点：</p>
<ul>
<li>提供多种安全策略机制；</li>
<li>部署简单方便；</li>
<li>提供可视化界面；</li>
<li>支持常用的机器学习算法。</li>
</ul>
<p>​        借助FATE，我们可以使用组件的方式来构建联邦学习，而不需要用户从新开始编码，FATE构建联邦学习Pipeline是通过自定义dsl和conf两个配置文件来实现：</p>
<p>​        <a target="_blank" rel="noopener" href="https://fate.readthedocs.io/en/latest/_build_temp/doc/dsl_conf_v1_setting_guide_zh.html">DSL 配置和运行配置 V1</a></p>
<ul>
<li>dsl文件：用来描述任务模块，将任务模块以有向无环图（DAG）的形式组合在一起。</li>
<li>conf文件：设置各个组件的参数，比如输入模块的数据表名；算法模块的学习率、batch大小、迭代次数等。<br>我们本实验使用的是模型：<strong>逻辑回归</strong></li>
</ul>
<p>进入<code>examples/dsl/v1/homo_logistic_regression</code>文件夹中：</p>
<p>使用<code>test_homolr_train_job_dsl.json、test_homolr_train_job_conf.json</code>两个文件来辅助构建横向联邦学习模型</p>
<h3 id="3-2-1-DSL配置文件"><a href="#3-2-1-DSL配置文件" class="headerlink" title="3.2.1 DSL配置文件"></a>3.2.1 DSL配置文件</h3><p>​        为了让任务模型的构建更加灵活，目前 FATE 使用了一套自定的领域特定语言 (DSL) 来描述任务。在 DSL 中，各种任务模块（例如数据读写 data_io，特征工程 feature-engineering， 回归 regression，分类 classification）可以通向一个有向无环图 （DAG） 组织起来。通过各种方式，用户可以根据自身的需要，灵活地组合各种算法模块。</p>
<p>​        DSL 的配置文件采用 json 格式，实际上，整个配置文件就是一个 json 对象 （dict）。在这个 dict 的第一级是 “components”，用来表示这个任务将会使用到的各个模块。用户需要使用模块名加数字 _num 作为对应模块的 key，例如 dataio_0，并且数字应从 0 开始计数。</p>
<p>具体的参数见官方文档连接（上面）</p>
<p><code>test_homolr_train_job_dsl.json</code>:</p>
<p>定义了四个模块已经构成了基本的联邦学习流水线（feature_scale_0为1.6.0新增），可直接使用(复制一份)</p>
<p>// 数据IO组件，用于将本地数据转为DTable</p>
<p>// 特征工程模块</p>
<p>// 横向逻辑回归组件</p>
<p>// 模型评估组件，如果未提供测试数据集则自动使用训练集</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><code class="hljs bash">&#123;<br>    <span class="hljs-string">&quot;components&quot;</span>: &#123;<br>        <span class="hljs-string">&quot;reader_0&quot;</span>: &#123;<br>            <span class="hljs-string">&quot;module&quot;</span>: <span class="hljs-string">&quot;Reader&quot;</span>,<br>            <span class="hljs-string">&quot;output&quot;</span>: &#123;<br>                <span class="hljs-string">&quot;data&quot;</span>: [<span class="hljs-string">&quot;data&quot;</span>]<br>            &#125;<br>        &#125;,<br>        <span class="hljs-string">&quot;dataio_0&quot;</span>: &#123;<br>            <span class="hljs-string">&quot;module&quot;</span>: <span class="hljs-string">&quot;DataIO&quot;</span>,<br>            <span class="hljs-string">&quot;input&quot;</span>: &#123;<br>                <span class="hljs-string">&quot;data&quot;</span>: &#123;<br>                    <span class="hljs-string">&quot;data&quot;</span>: [<span class="hljs-string">&quot;reader_0.data&quot;</span>]<br>                &#125;<br>            &#125;,<br>            <span class="hljs-string">&quot;output&quot;</span>: &#123;<br>                <span class="hljs-string">&quot;data&quot;</span>: [<span class="hljs-string">&quot;data&quot;</span>],<br>                <span class="hljs-string">&quot;model&quot;</span>: [<span class="hljs-string">&quot;model&quot;</span>]<br>            &#125;<br>        &#125;,<br>        <span class="hljs-string">&quot;scale_0&quot;</span>: &#123;<br>            <span class="hljs-string">&quot;module&quot;</span>: <span class="hljs-string">&quot;FeatureScale&quot;</span>,<br>            <span class="hljs-string">&quot;input&quot;</span>: &#123;<br>                <span class="hljs-string">&quot;data&quot;</span>: &#123;<br>                    <span class="hljs-string">&quot;data&quot;</span>: [<span class="hljs-string">&quot;dataio_0.data&quot;</span>]<br>                &#125;<br>            &#125;,<br>            <span class="hljs-string">&quot;output&quot;</span>: &#123;<br>                <span class="hljs-string">&quot;data&quot;</span>: [<span class="hljs-string">&quot;data&quot;</span>],<br>                <span class="hljs-string">&quot;model&quot;</span>: [<span class="hljs-string">&quot;model&quot;</span>]<br>            &#125;<br>        &#125;,<br>        <span class="hljs-string">&quot;homo_lr_0&quot;</span>: &#123;<br>            <span class="hljs-string">&quot;module&quot;</span>: <span class="hljs-string">&quot;HomoLR&quot;</span>,<br>            <span class="hljs-string">&quot;input&quot;</span>: &#123;<br>                <span class="hljs-string">&quot;data&quot;</span>: &#123;<br>                    <span class="hljs-string">&quot;train_data&quot;</span>: [<span class="hljs-string">&quot;scale_0.data&quot;</span>]<br>                &#125;<br>            &#125;,<br>            <span class="hljs-string">&quot;output&quot;</span>: &#123;<br>                <span class="hljs-string">&quot;data&quot;</span>: [<span class="hljs-string">&quot;data&quot;</span>],<br>                <span class="hljs-string">&quot;model&quot;</span>: [<span class="hljs-string">&quot;model&quot;</span>]<br>            &#125;<br>        &#125;,<br>        <span class="hljs-string">&quot;evaluation_0&quot;</span>: &#123;<br>            <span class="hljs-string">&quot;module&quot;</span>: <span class="hljs-string">&quot;Evaluation&quot;</span>,<br>            <span class="hljs-string">&quot;input&quot;</span>: &#123;<br>                <span class="hljs-string">&quot;data&quot;</span>: &#123;<br>                    <span class="hljs-string">&quot;data&quot;</span>: [<span class="hljs-string">&quot;homo_lr_0.data&quot;</span>]<br>                &#125;<br>            &#125;,<br>            <span class="hljs-string">&quot;output&quot;</span>: &#123;<br>                <span class="hljs-string">&quot;data&quot;</span>: [<span class="hljs-string">&quot;data&quot;</span>]<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>

<p>这里的<code>args.train_data</code>是根据下面的运行配置<code>conf</code>来的</p>
<p>其次配置文件之间的指定关系如下：</p>
<p><img data-fancybox="gallery" data-sizes="auto" data-src="FATE%E4%BB%8E%E9%9B%B6%E5%AE%9E%E7%8E%B0%E6%A8%AA%E5%90%91%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92.assets/image-20220606114621536.png" alt="image-20220606114621536" class="lazyload"></p>
<h3 id="3-2-2-运行配置-Submit-Runtime-Conf"><a href="#3-2-2-运行配置-Submit-Runtime-Conf" class="headerlink" title="3.2.2 运行配置 Submit Runtime Conf"></a>3.2.2 运行配置 Submit Runtime Conf</h3><p>每个模块都有不同的参数需要配置，不同的 party 对于同一个模块的参数也可能有所区别。为了简化这种情况，对于每一个模块，FATE 会将所有 party 的不同参数保存到同一个运行配置文件（<code>Submit Runtime Conf</code>）中，并且所有的 party 都将共用这个配置文件。</p>
<p>除了 DSL 的配置文件之外，用户还需要准备一份运行配置（<code>Submit Runtime Conf</code>）用于设置各个组件的参数。</p>
<p><code>test_homolr_train_job_conf.json</code> 修改如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><code class="hljs bash">&#123;	<br>	<span class="hljs-string">&quot;dsl_version&quot;</span>: 2,<br>  	// 创始人<br>    <span class="hljs-string">&quot;initiator&quot;</span>: &#123;<br>        <span class="hljs-string">&quot;role&quot;</span>: <span class="hljs-string">&quot;guest&quot;</span>,<br>        <span class="hljs-string">&quot;party_id&quot;</span>: 10000<br>    &#125;,<br>  	// 所有参与此任务的角色<br>  	// 每一个元素代表一种角色以及承担这个角色的party_id，是一个列表表示同一角色可能有多个实体ID<br>    <span class="hljs-string">&quot;role&quot;</span>: &#123;<br>        <span class="hljs-string">&quot;guest&quot;</span>: [<br>            10000<br>        ],<br>        <span class="hljs-string">&quot;host&quot;</span>: [<br>            10000<br>        ],<br>      	// 仲裁者<br>        <span class="hljs-string">&quot;arbiter&quot;</span>: [<br>            10000<br>        ]<br>    &#125;,<br>     <span class="hljs-string">&quot;job_parameters&quot;</span>: &#123;<br>        <span class="hljs-string">&quot;common&quot;</span>: &#123;<br>            <span class="hljs-string">&quot;job_type&quot;</span>: <span class="hljs-string">&quot;train&quot;</span>,<br>            <span class="hljs-string">&quot;backend&quot;</span>: 0,<br>            <span class="hljs-string">&quot;work_mode&quot;</span>: 0			// 0代表单机版，1代表集群版<br>        &#125;<br>    &#125;,<br>  	// 设置模型训练的超参数信息<br>    <span class="hljs-string">&quot;component_parameters&quot;</span>: &#123;<br>        <span class="hljs-string">&quot;common&quot;</span>: &#123;<br>            <span class="hljs-string">&quot;dataio_0&quot;</span>: &#123;<br>                <span class="hljs-string">&quot;with_label&quot;</span>: <span class="hljs-literal">true</span>,<br>                <span class="hljs-string">&quot;label_name&quot;</span>: <span class="hljs-string">&quot;y&quot;</span>, <br>                <span class="hljs-string">&quot;label_type&quot;</span>: <span class="hljs-string">&quot;int&quot;</span>,<br>                <span class="hljs-string">&quot;output_format&quot;</span>: <span class="hljs-string">&quot;dense&quot;</span><br>            &#125;,<br>            <span class="hljs-string">&quot;homo_lr_0&quot;</span>: &#123;<br>                <span class="hljs-string">&quot;penalty&quot;</span>: <span class="hljs-string">&quot;L2&quot;</span>,<br>                <span class="hljs-string">&quot;tol&quot;</span>: 1e-05,<br>                <span class="hljs-string">&quot;alpha&quot;</span>: 0.01,<br>                <span class="hljs-string">&quot;optimizer&quot;</span>: <span class="hljs-string">&quot;sgd&quot;</span>,<br>                <span class="hljs-string">&quot;batch_size&quot;</span>: -1,<br>                <span class="hljs-string">&quot;learning_rate&quot;</span>: 0.015,<br>                <span class="hljs-string">&quot;init_param&quot;</span>: &#123;<br>                    <span class="hljs-string">&quot;init_method&quot;</span>: <span class="hljs-string">&quot;zeros&quot;</span><br>                &#125;,<br>                <span class="hljs-string">&quot;max_iter&quot;</span>: 10,<br>                <span class="hljs-string">&quot;early_stop&quot;</span>: <span class="hljs-string">&quot;diff&quot;</span>,<br>                <span class="hljs-string">&quot;encrypt_param&quot;</span>: &#123;<br>                    <span class="hljs-string">&quot;method&quot;</span>: null<br>                &#125;,<br>                <span class="hljs-string">&quot;cv_param&quot;</span>: &#123;<br>                    <span class="hljs-string">&quot;n_splits&quot;</span>: 4,<br>                    <span class="hljs-string">&quot;shuffle&quot;</span>: <span class="hljs-literal">true</span>,<br>                    <span class="hljs-string">&quot;random_seed&quot;</span>: 33,<br>                    <span class="hljs-string">&quot;need_cv&quot;</span>: <span class="hljs-literal">false</span><br>                &#125;,<br>                <span class="hljs-string">&quot;decay&quot;</span>: 1,<br>                <span class="hljs-string">&quot;decay_sqrt&quot;</span>: <span class="hljs-literal">true</span><br>            &#125;,<br>            <span class="hljs-string">&quot;evaluation_0&quot;</span>: &#123;<br>                <span class="hljs-string">&quot;eval_type&quot;</span>: <span class="hljs-string">&quot;binary&quot;</span><br>            &#125;<br>        &#125;,<br>        <span class="hljs-string">&quot;role&quot;</span>: &#123;<br>            <span class="hljs-string">&quot;host&quot;</span>: &#123;<br>                <span class="hljs-string">&quot;0&quot;</span>: &#123;<br>                    <span class="hljs-string">&quot;reader_0&quot;</span>: &#123;<br>                        <span class="hljs-string">&quot;table&quot;</span>: &#123;<br>                            <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;homo_breast_1_train&quot;</span>, // 修改DTable的表名，对应上传数据时配置文件的内容<br>                            <span class="hljs-string">&quot;namespace&quot;</span>: <span class="hljs-string">&quot;homo_host_breast_train&quot;</span> // 修改命名空间，对应上传数据时配置文件的内容<br>                        &#125;<br>                    &#125;,<br>                    <span class="hljs-string">&quot;evaluation_0&quot;</span>: &#123;<span class="hljs-string">&quot;need_run&quot;</span>: <span class="hljs-literal">false</span>&#125;<br>                &#125;<br>            &#125;,<br>            <span class="hljs-string">&quot;guest&quot;</span>: &#123;<br>                <span class="hljs-string">&quot;0&quot;</span>: &#123;<br>                    <span class="hljs-string">&quot;reader_0&quot;</span>: &#123;<br>                        <span class="hljs-string">&quot;table&quot;</span>: &#123;<br>                            <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;homo_breast_2_train&quot;</span>, // 修改DTable的表名，对应上传数据时配置文件的内容<br>                            <span class="hljs-string">&quot;namespace&quot;</span>: <span class="hljs-string">&quot;homo_guest_breast_train&quot;</span> // 修改命名空间，对应上传数据时配置文件的内容<br>                        &#125;<br>                    &#125;<br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p><strong>关于角色，解释如下：</strong></p>
<ul>
<li><strong>arbite</strong>r是用来辅助多方完成联合建模的，它的主要作用是聚合梯度或者模型。比如纵向lr里面，各方将自己一半的梯度发送给arbiter，然后arbiter再联合优化等等。</li>
<li><strong>guest</strong>代表数据应用方。</li>
<li><strong>host</strong>是数据提供方。</li>
<li><strong>local</strong>是指本地任务, 该角色仅用于upload和download阶段中。</li>
</ul>
<h3 id="3-2-3-提交参数，训练模型"><a href="#3-2-3-提交参数，训练模型" class="headerlink" title="3.2.3 提交参数，训练模型"></a>3.2.3 提交参数，训练模型</h3><p><code>Job submit</code></p>
<ul>
<li>介绍： 提交执行pipeline任务。</li>
<li>参数：</li>
</ul>
<table>
<thead>
<tr>
<th>编号</th>
<th>参数</th>
<th>Flag_1</th>
<th>Flag_2</th>
<th>必要参数</th>
<th>参数介绍</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>conf_path</td>
<td>-c</td>
<td>–conf-path</td>
<td>是</td>
<td>任务配置文件路径</td>
</tr>
<tr>
<td>2</td>
<td>dsl_path</td>
<td>-d</td>
<td>–dsl-path</td>
<td>否</td>
<td>DSL文件路径. 如果任务为预测任务，该字段可以不输入。另外，用户可以提供可用的自定义DSL文件用于执行预测任务。</td>
</tr>
</tbody></table>
<p>执行pipeline任务：</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-attr">flow</span> <span class="hljs-string">job submit -c test_homolr_train_job_conf.json -d test_homolr_train_job_dsl.json</span><br></code></pre></td></tr></table></figure>

<h2 id="3-3-评估模型"><a href="#3-3-评估模型" class="headerlink" title="3.3 评估模型"></a>3.3 评估模型</h2><p>为了评估模型的效果，我们重新修改配置以检查效果：</p>
<p>在上传数据时，我们已经将两个评估模型的数据上传，并且转换为DTable格式</p>
<p>现在我们修改<code>dsl</code>配置文件:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><code class="hljs bash">&#123;<br>    <span class="hljs-string">&quot;components&quot;</span>: &#123;<br>        <span class="hljs-string">&quot;reader_0&quot;</span>: &#123;<br>            <span class="hljs-string">&quot;module&quot;</span>: <span class="hljs-string">&quot;Reader&quot;</span>,<br>            <span class="hljs-string">&quot;output&quot;</span>: &#123;<br>                <span class="hljs-string">&quot;data&quot;</span>: [<span class="hljs-string">&quot;data&quot;</span>]<br>            &#125;<br>        &#125;,<br>        <span class="hljs-string">&quot;reader_1&quot;</span>: &#123;<br>            <span class="hljs-string">&quot;module&quot;</span>: <span class="hljs-string">&quot;Reader&quot;</span>,<br>            <span class="hljs-string">&quot;output&quot;</span>: &#123;<br>                <span class="hljs-string">&quot;data&quot;</span>: [<span class="hljs-string">&quot;data&quot;</span>]<br>            &#125;<br>        &#125;,<br>        <span class="hljs-string">&quot;dataio_0&quot;</span>: &#123;<br>            <span class="hljs-string">&quot;module&quot;</span>: <span class="hljs-string">&quot;DataIO&quot;</span>,<br>            <span class="hljs-string">&quot;input&quot;</span>: &#123;<br>                <span class="hljs-string">&quot;data&quot;</span>: &#123;<br>                    <span class="hljs-string">&quot;data&quot;</span>: [<span class="hljs-string">&quot;reader_0.data&quot;</span>]<br>                &#125;<br>            &#125;,<br>            <span class="hljs-string">&quot;output&quot;</span>: &#123;<br>                <span class="hljs-string">&quot;data&quot;</span>: [<span class="hljs-string">&quot;data&quot;</span>],<br>                <span class="hljs-string">&quot;model&quot;</span>: [<span class="hljs-string">&quot;model&quot;</span>]<br>            &#125;<br>        &#125;,<br>        <span class="hljs-string">&quot;dataio_1&quot;</span>: &#123;<br>            <span class="hljs-string">&quot;module&quot;</span>: <span class="hljs-string">&quot;DataIO&quot;</span>,<br>            <span class="hljs-string">&quot;input&quot;</span>: &#123;<br>                <span class="hljs-string">&quot;data&quot;</span>: &#123;<br>                    <span class="hljs-string">&quot;data&quot;</span>: [<span class="hljs-string">&quot;reader_1.data&quot;</span>]<br>                &#125;,<br>                <span class="hljs-string">&quot;model&quot;</span>: [<span class="hljs-string">&quot;dataio_0.model&quot;</span>]<br>            &#125;,<br>            <span class="hljs-string">&quot;output&quot;</span>: &#123;<br>                <span class="hljs-string">&quot;data&quot;</span>: [<span class="hljs-string">&quot;data&quot;</span>],<br>                <span class="hljs-string">&quot;model&quot;</span>: [<span class="hljs-string">&quot;model&quot;</span>]<br>            &#125;<br>        &#125;,<br>        <span class="hljs-string">&quot;scale_0&quot;</span>: &#123;<br>            <span class="hljs-string">&quot;module&quot;</span>: <span class="hljs-string">&quot;FeatureScale&quot;</span>,<br>            <span class="hljs-string">&quot;input&quot;</span>: &#123;<br>                <span class="hljs-string">&quot;data&quot;</span>: &#123;<br>                    <span class="hljs-string">&quot;data&quot;</span>: [<span class="hljs-string">&quot;dataio_0.data&quot;</span>]<br>                &#125;<br>            &#125;,<br>            <span class="hljs-string">&quot;output&quot;</span>: &#123;<br>                <span class="hljs-string">&quot;data&quot;</span>: [<span class="hljs-string">&quot;data&quot;</span>],<br>                <span class="hljs-string">&quot;model&quot;</span>: [<span class="hljs-string">&quot;model&quot;</span>]<br>            &#125;<br>        &#125;,<br>        <span class="hljs-string">&quot;scale_1&quot;</span>: &#123;<br>            <span class="hljs-string">&quot;module&quot;</span>: <span class="hljs-string">&quot;FeatureScale&quot;</span>,<br>            <span class="hljs-string">&quot;input&quot;</span>: &#123;<br>                <span class="hljs-string">&quot;data&quot;</span>: &#123;<br>                    <span class="hljs-string">&quot;data&quot;</span>: [<span class="hljs-string">&quot;dataio_1.data&quot;</span>]<br>                &#125;,<br>                <span class="hljs-string">&quot;model&quot;</span>: [<span class="hljs-string">&quot;scale_0.model&quot;</span>]<br>            &#125;,<br>            <span class="hljs-string">&quot;output&quot;</span>: &#123;<br>                <span class="hljs-string">&quot;data&quot;</span>: [<span class="hljs-string">&quot;data&quot;</span>],<br>                <span class="hljs-string">&quot;model&quot;</span>: [<span class="hljs-string">&quot;model&quot;</span>]<br>            &#125;<br>        &#125;,<br>        <span class="hljs-string">&quot;homo_lr_0&quot;</span>: &#123;<br>            <span class="hljs-string">&quot;module&quot;</span>: <span class="hljs-string">&quot;HomoLR&quot;</span>,<br>            <span class="hljs-string">&quot;input&quot;</span>: &#123;<br>                <span class="hljs-string">&quot;data&quot;</span>: &#123;<br>                    <span class="hljs-string">&quot;train_data&quot;</span>: [<span class="hljs-string">&quot;scale_0.data&quot;</span>],<br>                    <span class="hljs-string">&quot;validate_data&quot;</span>: [<span class="hljs-string">&quot;scale_1.data&quot;</span>]<br>                &#125;<br>            &#125;,<br>            <span class="hljs-string">&quot;output&quot;</span>: &#123;<br>                <span class="hljs-string">&quot;data&quot;</span>: [<span class="hljs-string">&quot;data&quot;</span>],<br>                <span class="hljs-string">&quot;model&quot;</span>: [<span class="hljs-string">&quot;model&quot;</span>]<br>            &#125;<br>        &#125;,<br>        <span class="hljs-string">&quot;evaluation_0&quot;</span>: &#123;<br>            <span class="hljs-string">&quot;module&quot;</span>: <span class="hljs-string">&quot;Evaluation&quot;</span>,<br>            <span class="hljs-string">&quot;input&quot;</span>: &#123;<br>                <span class="hljs-string">&quot;data&quot;</span>: &#123;<br>                    <span class="hljs-string">&quot;data&quot;</span>: [<span class="hljs-string">&quot;homo_lr_0.data&quot;</span>]<br>                &#125;<br>            &#125;,<br>            <span class="hljs-string">&quot;output&quot;</span>: &#123;<br>                <span class="hljs-string">&quot;data&quot;</span>: [<span class="hljs-string">&quot;data&quot;</span>]<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>



<p>修改<code>conf</code>文件：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><code class="hljs bash">&#123;<br>    <span class="hljs-string">&quot;dsl_version&quot;</span>: 2,<br>    <span class="hljs-string">&quot;initiator&quot;</span>: &#123;<br>        <span class="hljs-string">&quot;role&quot;</span>: <span class="hljs-string">&quot;guest&quot;</span>,<br>        <span class="hljs-string">&quot;party_id&quot;</span>: 10000<br>    &#125;,<br>    <span class="hljs-string">&quot;role&quot;</span>: &#123;<br>        <span class="hljs-string">&quot;guest&quot;</span>: [10000],<br>        <span class="hljs-string">&quot;host&quot;</span>: [10000],<br>        <span class="hljs-string">&quot;arbiter&quot;</span>: [10000]<br>    &#125;,<br>    <span class="hljs-string">&quot;job_parameters&quot;</span>: &#123;<br>        <span class="hljs-string">&quot;common&quot;</span>: &#123;<br>            <span class="hljs-string">&quot;job_type&quot;</span>: <span class="hljs-string">&quot;train&quot;</span>,<br>            <span class="hljs-string">&quot;backend&quot;</span>: 0,<br>            <span class="hljs-string">&quot;work_mode&quot;</span>: 0<br>        &#125;<br>    &#125;,<br>    <span class="hljs-string">&quot;component_parameters&quot;</span>: &#123;<br>        <span class="hljs-string">&quot;common&quot;</span>: &#123;<br>            <span class="hljs-string">&quot;dataio_0&quot;</span>: &#123;<br>                <span class="hljs-string">&quot;with_label&quot;</span>: <span class="hljs-literal">true</span>,<br>                <span class="hljs-string">&quot;label_name&quot;</span>: <span class="hljs-string">&quot;y&quot;</span>,<br>                <span class="hljs-string">&quot;label_type&quot;</span>: <span class="hljs-string">&quot;int&quot;</span>,<br>                <span class="hljs-string">&quot;output_format&quot;</span>: <span class="hljs-string">&quot;dense&quot;</span><br>            &#125;,<br>            <span class="hljs-string">&quot;homo_lr_0&quot;</span>: &#123;<br>                <span class="hljs-string">&quot;penalty&quot;</span>: <span class="hljs-string">&quot;L2&quot;</span>,<br>                <span class="hljs-string">&quot;tol&quot;</span>: 1e-05,<br>                <span class="hljs-string">&quot;alpha&quot;</span>: 0.01,<br>                <span class="hljs-string">&quot;optimizer&quot;</span>: <span class="hljs-string">&quot;sgd&quot;</span>,<br>                <span class="hljs-string">&quot;batch_size&quot;</span>: -1,<br>                <span class="hljs-string">&quot;learning_rate&quot;</span>: 0.15,<br>                <span class="hljs-string">&quot;init_param&quot;</span>: &#123;<br>                    <span class="hljs-string">&quot;init_method&quot;</span>: <span class="hljs-string">&quot;zeros&quot;</span><br>                &#125;,<br>                <span class="hljs-string">&quot;encrypt_param&quot;</span>: &#123;<br>                    <span class="hljs-string">&quot;method&quot;</span>: null<br>                &#125;,<br>                <span class="hljs-string">&quot;max_iter&quot;</span>: 10,<br>                <span class="hljs-string">&quot;early_stop&quot;</span>: <span class="hljs-string">&quot;diff&quot;</span>,<br>                <span class="hljs-string">&quot;cv_param&quot;</span>: &#123;<br>                    <span class="hljs-string">&quot;n_splits&quot;</span>: 4,<br>                    <span class="hljs-string">&quot;shuffle&quot;</span>: <span class="hljs-literal">true</span>,<br>                    <span class="hljs-string">&quot;random_seed&quot;</span>: 33,<br>                    <span class="hljs-string">&quot;need_cv&quot;</span>: <span class="hljs-literal">false</span><br>                &#125;,<br>                <span class="hljs-string">&quot;validation_freqs&quot;</span>: 1<br>            &#125;,<br>            <span class="hljs-string">&quot;evaluation_0&quot;</span>: &#123;<br>                <span class="hljs-string">&quot;eval_type&quot;</span>: <span class="hljs-string">&quot;binary&quot;</span><br>            &#125;<br>        &#125;,<br>        <span class="hljs-string">&quot;role&quot;</span>: &#123;<br>            <span class="hljs-string">&quot;host&quot;</span>: &#123;<br>                <span class="hljs-string">&quot;0&quot;</span>: &#123;<br>                    <span class="hljs-string">&quot;evaluation_0&quot;</span>: &#123;<span class="hljs-string">&quot;need_run&quot;</span>: <span class="hljs-literal">false</span>&#125;,<br>                    <span class="hljs-string">&quot;reader_1&quot;</span>: &#123;<br>                        <span class="hljs-string">&quot;table&quot;</span>: &#123;<br>                            <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;homo_breast_1_eval&quot;</span>,<br>                            <span class="hljs-string">&quot;namespace&quot;</span>: <span class="hljs-string">&quot;homo_host_breast_eval&quot;</span><br>                        &#125;<br>                    &#125;,<br>                    <span class="hljs-string">&quot;reader_0&quot;</span>: &#123;<br>                        <span class="hljs-string">&quot;table&quot;</span>: &#123;<br>                            <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;homo_breast_1_train&quot;</span>,<br>                            <span class="hljs-string">&quot;namespace&quot;</span>: <span class="hljs-string">&quot;homo_host_breast_train&quot;</span><br>                        &#125;<br>                    &#125;<br>                &#125;<br>            &#125;,<br>            <span class="hljs-string">&quot;guest&quot;</span>: &#123;<br>                <span class="hljs-string">&quot;0&quot;</span>: &#123;<br>                    <span class="hljs-string">&quot;reader_1&quot;</span>: &#123;<br>                        <span class="hljs-string">&quot;table&quot;</span>: &#123;<br>                            <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;homo_breast_2_eval&quot;</span>,<br>                            <span class="hljs-string">&quot;namespace&quot;</span>: <span class="hljs-string">&quot;homo_guest_breast_eval&quot;</span><br>                        &#125;<br>                    &#125;,<br>                    <span class="hljs-string">&quot;reader_0&quot;</span>: &#123;<br>                        <span class="hljs-string">&quot;table&quot;</span>: &#123;<br>                            <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;homo_breast_2_train&quot;</span>,<br>                            <span class="hljs-string">&quot;namespace&quot;</span>: <span class="hljs-string">&quot;homo_guest_breast_train&quot;</span><br>                        &#125;<br>                    &#125;<br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>



<p>重新提交任务，查看结果：</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-attr">flow</span> <span class="hljs-string">job submit -c test_homolr_train_job_conf.json -d test_homolr_train_job_dsl.json</span><br></code></pre></td></tr></table></figure>

<p><img data-fancybox="gallery" data-sizes="auto" data-src="FATE%E4%BB%8E%E9%9B%B6%E5%AE%9E%E7%8E%B0%E6%A8%AA%E5%90%91%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92.assets/image-20220603105626741.png" alt="image-20220603105626741" class="lazyload"></p>
<p>DAG图：</p>
<p><img data-fancybox="gallery" data-sizes="auto" data-src="FATE%E4%BB%8E%E9%9B%B6%E5%AE%9E%E7%8E%B0%E6%A8%AA%E5%90%91%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92.assets/image-20220603100020589.png" alt="image-20220603100020589" class="lazyload"></p>
<h2 id="3-4-多参与方环境配置"><a href="#3-4-多参与方环境配置" class="headerlink" title="3.4 多参与方环境配置"></a>3.4 多参与方环境配置</h2><p>上面的方案中有两个参与角色：</p>
<ul>
<li>guest代表数据应用方。</li>
<li>host是数据提供方。</li>
</ul>
<p>下面考虑更多的客户端参与，修改<code>conf</code>文件中的role添加更多的参与方：</p>
<p>（这里为了方便起见，就不再对数据集根据不同的host进行进一步的划分，测试集也是如此）</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><code class="hljs bash">&#123;		<br>    <span class="hljs-string">&quot;initiator&quot;</span>: &#123;<br>        <span class="hljs-string">&quot;role&quot;</span>: <span class="hljs-string">&quot;guest&quot;</span>,<br>        <span class="hljs-string">&quot;party_id&quot;</span>: 10000<br>    &#125;,<br>    <span class="hljs-string">&quot;job_parameters&quot;</span>: &#123;<br>        <span class="hljs-string">&quot;work_mode&quot;</span>: 0	<br>    &#125;,<br>    <span class="hljs-string">&quot;role&quot;</span>: &#123;<br>        <span class="hljs-string">&quot;guest&quot;</span>: [<br>            10000<br>        ],<br>        <span class="hljs-string">&quot;host&quot;</span>: [<br>            10000, 10001, 10002					// 新建两个Host<br>        ],<br>        <span class="hljs-string">&quot;arbiter&quot;</span>: [<br>            10000<br>        ]<br>    &#125;,<br>    <span class="hljs-string">&quot;role_parameters&quot;</span>: &#123;<br>        <span class="hljs-string">&quot;guest&quot;</span>: &#123;<br>            ...<br>        &#125;,<br>        <span class="hljs-string">&quot;host&quot;</span>: &#123;<br>            <span class="hljs-string">&quot;args&quot;</span>: &#123;<br>                <span class="hljs-string">&quot;data&quot;</span>: &#123;<br>                  // 训练数据、测试数据的list都要与上面的host的list大小一样，一一对应<br>                    <span class="hljs-string">&quot;train_data&quot;</span>: [			<br>                        &#123;<br>                            <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;homo_breast_1_train&quot;</span>,				<br>                            <span class="hljs-string">&quot;namespace&quot;</span>: <span class="hljs-string">&quot;homo_host_breast_train&quot;</span><br>                        &#125;,<br>                        &#123;<br>                            <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;homo_breast_1_train&quot;</span>,<br>                            <span class="hljs-string">&quot;namespace&quot;</span>: <span class="hljs-string">&quot;homo_host_breast_train&quot;</span><br>                        &#125;,<br>                        &#123;<br>                            <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;homo_breast_1_train&quot;</span>,<br>                            <span class="hljs-string">&quot;namespace&quot;</span>: <span class="hljs-string">&quot;homo_host_breast_train&quot;</span><br>                        &#125;<br>                    ],<br>                    <span class="hljs-string">&quot;eval_data&quot;</span>: [<br>                        &#123;<br>                            <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;homo_breast_1_eval&quot;</span>,<br>                            <span class="hljs-string">&quot;namespace&quot;</span>: <span class="hljs-string">&quot;homo_host_breast_eval&quot;</span><br>                        &#125;,<br>                        &#123;<br>                            <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;homo_breast_1_eval&quot;</span>,<br>                            <span class="hljs-string">&quot;namespace&quot;</span>: <span class="hljs-string">&quot;homo_host_breast_eval&quot;</span><br>                        &#125;,<br>                        &#123;<br>                            <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;homo_breast_1_eval&quot;</span>,<br>                            <span class="hljs-string">&quot;namespace&quot;</span>: <span class="hljs-string">&quot;homo_host_breast_eval&quot;</span><br>                        &#125;<br>                    ]<br>                &#125;<br>            &#125;,<br>          	// dataio_0 标签指定、测试集是否需要跑也是一样，大小一致、一一对应<br>            <span class="hljs-string">&quot;dataio_0&quot;</span>: &#123;<br>              <span class="hljs-string">&quot;label_name&quot;</span>: [<span class="hljs-string">&quot;y&quot;</span>, <span class="hljs-string">&quot;y&quot;</span>, <span class="hljs-string">&quot;y&quot;</span>]<br>            &#125;,<br>            <span class="hljs-string">&quot;evaluation_0&quot;</span>: &#123;<br>                <span class="hljs-string">&quot;need_run&quot;</span>: [<br>                    <span class="hljs-literal">false</span>, <span class="hljs-literal">false</span>, <span class="hljs-literal">false</span><br>                ]<br>            &#125;<br>        &#125;<br>    &#125;,<br>    ...<br>&#125;<br></code></pre></td></tr></table></figure>

<p>运行后效果如图：</p>
<p><img data-fancybox="gallery" data-sizes="auto" data-src="FATE%E4%BB%8E%E9%9B%B6%E5%AE%9E%E7%8E%B0%E6%A8%AA%E5%90%91%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92.assets/image-20220603100129097.png" alt="image-20220603100129097" class="lazyload"></p>
<ul>
<li><p><strong>guest 方</strong>：看得到 eval 输出（即 Evaluation scores、Confusion Matrix、PSI Summary、Quantile Distribution 以及各种曲线），homo_0 模型有权重、Performance scores、LOSS、KS；homo_1 仅有权重信息。因为这里的 homo_1是预测模型，只要知道结果即可。</p>
</li>
<li><p><strong>host 方</strong>：看不到 eval 输出，homo_0 模型仅有权重和一个 LOSS，homo_1 仅有权重信息。</p>
</li>
<li><p><strong>arbiter 方</strong>：不参与数据读取、DTable 数据输入、特征工程, homo_0 模型仅有权重和一个LOSS，homo_1仅有权重信息,看得到 eval 输出，但没有内容（即理解为可以看但不看）。</p>
</li>
</ul>
<p>注意：这里的 arbiter 是作为可信第三方存在的，有些场景下完全可以不要。</p>
<h1 id="四、Tips"><a href="#四、Tips" class="headerlink" title="四、Tips"></a>四、Tips</h1><h2 id="4-1-重新启动fate-flow和fateboard"><a href="#4-1-重新启动fate-flow和fateboard" class="headerlink" title="4.1. 重新启动fate-flow和fateboard"></a>4.1. 重新启动fate-flow和fateboard</h2><p>在根目录下</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">bash ./python/fate_flow/service.sh restart<br>bash ./fateboard/service.sh restart<br></code></pre></td></tr></table></figure>

<h2 id="4-2-‘NoneType’-object-has-no-attribute-‘count’"><a href="#4-2-‘NoneType’-object-has-no-attribute-‘count’" class="headerlink" title="4.2. ‘NoneType’ object has no attribute ‘count’"></a>4.2. ‘NoneType’ object has no attribute ‘count’</h2><p><img data-fancybox="gallery" data-sizes="auto" data-src="FATE%E4%BB%8E%E9%9B%B6%E5%AE%9E%E7%8E%B0%E6%A8%AA%E5%90%91%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92.assets/image-20220603100241724.png" alt="image-20220603100241724" class="lazyload"></p>
<p>解决：检查conf中的配置name、namespace与upload的配置是否一一匹配</p>
<h2 id="4-3-list-index-out-of-range"><a href="#4-3-list-index-out-of-range" class="headerlink" title="4.3. list index out of range"></a>4.3. list index out of range</h2><p><img data-fancybox="gallery" data-sizes="auto" data-src="FATE%E4%BB%8E%E9%9B%B6%E5%AE%9E%E7%8E%B0%E6%A8%AA%E5%90%91%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92.assets/image-20220603100208225.png" alt="image-20220603100208225" class="lazyload"></p>

  </article>

  
      
    <div class="nexmoe-post-copyright">
        <strong>Author：</strong>Shuyan<br>
        <strong>Link：</strong><a href="http://example.com/2022/05/29/%E8%81%94%E9%82%A6%E5%AD%A6%E4%B9%A0/%E8%81%94%E9%82%A6%E6%A1%86%E6%9E%B6%E9%83%A8%E7%BD%B2/FATE%E4%BB%8E%E9%9B%B6%E5%AE%9E%E7%8E%B0%E6%A8%AA%E5%90%91%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92/" title="http:&#x2F;&#x2F;example.com&#x2F;2022&#x2F;05&#x2F;29&#x2F;%E8%81%94%E9%82%A6%E5%AD%A6%E4%B9%A0&#x2F;%E8%81%94%E9%82%A6%E6%A1%86%E6%9E%B6%E9%83%A8%E7%BD%B2&#x2F;FATE%E4%BB%8E%E9%9B%B6%E5%AE%9E%E7%8E%B0%E6%A8%AA%E5%90%91%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92&#x2F;" target="_blank" rel="noopener">http:&#x2F;&#x2F;example.com&#x2F;2022&#x2F;05&#x2F;29&#x2F;%E8%81%94%E9%82%A6%E5%AD%A6%E4%B9%A0&#x2F;%E8%81%94%E9%82%A6%E6%A1%86%E6%9E%B6%E9%83%A8%E7%BD%B2&#x2F;FATE%E4%BB%8E%E9%9B%B6%E5%AE%9E%E7%8E%B0%E6%A8%AA%E5%90%91%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92&#x2F;</a><br>
        
            <strong>版权声明：</strong>本文采用 <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/cn/deed.zh" target="_blank">CC BY-NC-SA 3.0 CN</a> 协议进行许可
        
    </div>


  
  
  <div class="nexmoe-post-meta nexmoe-rainbow">
    
        <a class="nexmoefont icon-appstore-fill -link" href="/categories/%E8%81%94%E9%82%A6%E5%AD%A6%E4%B9%A0/">联邦学习</a>
    
    
        <a class="nexmoefont icon-tag-fill -none-link" href="/tags/%E8%81%94%E9%82%A6%E5%AD%A6%E4%B9%A0/" rel="tag">联邦学习</a>
    
</div>

  
      <div class="nexmoe-post-footer">
          <section class="nexmoe-comment">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@latest/dist/gitalk.min.css">
<div id="gitalk"></div>
<script src="https://cdn.jsdelivr.net/npm/gitalk@latest/dist/gitalk.min.js"></script>
<script type="text/javascript">
    var gitalk = new Gitalk({
        clientID: '80b2453b6d5f37ad6225',
        clientSecret: '43e99fa852795c9a7b3eb924b2558c64b84bbdeb',
        id: window.location.pathname,
        repo: 'nexmoe.github.io',
        owner: 'nexmoe',
        admin: 'nexmoe'
    })
    gitalk.render('gitalk')
</script>
</section>
      </div>
  
</div>
            <div class="nexmoe-post-right">
              <div class="nexmoe-fixed">
                  <div class="nexmoe-tool"> 
                    
                      
                        
                          
                          
                              <button class="mdui-fab catalog" style="overflow:unset;">
                                  <i class="nexmoefont icon-i-catalog"></i>
                                  <div class="nexmoe-toc">
                                      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%81%94%E9%82%A6%E5%AD%A6%E4%B9%A0%E4%B9%8B%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92"><span class="toc-number">1.</span> <span class="toc-text">联邦学习之逻辑回归</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A8%AA%E5%90%91%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92%EF%BC%88HomoLR%EF%BC%89"><span class="toc-number">1.1.</span> <span class="toc-text">横向逻辑回归（HomoLR）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2%E3%80%81%E7%BA%B5%E5%90%91%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92%EF%BC%88HeteroLR%EF%BC%89"><span class="toc-number">1.2.</span> <span class="toc-text">2、纵向逻辑回归（HeteroLR）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3%E3%80%81%E6%80%BB%E7%BB%93"><span class="toc-number">1.3.</span> <span class="toc-text">3、总结</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E5%AE%89%E8%A3%85FATE%E5%B9%B3%E5%8F%B0"><span class="toc-number">2.</span> <span class="toc-text">一、安装FATE平台</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E5%88%87%E5%88%86%E6%95%B0%E6%8D%AE%E9%9B%86"><span class="toc-number">3.</span> <span class="toc-text">二、切分数据集</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E5%88%A9%E7%94%A8FATE%E6%9E%84%E5%BB%BA%E6%A8%AA%E5%90%91%E8%81%94%E9%82%A6%E5%AD%A6%E4%B9%A0Pipeline"><span class="toc-number">4.</span> <span class="toc-text">三、利用FATE构建横向联邦学习Pipeline</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#3-1-%E6%95%B0%E6%8D%AE%E8%BD%AC%E6%8D%A2%E8%BE%93%E5%85%A5"><span class="toc-number">4.1.</span> <span class="toc-text">3.1 数据转换输入</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-2-%E6%A8%A1%E5%9E%8B%E8%AE%AD%E7%BB%83"><span class="toc-number">4.2.</span> <span class="toc-text">3.2 模型训练</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-1-DSL%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-number">4.2.1.</span> <span class="toc-text">3.2.1 DSL配置文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-2-%E8%BF%90%E8%A1%8C%E9%85%8D%E7%BD%AE-Submit-Runtime-Conf"><span class="toc-number">4.2.2.</span> <span class="toc-text">3.2.2 运行配置 Submit Runtime Conf</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-3-%E6%8F%90%E4%BA%A4%E5%8F%82%E6%95%B0%EF%BC%8C%E8%AE%AD%E7%BB%83%E6%A8%A1%E5%9E%8B"><span class="toc-number">4.2.3.</span> <span class="toc-text">3.2.3 提交参数，训练模型</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-3-%E8%AF%84%E4%BC%B0%E6%A8%A1%E5%9E%8B"><span class="toc-number">4.3.</span> <span class="toc-text">3.3 评估模型</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-4-%E5%A4%9A%E5%8F%82%E4%B8%8E%E6%96%B9%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE"><span class="toc-number">4.4.</span> <span class="toc-text">3.4 多参与方环境配置</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9B%9B%E3%80%81Tips"><span class="toc-number">5.</span> <span class="toc-text">四、Tips</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#4-1-%E9%87%8D%E6%96%B0%E5%90%AF%E5%8A%A8fate-flow%E5%92%8Cfateboard"><span class="toc-number">5.1.</span> <span class="toc-text">4.1. 重新启动fate-flow和fateboard</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-2-%E2%80%98NoneType%E2%80%99-object-has-no-attribute-%E2%80%98count%E2%80%99"><span class="toc-number">5.2.</span> <span class="toc-text">4.2. ‘NoneType’ object has no attribute ‘count’</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-3-list-index-out-of-range"><span class="toc-number">5.3.</span> <span class="toc-text">4.3. list index out of range</span></a></li></ol></li></ol>
                                  </div>
                              </button>
                          
                          
                      
                    
                      <a href="#nexmoe-content" class="toc-link" aria-label="回到顶部" title="top"><button class="mdui-fab mdui-ripple"><i class="nexmoefont icon-caret-top"></i></button></a>
                  </div>
              </div>
            </div>
        </div>
    </div>
     
    <div id="nexmoe-search-space">
        <div class="search-container">
            <div class="search-header">
                <div class="search-input-container">
                    <input class="search-input" type="text" placeholder="Search" oninput="sinput();">
                </div>
                <a class="search-close" onclick="sclose();">×</a>
            </div>
            <div class="search-body"></div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/combine/npm/lazysizes@5.1.0/lazysizes.min.js,npm/mdui@0.4.3/dist/js/mdui.min.js?v=1"></script>
<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>

 

<script async src="/js/app.js?v=1656038931339"></script>



<script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js"></script>
<script>
	$(".justified-gallery").justifiedGallery({
		rowHeight: 160,
		margins: 10,
	});
</script>


    





    <!-- baidu Analytics -->
<script>
    var _hmt = _hmt || [];
    (function() {var hm = document.createElement('script');
    hm.src = 'https://hm.baidu.com/hm.js?0a7e154da92f76d05c83b48cbab331da#&lt;ID&gt;';
    var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(hm, s);
    })();
</script>

</body>

</html>
